module.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.u)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.u?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=61)}([function(t,e,n){const{InternalError,TimeoutError}=n(11),{g:r}=n(6),o=new WeakSet,i=new WeakSet,s=new WeakSet,c=["toString","upgrade","sync","destroy","auth","load","init"],a=["sync","interactive"],h=["interactive"],u=[...c,"deps"],f=[...a,"init"],l=[...h,"init"];function d(t){return r((()=>{switch(typeof t){case"string":return`"${t.length>20?t.slice(0,20)+"â€¦":t}"`;case"object":{if(!t)return"null";if(!t.constructor.name)return"[anonymous object]";const Jig=n(5),Berry=n(12);return`[${t instanceof Jig?"jig":t instanceof Berry?"berry":"object"} ${t.constructor.name}]`}case"function":{let e=null;const Code=n(1);if(t instanceof Code)e=Code.prototype.toString.apply(t);else{e="function"==typeof t.toString&&!t.toString.toString().startsWith("class")?t.toString():Function.prototype.toString.apply(t)}if(/^\(/.test(e)||/^function\s*\(/.test(e)||/^[a-zA-Z0-9_$]+\s*=>/.test(e))return"[anonymous function]";return/^class\s*{/.test(e)?"[anonymous class]":t.name}case"undefined":return"undefined";default:return t.toString()}}))}function p(t){return"object"==typeof t&&!!t&&2===O(t)}function w(t){return Array.isArray(t)&&3===O(t)}function y(t){const e=n(8),r=e._;return(t instanceof e.$.Set||t instanceof r.Set)&&3===O(t)}function b(t){const e=n(8),r=e._;return(t instanceof e.$.Map||t instanceof r.Map)&&3===O(t)}function g(t){const e=n(8),r=e._;return(t instanceof e.$.Uint8Array||t instanceof r.Uint8Array)&&4===O(t)}function _(t){if("object"!=typeof t||!t)return!1;const Code=n(1);if(!(t.constructor instanceof Code))return!1;if(t instanceof n(5))return!1;return!(t instanceof n(12))}function m(t){const e=n(8);return!!e.P.has(t)||!!e.O.has(t)}function E(t){if(void 0===t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if("string"==typeof t)return!0;if(null===t)return!0;if(m(t))return!1;if(p(t))return!0;if(w(t))return!0;if(y(t))return!0;if(b(t))return!0;if(g(t))return!0;if(_(t))return!0;return t instanceof n(4)}const v=/^class\s*{/,$=/^class\s+(extends)?\s+\S+\s*{/,P=/^function\s*\(/;function O(t){if(!t)return 0;let e=0;do{e++,t=Object.getPrototypeOf(t)}while(t);return e}function S(t,e="limit"){if(null===t)return Number.MAX_VALUE;if(-1===t)return Number.MAX_VALUE;if(t===1/0)return Number.MAX_VALUE;if("number"!=typeof t||t<0)throw new Error(`Invalid ${e}: ${d(t)}`);return t}t.exports={S:o,A:i,I:s,R:["encryption","blockhash","blocktime","blockheight","latest","recent","mustBeLatest","mustBeRecent","checkForUpdates","recover","replicate","makeBackup","restricts","delegate","consume","eject","armored","armoured"],j:c,C:a,N:h,k:u,U:f,D:l,F:function(){const t=n(31);if(!t.M)throw new Error("Run instance not active");return t.M},B:function(t,e){if(!t)throw new InternalError(e||"assert failed")},L:function(t){return t.startsWith("main")?"mainnet":"testnet"},G:function(t){if("function"!=typeof t)return;const e=n(8),Code=n(1),r=e._.Object,o=e.$.Object,i=Object.getPrototypeOf(t);return i!==o.getPrototypeOf(o)&&i!==r.getPrototypeOf(r)&&i!==Code.prototype?i:void 0},J:function(t){const e=t.match(/^\s*class\s+[a-zA-Z0-9_$]+\s+extends\s+([a-zA-Z0-9_$]+)\s*{/);return e&&e[1]},W:function(t,B){for(;t;)if((t=Object.getPrototypeOf(t))===B)return!0;return!1},Y:d,K:p,V:w,H:y,q:b,Z:g,X:_,tt:function(t){return void 0!==t},et:function(t){return 0===t&&1/t==-1/0},nt:m,rt:function(t){const{ot:e}=n(14);let o=!0;try{r((()=>e(t,(t=>{o=o&&E(t)}))))}catch(t){}return o},it:E,st:function(t){if("function"!=typeof t)return!1;if(!t.name)return!0;const e=t.toString();return!e.startsWith("class")&&!e.startsWith("function")||(v.test(e)||$.test(e)||P.test(e))},ct:O,at:function(t,e){if(!t||"function"!=typeof t&&"object"!=typeof t)return;const n=Object.getOwnPropertyDescriptor(t,e);return n&&n.value},ht:function(t,e){return!(!t||"function"!=typeof t&&"object"!=typeof t)&&("string"==typeof e?Object.getOwnPropertyNames(t).includes(e):"symbol"==typeof e?Object.getOwnPropertySymbols(t).includes(e):void 0)},ut:function(t,e,r){let o=Object.getOwnPropertyDescriptor(t,e);(!o||o.get||o.set)&&(o={configurable:!0,enumerable:!0,writable:!0}),o.value=r;const{ft:i}=n(16);i(t,e,o)},lt:function(t,e,n){Object.defineProperty(t,e,{get:n,configurable:!0,enumerable:!0})},dt:function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)).filter((e=>Object.getOwnPropertyDescriptor(t,e).get))},wt:function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)).filter((t=>"constructor"!==t)).filter((e=>"function"==typeof Object.getOwnPropertyDescriptor(t,e).value))},yt:S,bt:class{constructor(t,e){this.gt=new Date,this._t=t,this.Et=e}vt(){if(new Date-this.gt>S(this.Et,"timeout"))throw new TimeoutError(`${this._t} timeout`)}},$t:function(t,e){let n=0;return t.forEach(((r,o)=>{e(r,o,t)&&(t[n++]=r)})),t.length=n,t}}},function(t,e,n){class CodeDeps{static get Pt(){return n(20)}static get Ot(){return n(3)}static get St(){return n(2)}static get xt(){return n(0)}static get At(){return n(9)}static get g(){return n(6).g}static get It(){return n(50)}static get Rt(){return"Code"}static get jt(){return n(27)}}class Code{constructor(){throw new Error("Cannot instantiate Code")}toString(){const t=CodeDeps.Ot,e=CodeDeps.g,{B:n}=CodeDeps.xt,r=t.Tt(this);if(!r)return e((()=>this.toString()));const o=r.Ct,i=r.Nt;return n(i),r.kt?i.startsWith("class")?`class ${o.name} { [native code] }`:`function ${o.name}() { [native code] }`:i}sync(t={}){const e=CodeDeps.Ot,n=CodeDeps.St,r=CodeDeps.It,o=CodeDeps.Rt,{Y:i}=CodeDeps.xt,s=CodeDeps.jt,c=CodeDeps.At.Ut;if(n.Dt&&n.Ft(o,"Sync",i(this)),s.Mt)throw new Error("sync disabled during atomic update");if(c.Bt.length)throw new Error("sync cannot be called internally");const a=e.Tt(this);if(!a)throw new Error("sync unavailable");if(!a.kt)return r(this,t).then((()=>this))}upgrade(t){return CodeDeps.Ot.Lt(this,t),this}auth(){const t=CodeDeps.Pt,e=CodeDeps.Ot,{Y:n}=CodeDeps.xt,r=CodeDeps.At,o=CodeDeps.St,i=CodeDeps.Rt;o.Dt&&o.Ft(i,"Auth",n(this));const s=e.Tt(this);if(!s)throw new Error("auth unavailable on non-jigs");if(s.kt)throw new Error("auth unavailable on native jigs");if(r.Ut.Jt.Gt(this))throw new Error("auth unavailable on new jigs");return t.Wt(this),this}destroy(){const t=CodeDeps.Pt,e=CodeDeps.Ot,n=CodeDeps.St,{Y:r}=CodeDeps.xt,o=CodeDeps.Rt;n.Dt&&n.Ft(o,"Destroy",r(this));const i=e.Tt(this);if(!i||i.kt)throw new Error("destroy unavailable");return t.Yt(this),this}[Symbol.hasInstance](t){const e=CodeDeps.Ot,n=CodeDeps.g;if("object"!=typeof t||!t)return!1;const r=e.Kt(this);return!!r&&n((()=>{let e=Object.getPrototypeOf(t);for(;e;){if(e.constructor.origin&&e.constructor.origin===r.origin)return!0;e=Object.getPrototypeOf(e)}return!1}))}static[Symbol.hasInstance](t){return CodeDeps.xt.A.has(t)}}Code.deps={CodeDeps},Code.sealed=!0,Code.toString();const r=CodeDeps.Ot.zt();CodeDeps.Ot.Tt(r).Vt(Code,!1),t.exports=r},function(t,e){const n={Ht:null,qt(...t){this.Zt("info",...t)},Xt(...t){this.Zt("warn",...t)},Qt(...t){this.Zt("error",...t)},Ft(...t){this.Zt("debug",...t)},get te(){return!!this.Ht&&!!this.Ht.info&&"function"==typeof this.Ht.info},get ee(){return!!this.Ht&&!!this.Ht.warn&&"function"==typeof this.Ht.warn},get ne(){return!!this.Ht&&!!this.Ht.error&&"function"==typeof this.Ht.error},get Dt(){return!!this.Ht&&!!this.Ht.debug&&"function"==typeof this.Ht.debug},Zt(t,e,...n){this.Ht&&this.Ht[t]&&"function"==typeof this.Ht[t]&&this.Ht[t]((new Date).toISOString(),t.toUpperCase(),`[${e}]`,...n)}};t.exports=n},function(t,e,n){const{Y:r,F:o,G:i,st:s,tt:c,A:a,K:h,ht:u,ut:f,B:l,W:d,R:p,j:w,C:y}=n(0),b=n(23),{re:g}=n(32),_=n(47),m=n(2),{oe:E,ot:v}=n(14),$=n(10),{g:P}=n(6),{ie:O,ce:S,ae:x,he:A,ue:I}=$,R=n(24),j=n(8),T=n(25),{ArgumentError}=n(11),C=n(22),N=j._,k="Editor",U=new WeakMap,D={},F=new Map,M={};class L{fe(t,e){this.le=void 0,this.Ct=e,this.de=t,this.pe=void 0,this.Nt=void 0,this.we=!1,this.ye=!1,this.be=!1,this.ge="";try{this.ge=o()._e.network}catch(t){}this.kt=void 0,this.me=!1}Ee(t,e=!0,o=[],i){const Code=n(1);if(m.Dt&&m.Ft(k,"Install",r(t)),this.we)return l(t===this.le||t===this.de),this.ve();l(!this.kt);const s=_.$e(this.Ct);D[this.ge]=D[this.ge]||new Map,D[this.ge].delete(this.le),e&&D[this.ge].set(t,this.de);try{this.Pe(t,e,o),this.Oe(),this.Se(this.ye?s:null),this.le=t,this.pe=t.name,this.Nt=i||C.xe(this.Ct.toString(),this.pe),this.be=e,this.we=!1,this.ye=!0,this.kt=!1,this.me=!1,u(t,"presets")&&u(t.presets,this.ge)&&u(t.presets[this.ge],"location")&&(P((()=>v(this.de,(t=>{if(t instanceof Code&&t!==this.de&&S(t.location).Ae)throw new ArgumentError(`${r(t)} must have presets`)})))),this.Ie(this.le.presets[this.ge]))}catch(e){throw D[this.ge].delete(t),this.local&&D[this.ge].set(this.le,this.de),_.Re(this.Ct,s),e}}je(){if(this.kt)throw new Error("Cannot uninstall native code");this.ye&&(D[this.ge].delete(this.le),this.ye=!1),this.we&&(F.delete(this.le),this.we=!1),this.le&&(O.forEach((t=>{delete this.le[t]})),delete this.le.presets),u(this.le,Symbol.hasInstance)&&delete this.le[Symbol.hasInstance],this.le=void 0,this.be=!1}Te(t){if(this.we)return;let e=!0;try{o()}catch(t){e=!1}if(e)this.Ee(t);else{if(m.Dt&&m.Ft(k,"Preinstall",r(t)),this.ye||this.kt)throw new Error(`Cannot preinstall ${r(t)}`);F.set(t,this.de);try{this.Pe(t,!0),this.le=t,this.pe=t.name,this.Nt=C.xe(this.Ct.toString(),this.pe),this.be=!0,this.we=!0,this.ye=!1,this.kt=!1,this.me=!1}catch(e){throw F.delete(t),e}}}ve(){if(this.we){m.Dt&&m.Ft(k,"Postinstall",r(this.le)),this.ge=o()._e.network;try{F.delete(this.le),D[this.ge]=D[this.ge]||new Map,D[this.ge].set(this.le,this.de),this.Oe(),this.Se(),this.we=!1,this.ye=!0;const Code=n(1),t=t=>{t instanceof Code&&L.Tt(t).ve()};P((()=>v(this.de,t)))}catch(t){throw F.set(this.le,this.de),D[this.ge].delete(this.le),this.ge="",t}}}Pe(t,e=!1,o=[]){const i=e?q(this.de,t,e,o)[0]:t,Jig=n(5),Berry=n(12);let s=null;if(d(t,Jig))s=R.Ce();else{const e=t.toString().startsWith("class");s=R.Ne(e)}if(T.Ue(this.de).ke=s,this.ye){if(d(this.le,Jig)!==d(t,Jig))throw new Error("Cannot change jigs to sidekicks, or vice versa")}if(this.ye&&d(this.le,Berry))throw new Error(`Cannot upgrade from berry class: ${r(this.le)}`);if(this.ye&&d(t,Berry))throw new Error(`Cannot upgrade to berry class: ${r(t)}`);Q(i,this.de),tt(t),_.Re(this.Ct,i)}Oe(){P((()=>{if(u(this.de,"presets")){const t=this.de.presets[this.ge];Object.getOwnPropertyNames(t||{}).forEach((e=>f(this.de,e,t[e]))),delete this.de.presets}}))}Se(t){P((()=>{t?O.forEach((e=>f(this.de,e,t[e]))):u(this.de,"location")||$.De(this.de)}))}Vt(t,e=!1){m.Dt&&m.Ft(k,"Install native",r(t)),l(void 0===this.kt),l(!i(t)),l(!(t.name in M));const[n,o]=j.Fe(t,{},!0,!1);Object.assign(o,t.deps);const s=t.sealed,a=t.upgradable,h=t.interactive;process.env.COVER&&Object.keys(n).forEach((t=>{delete n[t]})),c(s)&&f(n,"sealed",s),c(a)&&f(n,"upgradable",a),c(h)&&f(n,"interactive",h),Q(n,this.de),_.Re(this.Ct,n),n.origin=`native://${t.name}`,n.location=`native://${t.name}`,n.nonce=0,n.owner=null,n.satoshis=0,M[t.name]=this.de,T.Ue(this.de).ke=R.Me(),this.le=t,this.pe=t.name,this.Nt=C.xe(this.Ct.toString(),this.pe),this.we=!1,this.ye=!0,this.be=!0,this.kt=!0,this.me=e}Be(){m.te&&m.qt(k,"Deploy",r(this.de)),this.kt||(this.ve(),et(this.de))}Ie(t){if(!this.be)return;const e=this.le;u(e,"presets")||f(e,"presets",{}),u(e.presets,this.ge)||f(e.presets,this.ge,{}),P((()=>{O.forEach((n=>{const r=e.presets[this.ge];u(r,n)||f(r,n,t[n]),u(e,n)||f(e,n,t[n])}))}))}Le(){return{de:this.de,le:this.le,pe:this.pe,Nt:this.Nt,Ge:_.$e(this.Ct)}}Je(t){l(this.de===t.de),this.le=t.le,this.pe=t.pe,this.Nt=t.Nt,_.Re(this.Ct,t.Ge)}}function G(t,e=!0,r=[]){l(!rt(t));const o=new _,i=new L,s=new(n(21))(o);return _.We(o,s),i.fe(s,o),U.set(s,i),a.add(s),t&&i.Ee(t,e,r),r.push(s),s}function J(t,e=!0,n=[]){return rt(t)||G(t,e,n)}function Y(t){const Jig=n(5),Berry=n(12);if("function"!=typeof t)throw new ArgumentError(`Only functions and classes are supported: ${r(t)}`);if(H(t),d(t,Jig)&&function(t){const e=Object.getOwnPropertyNames(t.prototype),r=p.find((t=>e.includes(t)))||y.find((t=>e.includes(t)))||O.find((t=>e.includes(t)));if(r)throw new ArgumentError(`Must not have any reserved jig words: ${r}`);const Jig=n(5),o=[];let i=t;for(;i!==Jig;)o.push(i),i=Object.getPrototypeOf(i);const s=/\s+constructor\s*\(/;if(o.some((t=>s.test(t.toString()))))throw new Error("Jig must use init() instead of constructor()")}(t),d(t,Berry)&&function(t){const e=Object.getOwnPropertyNames(t.prototype),r=p.find((t=>e.includes(t)))||O.find((t=>e.includes(t)));if(r)throw new ArgumentError(`Must not have any reserved berry words: ${r}`);const Berry=n(12),o=[];let i=t;for(;i!==Berry;)o.push(i),i=Object.getPrototypeOf(i);const s=/\s+constructor\s*\(/;if(o.some((t=>s.test(t.toString()))))throw new Error("Berry must use init() instead of constructor()")}(t),t.prototype&&t.prototype.constructor!==t)throw new ArgumentError(`Prototypal inheritance not supported: ${r(t)}`);if(s(t))throw new ArgumentError(`Anonymous types not supported: ${r(t)}`);if(-1!==t.toString().indexOf("[native code]"))throw new ArgumentError(`Cannot install intrinsic: ${r(t)}`);!function(t){P((()=>{if(Object.getOwnPropertySymbols(t).length||Object.getOwnPropertySymbols(t.prototype).length)throw new Error("Symbol methods not supported")}))}(t),function(t){const e=t=>{if("get"in t||"set"in t)throw new Error("Getters and setters not supported")};P((()=>{Object.getOwnPropertyNames(t).map((e=>Object.getOwnPropertyDescriptor(t,e))).forEach((t=>e(t))),Object.getOwnPropertyNames(t.prototype).map((e=>Object.getOwnPropertyDescriptor(t.prototype,e))).forEach((t=>e(t)))}))}(t)}function W(t){u(t,"sealed")&&K(t.sealed),u(t,"upgradable")&&z(t.upgradable),u(t,"interactive")&&V(t.interactive)}function K(t){if(!0!==t&&!1!==t&&"owner"!==t)throw new ArgumentError(`Invalid sealed option: ${t}`)}function z(t){if(!0!==t&&!1!==t)throw new ArgumentError(`Invalid upgradable option: ${t}`)}function V(t){if(!0!==t&&!1!==t)throw new ArgumentError(`Invalid interactive option: ${t}`)}function H(t){const e=Object.getOwnPropertyNames(t),n=p.find((t=>e.includes(t)))||w.find((t=>e.includes(t)));if(n)throw new ArgumentError(`Must not have any reserved words: ${n}`)}function q(t,e,o=!1,s){Y(e),function(t,e){if(!e.ye)return;if(e.kt)throw new Error("Cannot upgrade native code");if(t instanceof n(1))throw new ArgumentError("Cannot upgrade to a code jig");if(u(t,"presets")){const n=t.presets[e.ge],r=t=>{if(t in n)throw new Error("Preset bindings not supported for upgrades")};$.ie.forEach((t=>r(t)))}if(P((()=>e.de.origin))===$.Ye)throw new Error("Cannot upgrade undeployed code")}(e,U.get(t));const a=i(e),l=a&&J(a,o,s);if(l){if(!0===l.sealed)throw new ArgumentError(`${r(l)} is sealed`);L.Tt(l).ve()}const d=new Set([t]);let p=i(e);for(;p;){if(d.has(p))throw new Error("Cannot extend the self");d.add(t),p=i(p)}!function(t,e){if(u(t,"deps")){if(!h(t.deps))throw new ArgumentError("deps must be a basic object");if(e){const n=t.deps[e.name],r=rt(n);if(n&&!b.Ke(r,e))throw new ArgumentError("Parent dependency mismatch")}if(t.name in t.deps)throw new ArgumentError("Illegal dependency")}}(e,l),function(t){if(!u(t,"presets"))return;const e=t.presets;if(!h(e))throw new ArgumentError("presets must be a basic object");for(const n of Object.keys(e)){const o=e[n];if(!h(o))throw new ArgumentError(`Presets for ${n} network must be an object`);const i=O.some((t=>c(o[t]))),s=O.find((t=>!c(o[t])));if(i&&s)throw new ArgumentError(`${n} presets not fully defined: ${s} missing`);if(i){const e=S(o.location);if(!e.ze||!c(e.Ve)&&!c(e.He)||c(e.qe))throw new ArgumentError(`Bad location: ${r(t)}`);const n=S(o.origin);if(!n.ze||!c(n.Ve)&&!c(n.He)||c(n.qe))throw new ArgumentError(`Bad origin: ${r(t)}`);if(x(o.nonce),A(o.owner,!0),I(o.satoshis),o.nonce>1&&o.origin===o.location)throw new ArgumentError(`Bad nonce or location: ${r(t)}`)}if("deps"in o)throw new ArgumentError(`${n} presets must not contain deps`);if("presets"in o)throw new ArgumentError(`${n} presets must not contain presets`);H(o),W(o)}}(e),W(e),function(t){const e=Object.getOwnPropertyNames(t),n=O.find((t=>e.includes(t)));if(n)throw new ArgumentError(`Must not have any bindings: ${n}`)}(e);const w={};l&&(w[l.name]=l);const[y,_]=j.Fe(e,w,!1,!0);Object.defineProperty(y,"name",{value:e.name,configurable:!0});const m=Object.assign({},e),v=E(m,N,(t=>"function"==typeof t?J(t,o,s):void 0));return g(v),"deps"in v||(v.deps=new N.Object),l&&(v.deps[l.name]=l),Object.keys(v.deps||{}).forEach((e=>{Object.defineProperty(_,e,{get:()=>t.deps[e],set:n=>{t.deps[e]=n},configurable:!0,enumerable:!0})})),f(_,e.name,t),v.deps=Z(t,_,v.deps),Object.keys(v).forEach((t=>f(y,t,v[t]))),X(_),[y,_]}function Z(t,e,n){return new N.Proxy(n,{defineProperty:(n,r,o)=>{const i=Reflect.defineProperty(n,r,o);return Object.defineProperty(e,r,{get:()=>t.deps[r],set:e=>{t.deps[r]=e},configurable:!0,enumerable:!0}),i},deleteProperty:(t,n)=>{const r=Reflect.deleteProperty(t,n);return Reflect.deleteProperty(e,n),"caller"===n&&X(e),r},set:(n,r,o,i)=>{f(n,r,o);return Object.defineProperty(e,r,{get:()=>t.deps[r],set:e=>{t.deps[r]=e},configurable:!0,enumerable:!0}),!0}})}function X(t){if("caller"in t)return;const e=n(9);Object.defineProperty(t,"caller",{get:()=>e.Ut.Ze(),set:()=>{throw new Error("Cannot set caller")},configurable:!0,enumerable:!0})}function Q(t,e){Object.getOwnPropertyNames(t.prototype).concat(Object.getOwnPropertySymbols(t.prototype)).filter((t=>"constructor"!==t)).forEach((r=>{const o=n(21),i=R.Xe(e,!0);t.prototype[r]=new o(t.prototype[r],i)}))}function tt(t){const Jig=n(5),Berry=n(12);if(!d(t,Jig)&&!d(t,Berry)&&!u(t,Symbol.hasInstance)){const e={configurable:!0,enumerable:!0,writable:!1},Code=n(1);e.value=Code.prototype[Symbol.hasInstance],Object.defineProperty(t,Symbol.hasInstance,e)}}function et(...t){const e=n(20),r=new Set;t.forEach((t=>{const e=U.get(t);l(!e.kt);nt(t=rt(t)).forEach((t=>r.add(t)))})),r.size&&e.Be([...r])}function nt(t,e=new Set){const Code=n(1);if(l(t instanceof Code),e.has(t))return;L.Tt(t).ve();const r=P((()=>t.location)),{Ae:o}=S(r);if(!o)return e;const s=i(t);s&&nt(s,e),e.add(t);const c=P((()=>Object.assign({},t))),Creation=n(4);return P((()=>v(c,(t=>(t instanceof Code&&nt(t,e),!(t instanceof Creation)))))),e}function rt(t){if(U.has(t))return t;if(F.has(t))return F.get(t);let e="";try{e=o()._e.network}catch(t){}const n=D[e];if(!n)return;if(n.has(t))return n.get(t);const r=u(t,"presets")&&u(t.presets,e)&&t.presets[e].location;if(r)for(const t of n.values())if(P((()=>t.location))===r)return t}L.zt=G,L.Qe=J,L.Lt=function(t,e,o=!0,i){const s=n(9),c=n(35),a=n(20);if(m.Dt&&m.Ft(k,"Upgrade",r(t),"to",r(e)),s.Ut.Bt.length)throw new Error("upgrade unavailable");const h=L.Tt(t);if(!h||h.kt)throw new Error("upgrade unavailable");if(!P((()=>!u(t,"upgradable")||t.upgradable)))throw new Error(`${r(t)} is non-upgradable`);const f=new c(t);try{const n=[];h.Ee(e,o,n,i),s.Ut.tn((()=>{n.length&&et(...n),a.en(t,f)}))}catch(t){throw f.nn(t),t}},L.Kt=rt,L.rn=function(t){const e=M[t];if(e){if(U.get(e).me)throw new Error(`${t} is internal to RUN and cannot be deployed`);return e}},L.sn=function(){let t="";try{t=o()._e.network}catch(t){}function e(t,e){j.cn.includes(e.name)||(O.forEach((t=>{delete e[t]})),delete e[Symbol.hasInstance])}m.te&&m.qt(k,"Deactivate",t,"bindings"),D[t]&&P((()=>D[t].forEach(e)))},L.an=function(){let t="";try{t=o()._e.network}catch(t){}function e(e,n){u(n,"presets")&&u(n.presets,t)?O.forEach((e=>f(n,e,n.presets[t][e]))):j.cn.includes(n.name)||$.De(n),tt(n)}m.te&&m.qt(k,"Activate",t,"bindings"),Array.from(F.values()).forEach((t=>L.Tt(t).ve())),D[t]&&P((()=>D[t].forEach(e)))},L.hn=q,L.un=Z,L.Te=function(t){const e=rt(t);if(e)return e;const n=L.zt();return L.Tt(n).Te(t),n},L.Tt=t=>U.get(t),L.fn=K,L.ln=z,L.dn=V,L.pn=U,t.exports=L},function(t,e,n){class CreationDeps{static get Ot(){return n(3)}static get xt(){return n(0)}}class Creation{static[Symbol.hasInstance](t){const{S:e,A:n,I:r}=CreationDeps.xt;return!!e.has(t)||(!!n.has(t)||!!r.has(t))}}Creation.deps={CreationDeps},Creation.sealed=!0,Creation.toString();const r=CreationDeps.Ot.zt();CreationDeps.Ot.Tt(r).Vt(Creation,!1),t.exports=r},function(t,e,n){class JigDeps{static get Pt(){return n(20)}static get wn(){return n(10)}static get yn(){return n(1)}static get bn(){return n(14)}static get Ot(){return n(3)}static get gn(){return n(15)}static get St(){return n(2)}static get _n(){return n(21)}static get xt(){return n(0)}static get mn(){return n(5)}static get At(){return n(9)}static get En(){return n(24)}static get vn(){return n(8)}static get g(){return n(6).g}static get It(){return n(50)}static get jt(){return n(27)}static get Rt(){return"Jig"}}class Jig{constructor(...t){const e=JigDeps.Pt,n=JigDeps.wn,Code=JigDeps.yn,r=JigDeps.Ot,o=JigDeps.bn.oe,i=JigDeps.xt.S,s=JigDeps._n,c=JigDeps.mn,a=JigDeps.At,h=JigDeps.En,u=JigDeps.vn._,f=JigDeps.g,l=a.Ut;if(this.constructor===c)throw new Error("Jig must be extended");if(!(this.constructor instanceof Code))return l.tn((()=>{const e=r.Qe(this.constructor);return r.Tt(e).Be(),new e(...t)}));r.Tt(this.constructor).Be(),n.De(this);const d=l.Bt,p=d.length&&d[d.length-1];p&&(this.owner=f((()=>o(p.owner,u))));const w=new s(this,h.$n(!1));i.add(w);const y=!p||l.Pn(p,!0);return e.On(this.constructor,w,t,y),w}init(){}sync(t={}){const e=JigDeps.St,n=JigDeps.Rt,r=JigDeps.It,o=JigDeps.xt.Y,i=JigDeps.mn,s=JigDeps.At.Ut;if(JigDeps.jt.Mt)throw new Error("sync disabled during atomic update");if(e.Dt&&e.Ft(n,"Sync",o(this)),!(this instanceof i))throw new Error("sync unavailable");if(s.Bt.length)throw new Error("sync cannot be called internally");return r(this,t).then((()=>this))}destroy(){const t=JigDeps.St,e=JigDeps.Rt,n=JigDeps.xt.Y,r=JigDeps.mn,o=JigDeps.Pt;if(t.Dt&&t.Ft(e,"Destroy",n(this)),!(this instanceof r))throw new Error("destroy unavailable");return o.Yt(this),this}auth(){const t=JigDeps.St,e=JigDeps.Rt,n=JigDeps.xt.Y,r=JigDeps.mn,o=JigDeps.Pt,i=JigDeps.At;if(t.Dt&&t.Ft(e,"Auth",n(this)),!(this instanceof r))throw new Error("auth unavailable on native jigs");if(i.Ut.Jt.Gt(this))throw new Error("auth unavailable on new jigs");return o.Wt(this),this}toString(){return`[jig ${this.constructor.name}]`}static load(t){const{F:e,Y:n,W:r}=JigDeps.xt,o=JigDeps.gn,i=JigDeps.mn,s=JigDeps.At.Ut;if(JigDeps.jt.Mt)throw new Error("load disabled during atomic update");if(this!==i&&!r(this,i))throw new Error("load unavailable");if(s.Bt.length)throw new Error("load cannot be called internally");return(async()=>{const r=await o(t,void 0,e());if(r instanceof this)return r;throw new Error(`Cannot load ${t}\n\n${n(r)} not an instance of ${n(this)}`)})()}static[Symbol.hasInstance](t){if(!JigDeps.xt.S.has(t))return!1;if(this===JigDeps.mn)return!0;const e=JigDeps.Ot.Kt(this);return!!e&&JigDeps.g((()=>{let n=Object.getPrototypeOf(t);for(;n;){if(n.constructor.origin===e.origin)return!0;n=Object.getPrototypeOf(n)}return!1}))}}Jig.deps={JigDeps},Jig.sealed=!1,Jig.toString();const r=JigDeps.Ot.zt();JigDeps.Ot.Tt(r).Vt(Jig,!1),t.exports=r},function(t,e){let n=!1;t.exports={g:function(t){const e=n;try{return n=!0,t()}finally{n=e}},Sn:function(){return n}}},function(t,e){t.exports=require("bsv")},function(module,exports,__webpack_require__){const DeterministicRealm=__webpack_require__(46),{lt:_defineGetter}=__webpack_require__(0),Source=__webpack_require__(22),Log=__webpack_require__(2),TAG="Sandbox";class Sandbox{constructor(){this.cn=[],Log.Dt&&Log.Ft(TAG,"Creating deterministic realm"),this.xn=new DeterministicRealm,this.An=new WeakSet;const compartment=this.xn.makeCompartment();this._=compartment.evaluate(_getIntrinsicsSrc),this.$=eval(_getIntrinsicsSrc),this.O=new Set(Object.entries(this._).map((([t,e])=>e))),this.P=new Set(Object.entries(this.$).map((([t,e])=>e)))}Fe(t,e,n=!1,r=!1){let o=t.toString();if(process.env.COVER&&(n||this.cn.includes(t.name))){if(!this.An.has(t)){return[t,"undefined"!=typeof global?global:window]}o=Source.In(o)}const i=Source.Rn(o,t),s=r?Source.jn(i):i;return this.Tn(s,e)}Tn(t,e={}){const n=this.xn.makeCompartment();Object.assign(n.global,this._,e);const r=t.startsWith("class")?"AnonymousClass":"anonymousFunction",o=`const ${r}=${t};${r}`;"Math"in e||_defineGetter(n.global,"Math",(()=>{throw new ReferenceError("Math is not defined\n\nHint: Math is disabled because it is non-deterministic.")})),"Date"in e||_defineGetter(n.global,"Date",(()=>{throw new ReferenceError("Date is not defined\n\nHint: Date is disabled because it is non-deterministic.")}));const i=n.evaluate(o);return"function"==typeof i&&this.An.add(i),[i,n.global]}}const _intrinsicNames=["console","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","Object","Function","Boolean","Symbol","Error","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError","Number","BigInt","Math","Date","String","RegExp","Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","Map","Set","WeakMap","WeakSet","ArrayBuffer","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"];let _getIntrinsicsSrc="const x = {}\n";_intrinsicNames.forEach((t=>{_getIntrinsicsSrc+=`x.${t} = typeof ${t} !== 'undefined' ? ${t} : undefined\n`})),_getIntrinsicsSrc+="x",module.exports=new Sandbox},function(t,e,n){const r=n(7),{crypto:o}=r,{B:i,Y:s,F:c,tt:a}=n(0),h=n(23),{ce:u,Cn:f,Ye:l}=n(10),{g:d}=n(6),p=n(35),w=n(2),y=n(25),{ot:b}=n(14),g="Record";class _{constructor(){this.Nn=o.Random.getRandomBuffer(32).toString("hex"),this.kn=0,this.Un=[],this.Bt=[],this.Qt=null,this.Jt=new h,this.Dn=new h,this.Fn=new h,this.Mn=new h,this.Bn=new h,this.Ln=new h,this.Gn=new h,this.Jn=new h,this.Wn=new h,this.Yn=[],this.Kn=new Map,this.zn=!0,this.Vn=!1,this.Hn=!1,this.qn=null}Zn(){i(!this.Hn),w.Dt&&w.Ft(g,"Begin"),this.kn++}Xn(){i(this.kn),w.Dt&&w.Ft(g,"End"),this.kn--,this.kn||!this.zn||this.Hn||this.Qn()}tr(t){const Creation=n(4);i(!this.Hn),i(t instanceof Creation),w.Dt&&w.Ft(g,`Push ${s(t)}`),this.Bt.push(t)}er(){i(this.Bt.length);const t=this.Bt.pop();w.Dt&&w.Ft(g,`Pop ${s(t)}`)}nr(t){if(i(!this.Bt.length),w.Dt&&w.Ft(g,`Action ${t}`),this.Un.push(t),this.rr(),!this.Vn){const t=this.ir();this.Jn.sr((e=>t.cr("update",e))),this.Mn.sr((e=>t.cr("update",e)))}!this.kn&&this.zn&&this.Qn()}rr(){!function(t,e){t.Gn=new h;for(const e of t.Fn)t.Gn.ar(e);for(const e of t.Bn)t.Gn.ar(e);for(const e of t.Mn)t.Gn.ar(e);for(const e of t.Jt)t.Gn.hr(e);t.Jn=new h;for(const e of t.Gn)t.Jn.ar(e);for(const e of t.Jt)t.Jn.ar(e);for(const e of t.Mn)t.Jn.hr(e);t.Wn=new h;for(const e of t.Dn)t.Wn.ar(e);for(const e of t.Gn)t.Wn.hr(e);for(const e of t.Jn)t.Wn.hr(e);for(const e of t.Mn)t.Wn.hr(e)}(this),function(t){const e=e=>{const n=u(e.origin);return n.Ae||n.ur===t.Nn};d((()=>{t.Jn.sr(((n,r)=>{n.location=f({ur:t.Nn,Ve:r}),e(n)&&(n.origin=n.location),n.nonce=t.Kn.get(n).lr.nonce+1})),t.Mn.sr(((n,r)=>{n.location=f({ur:t.Nn,He:r}),e(n)&&(n.origin=n.location),n.nonce=t.Kn.get(n).lr.nonce+1}))}))}(this)}dr(t){i(!this.Hn),this.Ln.Gt(t)||(w.Dt&&w.Ft(g,`Unbind ${s(t)}`),this.Ln.ar(t))}Qn(){i(!this.Hn);const t=n(36);if(w.Dt&&w.Ft(g,"Commit"),this.Nn===_.Ut.Nn&&(i(!_.Ut.kn),_.Ut=new _),!this.Un.length)return w.ee&&w.Xt(g,"No actions found"),i(!this.Jt.pr),i(!this.Fn.pr),i(!this.Mn.pr),void i(!this.Bn.pr);if(!this.Un.length||this.Jt.pr||this.Fn.pr||this.Mn.pr||this.Bn.pr){this.wr();try{return new t(this)}catch(t){throw this.nn(t),t}}}wr(){const Code=n(1),Creation=n(4),t=this.Jn.yr().concat(this.Mn.yr()).concat(this.Wn.yr()).map((t=>t instanceof Code?t:t.constructor));t.filter((t=>!1===t.interactive)).forEach((e=>{const n=new Set([e]);d((()=>b(e,(t=>{t instanceof Creation&&n.add(t)}))));const r=t.find((t=>!n.has(t)));if(r)throw new Error(`${e.name} is not permitted to interact with ${r.name}`)}))}br(t){if(this.gr(t,"create"),i(!this.Hn),this.Jt.Gt(t))return void this._r();w.Dt&&w.Ft(g,"Create",s(t));const Code=n(1),Jig=n(5);i(t instanceof Code||t instanceof Jig);const e=d((()=>u(t.origin).kt));i(!a(e)),i(!this.Fn.Gt(t)),i(!this.Mn.Gt(t)),i(!this.Bn.Gt(t)),i(!this.Ln.Gt(t)),this.Jt.ar(t),this.mr(t,!1,"create"),this.Er(t),this._r(t)}_read(t){if(i(!this.Hn),this.Dn.Gt(t))return;w.Dt&&w.Ft(g,"Read",s(t));const Creation=n(4);i(t instanceof Creation),this.Dn.ar(t),this.mr(t,!0,"read"),this.Er(t,void 0,!0)}vr(t,e){if(this.gr(t,"update"),i(!this.Hn),this.Fn.Gt(t))return this.$r(t,"update"),void this._r(t);w.Dt&&w.Ft(g,"Update",s(t));const Code=n(1),Jig=n(5);i(t instanceof Code||t instanceof Jig);const r=d((()=>t.origin===l));i(!r||this.Jt.Gt(t));const o=d((()=>u(t.origin).kt));i(!a(o)),this.$r(t,"update"),this.Fn.ar(t),this.mr(t,!1,"update"),this.Er(t,e),this._r(t)}hr(t){if(this.gr(t,"delete"),i(!this.Hn),this.Mn.Gt(t))return this.$r(t,"delete"),void this._r(t);w.Dt&&w.Ft(g,"Delete",s(t));const Code=n(1),Jig=n(5);i(t instanceof Code||t instanceof Jig);const e=d((()=>u(t.origin).kt));i(!a(e)),this.$r(t,"delete"),this.Mn.ar(t),this.mr(t,!1,"delete"),this.Er(t),this._r(t),d((()=>{t.owner=null,t.satoshis=0}))}Wt(t,e){if(this.gr(t,"auth"),i(!this.Hn),this.Bn.Gt(t))return this.$r(t,"auth",!e),void(e||this._r(t));w.Dt&&w.Ft(g,"Auth",s(t));const Code=n(1),Jig=n(5);i(t instanceof Code||t instanceof Jig),i(!this.Jt.Gt(t)),this.$r(t,"auth",!e),this.Bn.ar(t),this.mr(t,!1,"auth"),this.Er(t),this._r(t)}_r(t){i(!this.Hn),this.Bt.filter((e=>t!==e)).filter((t=>!!t)).filter((t=>!this.Jt.Gt(t))).forEach((t=>this.Wt(t,!0)))}$r(t,e,n){if(this.Pn(t,n)){const n=this.Mn.Gt(t)?`${s(t)} deleted`:`${s(t)} has an unbound owner or satoshis value`;throw new Error(`${e} disabled: ${n}`)}}Pn(t,e){return this.Ln.Gt(t)||e&&y.Ue(t).Pr()}gr(t,e){if(!this.Bt.length)return;const Berry=n(12),r=this.Bt.some((t=>t instanceof Berry));if(r)throw new Error(`Cannot ${e} ${s(t)} in berry`)}Er(t,e,n){const r=this.ir().Or,o=n||!r,i=this.Kn.get(t);if(i)return!o&&i.Sr&&i.Ar(),void(n||(i.Ir=!0));const s=e||new p(t,o,n);this.Kn.set(t,s)}mr(t,e,r){i(!this.Hn);const o=d((()=>t.location)),c=u(o);if(a(c.ur)){if(c.ur===this.Nn)return;const o=n(36).Rr(c.ur);if(!o&&!e)throw new Error(`Cannot ${r} ${s(t)}: open transaction`);!o||this.Yn.includes(o)||o.jr||this.Yn.push(o)}}nn(t){if(this.Hn)return;w.Dt&&w.Ft(g,"Rollback"),this.Kn.forEach((e=>e.nn(t))),this.Nn===_.Ut.Nn&&(_.Ut=new _);const e=this.ir();this.Jn.sr((t=>e.cr("update",t))),this.Mn.sr((t=>e.cr("update",t))),this.Hn=!0}Ze(){return this.Bt.length<2?null:this.Bt[this.Bt.length-2]}tn(t){try{this.Zn();const e=t();return this.Xn(),e}catch(t){throw this.nn(t),t}}ir(){const t=c();if(this.qn){if(t!==this.qn)throw new Error("Different Run instances must not be used to produce a single update")}else this.qn=t;return this.qn}}_.Ut=new _,t.exports=_},function(t,e,n){const r=n(7),{Y:o,ut:i,tt:s,B:c,F:a}=n(0),{g:h}=n(6),{Tr:u}=n(17),f=/^(?<protocol>error):\/\/(?<error>.*)/s,l=/^(?<protocol>native):\/\/(?<native>[a-zA-Z0-9_$]+)/s,d=/^(?<protocol>record):\/\/(?<record>[a-f0-9]{64})_(?:o(?<vout>[0-9]+)|(?:d(?<vdel>[0-9]+)))$/,p=/^(?<txid>[a-f0-9]{64})?_(?:(?:o(?<vout>[0-9]+))|(?:d(?<vdel>[0-9]+)))$/s,w=/^(?<txid>[a-f0-9]{64})_(?:(?:o(?<vout>[0-9]+))|(?:d(?<vdel>[0-9]+)))(?:\?berry=(?<berry>[a-zA-Z0-9\-_.!~*'()%]*)(&hash=(?<hash>[a-f0-9]{64}))?(&version=(?<version>[1-9][0-9]*))?)?$/s,y=["location","origin","nonce"],b=["owner","satoshis"],g=y.concat(b),_="error://Undeployed";t.exports={ce:function(t){if("string"!=typeof t)throw new Error(`Location is not a string: ${o(t)}`);const e=t.match(p)||t.match(w)||t.match(d)||t.match(f)||t.match(l);if(e){const n={},r=e.groups;return"record"===r.protocol&&(n.ur=r.record),"error"===r.protocol&&(n.Qt=r.error),"native"===r.protocol&&(n.kt=r.native),s(r.txid)&&(n.ze=r.txid),s(r.vout)&&(n.Ve=parseInt(r.vout)),s(r.vdel)&&(n.He=parseInt(r.vdel)),s(r.berry)&&(n.qe=decodeURIComponent(r.berry)),s(r.hash)&&(n._hash=r.hash),s(r.version)&&(n.Tr=u(parseInt(r.version))),t===_&&(n.Ae=!0),n}throw new Error(`Bad location: ${o(t)}`)},Cn:function(t){if(c("object"==typeof t&&t),s(t.Qt))return`error://${t.Qt}`;if(s(t.kt))return`native://${t.kt}`;let e="";s(t.ur)&&(e=`record://${t.ur}`),s(t.ze)&&(e=t.ze);let n="";s(t.Ve)&&(n=`_o${t.Ve}`),s(t.He)&&(n=`_d${t.He}`);const r=[];return s(t.qe)&&(r.push(`berry=${encodeURIComponent(t.qe)}`),s(t._hash)&&r.push(`hash=${t._hash}`),s(t.Tr)&&r.push(`version=${t.Tr}`)),`${e}${n}${r.length?`?${r.join("&")}`:""}`},ae:function(t){if(Number.isInteger(t)&&t>=1)return t;throw new Error(`Invalid nonce: ${o(t)}`)},he:function(t,e=!1,i){const CommonLock=n(42);if("string"==typeof t){try{const e=new r.PublicKey(t,{network:i}),n=i?"testnet"===i:void 0;return new CommonLock(e.toAddress().toString(),n)}catch(t){}try{const e=new CommonLock(t,i?"testnet"===i:"mainnet"!==i&&void 0);return e.script(),e}catch(t){}}const{Lock:s}=n(51);if(t instanceof s)return t;if(null===t&&e)return null;throw new Error(`Invalid owner: ${o(t)}`)},ue:function(t,e){if("number"!=typeof t)throw new Error("satoshis must be a number");if(!Number.isInteger(t))throw new Error("satoshis must be an integer");if(t<0)throw new Error("satoshis must be non-negative");let n=null;try{n=a()}catch(t){}const r=e?Number.MAX_SAFE_INTEGER:n?n.Cr:1e8;if(t>r)throw new Error(`satoshis must be <= ${r}`);return t},De:function(t){h((()=>{i(t,"location",_),i(t,"origin",_),i(t,"nonce",0),i(t,"owner",undefined),i(t,"satoshis",undefined)}))},Nr:y,kr:b,ie:g,Ye:_,Ur:0}},function(t,e){class ArgumentError extends Error{constructor(t="Unknown reason"){super(t),this.name=this.constructor.name}}class ClientModeError extends Error{constructor(t,e){super(`Cannot load ${t}\n\n${`Only cached ${e}s may be loaded in client mode`}`),this.data=t,this.type=e,this.name=this.constructor.name}}class ExecutionError extends Error{constructor(t){super(t),this.name=this.constructor.name}}class InternalError extends Error{constructor(t){super(t),this.name=this.constructor.name}}class NotImplementedError extends Error{constructor(t){super(t),this.name=this.constructor.name}}class TimeoutError extends Error{constructor(t){super(t),this.name=this.constructor.name}}class TrustError extends Error{constructor(t,e){super(`Cannot load untrusted code${e?" via "+e:""}: ${t}\n\nHint: Trust this txid using run.trust(txid) if you know it is safe`),this.txid=t,this.from=e,this.name=this.constructor.name}}t.exports={ArgumentError,ClientModeError,ExecutionError,InternalError,NotImplementedError,TimeoutError,TrustError}},function(t,e,n){class BerryDeps{static get Pt(){return n(20)}static get wn(){return n(10)}static get Ot(){return n(3)}static get gn(){return n(15)}static get _n(){return n(21)}static get xt(){return n(0)}static get Dr(){return n(12)}static get At(){return n(9)}static get En(){return n(24)}static get g(){return n(6).g}static get jt(){return n(27)}}class Berry{constructor(...t){const e=BerryDeps.Pt,n=BerryDeps.xt.I,r=BerryDeps.Dr,o=BerryDeps._n,i=BerryDeps.gn.Fr,s=BerryDeps.En,{Ye:c}=BerryDeps.wn;if(this.constructor===r)throw new Error("Berry must be extended");i(this.constructor),this.location=c,this.origin=c,this.nonce=0,this.owner=null,this.satoshis=0;const a=s.Mr(!1),h=new o(this,a);return n.add(h),a.Br=!1,e.Lr(this.constructor,h,t),a.Br=!0,h}static[Symbol.hasInstance](t){if(!BerryDeps.xt.I.has(t))return!1;if(this===BerryDeps.Dr)return!0;const e=BerryDeps.Ot.Kt(this);return!!e&&BerryDeps.g((()=>{let n=Object.getPrototypeOf(t);for(;n;){if(n.constructor.location===e.location)return!0;n=Object.getPrototypeOf(n)}return!1}))}static async pluck(t,e,n){return new this}static load(t){const{F:e,Y:n,W:r}=BerryDeps.xt,o=BerryDeps.gn,i=BerryDeps.Dr,s=BerryDeps.At.Ut;if(BerryDeps.jt.Mt)throw new Error("load disabled during atomic update");if(this!==i&&!r(this,i))throw new Error("load unavailable");if(s.Bt.length)throw new Error("load cannot be called internally");const c=e(),a=o(t,this===i?void 0:this,c);return(async()=>{const e=await a;if(e instanceof this)return e;throw new Error(`Cannot load ${t}\n\n${n(e)} not an instance of ${n(this)}`)})()}init(...t){}}Berry.deps={BerryDeps},Berry.sealed=!1,Berry.toString();const r=BerryDeps.Ot.zt();BerryDeps.Ot.Tt(r).Vt(Berry,!1),t.exports=r},function(t,e,n){const r=n(7),{Script:o,Transaction:i}=r,{Interpreter:s}=o,{Input:c}=i,{ECDSA:a,Signature:h}=r.crypto,{BufferReader:u,BufferWriter:f}=r.encoding,{BN:l}=r.deps.bnjs,d=new Map;async function p(t,e,n,r,o){const i=t.inputs[n];async function s(e){const n=new f;if(void 0===e){if(t._hashOutputsAll)return t._hashOutputsAll;t.outputs.forEach((t=>{t.toBufferWriter(n)}))}else t.outputs[e].toBufferWriter(n);const r=n.toBuffer(),o=await y(r);return void 0===e&&(t._hashOutputsAll=o),o}let c=Buffer.alloc(32),a=Buffer.alloc(32),l=Buffer.alloc(32);e&h.SIGHASH_ANYONECANPAY||(c=await async function(){if(t._hashPrevouts)return t._hashPrevouts;const e=new f;t.inputs.forEach((t=>{e.writeReverse(t.prevTxId),e.writeUInt32LE(t.outputIndex)}));const n=e.toBuffer();return t._hashPrevouts=await y(n),t._hashPrevouts}()),e&h.SIGHASH_ANYONECANPAY||(31&e)===h.SIGHASH_SINGLE||(31&e)===h.SIGHASH_NONE||(a=await async function(){if(t._hashSequence)return t._hashSequence;const e=new f;t.inputs.forEach((t=>{e.writeUInt32LE(t.sequenceNumber)}));const n=e.toBuffer();return t._hashSequence=await y(n),t._hashSequence}()),(31&e)!==h.SIGHASH_SINGLE&&(31&e)!==h.SIGHASH_NONE?l=await s():(31&e)===h.SIGHASH_SINGLE&&n<t.outputs.length&&(l=await s(n));const d=new f;d.writeInt32LE(t.version),d.write(c),d.write(a),d.writeReverse(i.prevTxId),d.writeUInt32LE(i.outputIndex),d.writeVarintNum(r.toBuffer().length),d.write(r.toBuffer()),d.writeUInt64LEBN(o),d.writeUInt32LE(i.sequenceNumber),d.write(l),d.writeUInt32LE(t.nLockTime),d.writeUInt32LE(e>>>0);const p=d.toBuffer(),w=await y(p);return new u(w).readReverse()}async function w(t){const sha256=n(31).Gr,e=await sha256(t);return r.deps.Buffer.from(e)}async function y(t){const e=await w(t);return await w(e)}t.exports={Jr:function(t){if(t.Wr)return;t.Wr=!0,i.FEE_PER_KB=50;const e=i.prototype.sign;i.prototype.sign=function(...t){const n=c.prototype.isValidSignature;c.prototype.isValidSignature=()=>!0;const r=e.call(this,...t);return c.prototype.isValidSignature=n,r},c.prototype.clearSignatures=()=>{},c.prototype.getSignatures=()=>[],c.prototype.isFullySigned=function(){return!!this.script.toBuffer().length},i.prototype.isFullySigned=function(){return!this.inputs.some((t=>!t.isFullySigned()))},i.prototype.isValidSignature=function(t){const e=new s,n=t.inputIndex,r=this.inputs[n],o=s.SCRIPT_VERIFY_STRICTENC|s.SCRIPT_VERIFY_DERSIG|s.SCRIPT_VERIFY_LOW_S|s.SCRIPT_VERIFY_NULLDUMMY|s.SCRIPT_VERIFY_SIGPUSHONLY|s.SCRIPT_ENABLE_MONOLITH_OPCODES|s.SCRIPT_ENABLE_MAGNETIC_OPCODES|s.SCRIPT_ENABLE_SIGHASH_FORKID;return e.verify(r.script,r.output.script,this,n,o,r.output.satoshisBN)}},Yr:function(t,e){const n=8+(t<=75?1:t<=255?2:t<=65535?3:5)+t+148;return Math.ceil(3*n*e/1e3)},Kr:async function(t){const e=d.get(t);if(e)return d.delete(t),d.set(t,e),e;const n=(await w(new r.Script(t).toBuffer())).reverse().toString("hex");if(d.set(t,n),d.size>100){const t=d.keys().next().value;d.delete(t)}return n},zr:p,Vr:async function(t,e,n,r,o,i=h.SIGHASH_ALL){i|=h.SIGHASH_FORKID;const s=new l(r),c=await p(t,i,e,n,s),u=a.sign(c,o,"little"),f=Buffer.from(u.toDER());return Buffer.concat([f,Buffer.from([255&i])]).toString("hex")},Gr:w,Hr:function(t){const e=r.deps.Buffer.from(t),n=r.crypto.Hash.sha256(e);return new Uint8Array(n)}}},function(t,e,n){const{V:r,K:o,Y:i,H:s,q:c,Z:a,X:h,ut:u,B:f}=n(0),{qr:l}=n(16),d=n(23),p=n(8),w=p.$,y=p._,b=p.P,g=p.O,_=w.Object,m=y.Object;t.exports={ot:function t(e,n,r=new Set){if("function"!=typeof e&&"object"!=typeof e||!e)return void n(e);if(r.has(e))return;if(r.add(e),!1===n(e))return;if(e instanceof w.Set||e instanceof y.Set)for(const o of e)t(o,n,r);if(e instanceof w.Map||e instanceof y.Map)for(const[o,i]of e)t(o,n,r),t(i,n,r);l(e).forEach((o=>{t(e[o],n,r)})),"object"!=typeof e||b.has(e.constructor)||g.has(e.constructor)||t(e.constructor,n,r);const o=Object.getPrototypeOf(e);"function"==typeof e&&o!==_.getPrototypeOf(_)&&o!==m.getPrototypeOf(m)&&t(o,n,r)},Zr:function t(e,r,o=new Map){if("function"!=typeof e&&"object"!=typeof e||!e)return e;if(o.has(e))return o.get(e);let i=!0;const s=r(e,(t=>{i=t}))||e;if(o.set(e,s),"function"!=typeof s&&"object"!=typeof s||!s||!i)return s;const c=n(8),Code=n(1),a=c.$,h=c._,d=c.P,p=c.O,w=a.Object,y=h.Object;if(s instanceof a.Set||s instanceof h.Set){const e=Array.from(s);for(let n=0;n<e.length;n++)e[n]=t(e[n],r,o);s.clear(),e.forEach((t=>s.add(t)))}if(s instanceof a.Map||s instanceof h.Map){const e=Array.from(s);for(let n=0;n<e.length;n++)e[n][0]=t(e[n][0],r,o),e[n][1]=t(e[n][1],r,o);s.clear(),e.forEach((t=>s.set(t[0],t[1])))}if(l(s).forEach((e=>{const n=s[e],i=t(n,r,o);n!==i&&u(s,e,i)})),"object"==typeof s&&!d.has(s.constructor)&&!p.has(s.constructor)){const e=t(s.constructor,r,o);Object.getPrototypeOf(s)!==e.prototype&&Object.setPrototypeOf(s,e.prototype)}const b=Object.getPrototypeOf(s);if("function"==typeof s&&b!==w.getPrototypeOf(w)&&b!==y.getPrototypeOf(y)){const e=t(b,r,o);if(b!==e){f(s!==e),Object.setPrototypeOf(s,e);const t=s instanceof Code?Object.getPrototypeOf(s.prototype):s.prototype;Object.setPrototypeOf(t,e.prototype)}}return s},oe:function t(e,f,d,p=new Map){if("symbol"==typeof e)throw new Error(`Cannot clone: ${i(e)}`);if("function"!=typeof e&&"object"!=typeof e||!e)return e;if(p.has(e))return p.get(e);if(d){const t=d(e);if(t)return p.set(e,t),t}const w=n(8),Creation=n(4),y=w.$,b=w.P,g=w.O;if(f=f||y,e instanceof Creation)return e;if("function"==typeof e)throw new Error(`Cannot clone non-code function: ${i(e)}`);if(b.has(e)||g.has(e))throw new Error(`Cannot clone intrinsic: ${i(e)}`);let _=null;if(r(e)&&(_=new f.Array),o(e)&&(_=new f.Object),a(e))return new f.Uint8Array(f.Array.from(e));s(e)&&(_=new f.Set),c(e)&&(_=new f.Map);let m=!1;if(_||(m=!0,_=new f.Object),!_)throw new Error(`Cannot clone: ${i(e)}`);if(p.set(e,_),_ instanceof f.Set)for(const n of e){const e=t(n,f,d,p);_.add(e)}if(_ instanceof f.Map)for(const n of e){const e=t(n[0],f,d,p),r=t(n[1],f,d,p);_.set(e,r)}if(l(e).forEach((n=>{if("symbol"==typeof n)throw new Error(`Cannot clone: ${i(n)}`);u(_,n,t(e[n],f,d,p))})),!b.has(e.constructor)&&!g.has(e.constructor)){const n=t(e.constructor,f,d,p);Object.setPrototypeOf(_,n.prototype)}if(m&&!h(_))throw new Error(`Cannot clone: ${i(e)}`);return _},Xr:function t(e,i,h={}){if(typeof e!=typeof i)return!1;if("number"==typeof e&&isNaN(e)&&isNaN(i))return!0;const Creation=n(4);if(e instanceof Creation)return d.Ke(e,i);if("object"!=typeof e||!e||!i)return e===i;const u=Object.getOwnPropertyNames(e),f=Object.getOwnPropertyNames(i),l=Object.getOwnPropertyDescriptors(e),p=Object.getOwnPropertyDescriptors(i),w=u.filter((t=>l[t].enumerable)),y=f.filter((t=>p[t].enumerable));if(w.length!==y.length)return!1;if(h.Qr)for(let n=0;n<w.length;n++){const r=w[n],o=y[n];if(r!==o)return!1;if(!t(e[r],i[o]))return!1}else{if(w.some((t=>!y.includes(t))))return!1;if(w.some((n=>!t(e[n],i[n],h))))return!1}if(o(e))return!!o(i);if(r(e))return!!r(i);if(s(e))return!!s(i)&&(e.size===i.size&&!!t(Array.from(e.entries()),Array.from(i.entries())));if(c(e))return!!c(i)&&(e.size===i.size&&!!t(Array.from(e.entries()),Array.from(i.entries())));if(a(e))return!!a(i);throw new Error(`Unsupported: ${e}`)}}},function(t,e,n){const r=n(7),{Transaction:o}=r,i=n(2),{B:s,W:c,Y:a,bt:h,tt:u}=n(0),{eo:f}=n(16),{ce:l,Cn:d,Ye:p}=n(10),{g:w}=n(6),y=n(8),{ArgumentError,ClientModeError,TrustError}=n(11),{no:b}=n(17),{Gr:g}=n(13),{ro:_}=n(33),{ExecutionError}=n(11),Code=n(1),m=n(3),E=y._,v=y.$,$="Load",P=new Map;let O=[],S=0,x=null;class A{constructor(){this.oo=new Map,this.io=new Map,this.so=[]}}async function I(t,e,r,o,f,p=!0){s(r),o=o||new A,f=f||new h("load",r.Et);try{if(f.vt(),!e){const e=o.oo.get(t);if(e)return e}const s=async function(t,e,r,o,s){s.vt(),e?i.te&&i.qt($,"Load",t,"with",a(e)):i.te&&i.qt($,"Load",t);const h=new Date;try{if(e)return await async function(t,e,r,o,i){i.vt();const Berry=n(12);if(!c(e,Berry))throw new ArgumentError("Berry class must extend from Berry");if("string"!=typeof t)throw new ArgumentError("Berry path must be a string");const B=m.Qe(e);if(w((()=>l(B.location))).ze){const e={qe:t,Tr:b},s=Object.assign(l(B.location),e),c=d(s),a=`${c.includes("?")?"berry":"jig"}://${c}`,h={all:!0,tx:!r.co.has("state")},u=r.ao&&await r.ao.pull(a,h);if(u){const t=n(43),e=await t(c,u,void 0,r,o,i);return o.so.push(e.ho),e.uo}}return j(t,null,b,B,r,o,i)}(t,e,r,o,s);const f=l(t);if(u(f.Qt)||u(f.ur))throw new ArgumentError(`Bad location: ${t}`);if(u(f.kt))return function(t,e){e.vt();const{kt:n}=l(t),r=m.rn(n);if(!r)throw new ArgumentError(`Native code not found: ${n}`);if(m.Tt(r).me)throw new ArgumentError(`${a(r)} cannot be a dependency`);return r}(t,s);if(!f.ze)throw new ArgumentError(`Bad location: ${t}`);return u(f.qe)?await async function(t,e,r,o){const i=async()=>{o.vt();const i=l(t),s=i.ze+(u(i.Ve)?`_o${i.Ve}`:`'_d${i.He}`),c=i.qe,a=i._hash,h=i.Tr||b,f=d({ze:i.ze,He:i.He,Ve:i.Ve,qe:c,Tr:h}),p=`${t.includes("?")?"berry":"jig"}://${f}`,w={all:!0,tx:!e.co.has("state")},y=e.ao&&await e.ao.pull(p,w);if(y){const i=n(43),s=await i(t,y,a,e,r,o);return r.so.push(s.ho),s.uo}return j(c,a,h,await I(s,null,e,new A,o),e,r,o)};return await T(t,i,e,r,o)}(t,r,o,s):await R(t,r,o,s)}finally{i.Dt&&i.Ft($,"Load (end): "+(new Date-h)+"ms")}}(t,e,r,o,f);e||o.oo.set(t,s);const h=await s;if(p)for(;o.so.length;){const t=o.so;o.so=[],await Promise.all(t)}return h}catch(t){throw S&&(x=x||t),t}}async function R(t,e,r,i){return await T(t,(async()=>{i.vt();const s=`${t.includes("?")?"berry":"jig"}://${t}`,c={all:!0,tx:!e.co.has("state")},a=e.ao&&await e.ao.pull(s,c);return a?async function(t,e,r,i,s){const{ze:c,Ve:a,He:h}=l(t);let u=null;if(!r.co.has("state")){const e=await r.fo(c),n=new o(e),i=_(n),s="number"==typeof a&&a>i.vrun&&a<i.out.length+i.vrun+1,f="number"==typeof h&&h>=0&&h<i.del.length;if(!s&&!f)throw new ArgumentError(`Not a jig: ${t}`);u=s?i.out[a-i.vrun-1]:i.del[h]}const f=n(43),d=await f(t,e,u,r,i,s);return i.so.push(d.ho),d.uo}(t,a,e,r,i):async function(t,e,r,i){if(i.vt(),e.lo)throw new ClientModeError(t,"jig");const{ze:s,Ve:c,He:a}=l(t),h=await e.fo(s),u=new o(h);let f=null;try{f=_(u)}catch(t){throw new ExecutionError(t.message)}let d=null;if(r.io.has(s))d=await r.io.get(s);else{if(P.has(s))return await P.get(s),await R(t,e,r,i);try{const t=n(34),o=t(u,s,f,e,!0,null,i,!1);r.io.set(s,o),P.set(s,o),d=await o}finally{r.io.delete(s),P.delete(s)}}const p=d.ur;if(p.Jn.sr((t=>e.cr("load",t))),p.Mn.sr((t=>e.cr("load",t))),"number"==typeof c&&c>f.vrun&&c<p.Jn.pr+f.vrun+1)return p.Jn.yr()[c-f.vrun-1];if("number"==typeof a&&a>=0&&a<p.Mn.pr)return p.Mn.yr()[a];throw new ArgumentError(`Jig not found: ${t}`)}(t,e,r,i)}),e,r,i)}async function j(t,e,o,B,c,h,u){u.vt(),s(B instanceof Code),i.te&&i.qt($,"Pluck",a(B),t);const b={f:c.fo.bind(c),se:t=>{x=x||t}},[_]=y.Tn("async function(txid) {\n    try {\n      return await f(txid)\n    } catch (e) {\n      se(e)\n      throw e\n    }\n  }",b);Object.freeze(_);try{const i=!!w((()=>l(B.location))).ze;let s=p;if(i&&(s=d(Object.assign(l(B.location),{qe:t,Tr:o}))),O.push(B),S++,x)throw x;const h=B.pluck(t,_);if(!(h instanceof E.Promise||h instanceof v.Promise))throw new Error("pluck method must be async");const u=await h;if(!u||u.constructor!==B)throw new Error(`Berry must be an instance of ${a(B)}`);if(i){w((()=>{u.location=u.origin=s}));const{do:t}=n(49),i=t(u,o),a=f(i),h=new r.deps.Buffer(a,"utf8"),p=(await g(h)).toString("hex");if(e&&e!==p)throw new Error("Berry state mismatch");const y=d(Object.assign({_hash:p},l(s)));w((()=>{u.location=u.origin=y}));const b=`berry://${s}`;await c.po.set(b,i)}if(x)throw x;return u}catch(t){throw x=x||t,t}finally{0==--S&&(O=[],x=null)}}async function T(t,e,n,r,o){let s;try{s=await n.ao.pull(`ban://${t}`)}catch(e){i.ee&&i.Xt($,`Failure to get from cache ban://${t}\n\n${e.toString()}`)}let c="object"==typeof s&&s;if(c){const e=s.untrusted&&await n.wo(s.untrusted),r=c.reason.includes("Cannot convert undefined or null to object");if(e||r){try{await n.po.set(`ban://${t}`,!1)}catch(e){i.ee&&i.Xt($,`Failure to unban from cache ${t}\n\n${e.toString()}`)}c=!1}}if(c){if(s.untrusted)throw new Error(s.reason);const e=`Hint: If you wish to unban this location: await run.cache.set('ban://${t}', false)`;throw new Error(`Failed to load banned location: ${t}\n\nReason: ${s.reason}\n\n${e}`)}try{return await e(t)}catch(e){if(e instanceof ExecutionError||e instanceof TrustError)try{const r={reason:e.toString()};e instanceof TrustError&&(r.untrusted=e.txid),await n.po.set(`ban://${t}`,r)}catch(e){i.ee&&i.Xt($,`Swallowing failure to cache set ban://${t}`,e.toString())}throw e}}I.yo=A,I.Fr=function(B){const t=O.indexOf(B);if(-1===t)throw new Error("Must only create berry from its berry class");O.splice(t,1)},t.exports=I},function(t,e,n){const{Z:r}=n(0);function o(t,e,n,r,o){"number"==typeof n&&(n=Array(n+1).join(" ")),"string"!=typeof n&&(n="");const i=new Set;return function t(s,c,a,h){const u=n?"\n"+new Array(h+1).join(n):"",f=n?": ":":";if(a&&"function"==typeof a.toJSON&&(a=a.toJSON()),void 0===(a=e?e.call(s,c,a):a))return;if("object"!=typeof a||null===a)return o(a);if(i.has(a))throw new TypeError("Converting circular structure to JSON");let l;if(i.add(a),Array.isArray(a)){const e=[];for(let r=0;r<a.length;r++){const i=t(a,r,a[r],h+1)||o(null);e.push(u+n+i)}l="["+e.join(",")+(e.length?u:"")+"]"}else{let e=Object.keys(a);r&&(e=e.sort(r));const i=[];for(let r=0;r<e.length;r++){const s=e[r],c=t(a,s,a[s],h+1);if(!c)continue;const l=o(s)+f+c;i.push(u+n+l)}l="{"+i.join(",")+(i.length?u:"")+"}"}return i.delete(a),l}({"":t},"",t,0)}function i(t,e){if(typeof t!=typeof e)return"symbol"==typeof t?1:-1;"symbol"==typeof t&&(t=t.toString()),"symbol"==typeof e&&(e=e.toString());const n=parseInt(t),r=parseInt(e),o=n.toString()===t,i=r.toString()===e;return o&&!i?-1:i&&!o?1:o&&i?n-r:t<e?-1:e<t?1:0}t.exports={bo:function(t){const e=(t,e)=>{if(t===e)return 0;if(void 0===t)return 1;if(void 0===e)return-1;const n=null===t?"null":t.toString(),r=null===e?"null":e.toString();return n<r?-1:n>r?1:0},n=Array.prototype.sort;Array.prototype.sort=function(t=e){const r=new Map;return this.forEach(((t,e)=>r.set(t,e))),n.call(this,((e,n)=>{const o=t(e,n);return 0!==o?o:r.get(e)-r.get(n)}))},delete String.prototype.localeCompare;const r=Object.keys;Object.keys=function(t){const e=r(t),n=Object.getOwnPropertyNames(t);return e.sort(((t,e)=>n.indexOf(t)-n.indexOf(e)))},Object.values=function(t){return Object.keys(t).map((e=>t[e]))},Object.entries=function(t){return Object.keys(t).map((e=>[e,t[e]]))};const o=Reflect.getOwnPropertyDescriptor;Reflect.getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor=function(t,e){const n=o(t,e);return n&&"string"==typeof e&&t instanceof Uint8Array&&(n.configurable=!0),n};const i=Reflect.defineProperty;Reflect.defineProperty=Object.defineProperty=function(t,e,n){return n&&"string"==typeof e&&t instanceof Uint8Array&&n.writable&&n.enumerable&&n.configurable?(Reflect.set(t,e,n.value),t):i(t,e,n)};const s=JSON.stringify;JSON.stringify=(e,n,r)=>t(e,n,r,null,s);const c=Function.prototype.toString;Function.prototype.toString=function t(){if(this===Array.prototype.sort)return"function sort() { [native code ] }";if(this===Object.keys)return"function keys() { [native code ] }";if(this===Object.values)return"function values() { [native code ] }";if(this===Object.entries)return"function entries() { [native code ] }";if(this===JSON.stringify)return"function stringify() { [native code ] }";if(this===t)return"function toString() { [native code ] }";if(this===Object.getOwnPropertyDescriptor)return"function getOwnPropertyDescriptor() { [native code ] }";if(this===Reflect.getOwnPropertyDescriptor)return"function getOwnPropertyDescriptor() { [native code ] }";if(this===Object.defineProperty)return"function defineProperty() { [native code ] }";if(this===Reflect.defineProperty)return"function defineProperty() { [native code ] }";const e=c.call(this),n=e.match(/^([a-zA-Z0-9_$]+)\s*\(/);return n&&"function"!==n[1]?`function ${e}`:e}},_o:["Date","Math","eval","XMLHttpRequest","FileReader","WebSocket","setTimeout","setInterval"],mo:o,eo:(t,e,n)=>o(t,e,n,i,JSON.stringify),qr:function(t){return Object.keys(t).sort(i)},Eo:i,ft:function(t,e,n){return n&&"string"==typeof e&&r(t)&&n.writable&&n.enumerable&&n.configurable?(Reflect.set(t,e,n.value),t):Reflect.defineProperty(t,e,n)}}},function(t,e){t.exports={no:5,Tr:function(t){if(5!==t)throw new Error(`Unsupported version: ${t}`);return t},vo:function(t){const e="string"==typeof t&&2===t.length&&parseInt(t,16);if(5===e)return 5;throw new Error(`Unsupported RUN transaction version: ${t}${e>5?"\n\nHint: Upgrade your Run SDK to load this transaction":""}`)},$o:function(t){if("04"===t)return 5;throw new Error(`Unsupported state version: ${t}`)},Po:function(t){if(5===t)return"05";throw new Error(`Unsupported protocol version: ${t}`)},Oo:function(t){if(5===t)return"04";throw new Error(`Unsupported protocol version: ${t}`)}}},function(t,e,n){const r=n(2),{TimeoutError}=n(11),{yt:o}=n(0),i="Request",s={},c={};class RequestError extends Error{constructor(t,e,n,r,o){super(`${e} ${n}\n\n${r} ${o}\n\n${t}`),this.reason=t,this.status=e,this.statusText=n,this.method=r,this.url=o,this.name=this.constructor.name}}async function a(t,e={}){const n=`${(e=Object.assign({},a.defaults,e)).method} ${t}`;const o="GET"===e.method&&e.dedup?f:(t,e,n)=>n(),d="GET"===e.method&&e.cache?l:(t,e,n,r)=>r();return await o(s,n,(async()=>await d(c,n,e.cache,(async()=>await(async t=>e.response?e.response(await t()):await t())((async()=>await u(e.retries,n,(async()=>await async function(){r.te&&r.qt(i,n);let o=null;try{o=await h(t,e.method,e.body,e.timeout,e.headers)}catch(n){throw n.message+=`\n\n${e.method} ${t}`,n}const{data:s,status:c,statusText:a}=o;if(c>=200&&c<300)return s;const u=s&&s.message?s.message.message||s.message:s,f=s&&s.name&&u?`${s.name}: ${u}`:s&&s.name||u;throw new RequestError(f,c,a,e.method,t)}()))))))))}let h=null;async function u(t,e,n){for(let o=0;o<=t;o++)try{return await n()}catch(n){if(o===t)throw n;r.ee&&r.Xt(n.toString()),r.te&&r.qt(i,e,`(Retry ${o+1}/${t})`)}}async function f(t,e,n){const r=t[e];if(r)return new Promise(((t,e)=>r.push({resolve:t,reject:e})));const o=t[e]=[];try{const r=await n();return o.forEach((t=>t.resolve(r))),r}catch(t){throw o.forEach((e=>e.reject(t))),t}finally{delete t[e]}}async function l(t,e,n,r){const o=Date.now();for(const e of Object.keys(t))o>t[e].expires&&delete t[e];const i=t[e];if(i&&o<i.expires){if(i.error)throw i.error;return i.result}if(!n)return await r();try{const i=await r();return t[e]={expires:o+n,result:i},i}catch(r){throw t[e]={expires:o+n,error:r},r}}h=async function(t,e,r,i,s){return new Promise(((c,a)=>{const h=t.startsWith("http://")?n(65):n(66),u=n(67);(s=Object.assign({},s)).accept="application/json",s["accept-encoding"]="gzip";r&&!s["content-type"]&&(s["content-type"]="application/json",r=JSON.stringify(r));const f={method:e,headers:s,timeout:o(i,"timeout")};function l(t,e){const n=t.headers["content-type"];if(n&&n.includes("application/json")&&e)try{e=JSON.parse(e)}catch(t){e=void 0}else n&&n.includes("application/octet-stream")||(e=e.toString());c({data:e,status:t.statusCode,statusText:t.statusMessage})}const d=h.request(t,f,(function(t){let e=Buffer.alloc(0);t.on("data",(t=>{e=Buffer.concat([e,t])})),t.on("end",(()=>{"gzip"===t.headers["content-encoding"]?u.gunzip(e,(function(e,n){if(e)return a(e);l(t,n.toString())})):l(t,e)}))}));r&&d.write(r),d.on("error",(t=>a(t))),d.on("timeout",(()=>{d.abort(),a(new TimeoutError(`Request timed out after ${i}ms`))})),d.end()}))},a.defaults={},a.defaults.method="GET",a.defaults.body=void 0,a.defaults.headers={},a.defaults.timeout=3e4,a.defaults.retries=2,a.defaults.dedup=!0,a.defaults.cache=0,a.So=RequestError,a.xo=u,a.Ao=f,a.po=l,t.exports=a},function(t,e,n){const r=n(7),o=n(15),{B:i,Y:s,L:c,bt:a,tt:h}=n(0),{eo:u}=n(16),{Gr:f}=n(13),{oe:l,ot:d}=n(14),p=n(2),w=n(26),{Yr:y}=n(13),{ce:b,he:g}=n(10),{g:_}=n(6),m=n(48),E=n(8).Io,{Po:v}=n(17),$=n(3),P=n(9),O=n(23),{Transaction:S,Script:x}=r,A="Publish",I=new m,R=new m;async function j(t){try{p.Dt&&p.Ft(A,"Publish",t.ur.Nn);const e=new Date,n=t.qn,o=t.ur;t.Ro()||t.jo(!0);const i=new a("publish",n.Et);await C(t),i.vt();const c=await N(t);i.vt(),await T(t,i),i.vt(),k(t);const h=U(o),u=await D(t,i);i.vt();const f=await M(t,u),l=L(o,h),d=G(t,f,l,h),w=r.Transaction.FEE_PER_KB,y=J(t,d,c,w);await Y(n,o,u,d,y,i),i.vt();const b=await R.To((async()=>{const e=await K(y,t,w);i.vt();let r=null;try{r=await q(e,t,w),i.vt(),Z(r,o,y)}catch(t){try{await H(e,n.Co)}catch(t){p.ne&&p.Qt(A,t)}throw t}let c=null;try{c=await X(t,r,i)}catch(t){try{await H(e,n.Co)}catch(t){p.ne&&p.Qt(A,t)}throw t}if("string"!=typeof c||64!==c.length)throw new Error(`Invalid txid: ${s(c)}`);return i.vt(),c}));i.vt(),W(t,b),await tt(t,u,b),i.vt();(d.exec.some((t=>"DEPLOY"===t.op))||d.exec.some((t=>"UPGRADE"===t.op)))&&n.co.add(b),t.No(),p.Dt&&p.Ft(A,"Publish (end): "+(new Date-e)+"ms")}catch(e){t.ko(e)}}async function T(t,e){const n=await t.Uo(),r=t.ur;for(const t of r.Wn){const e=r.Kn.get(t);if(!(e.lr.origin in n))continue;const o=n[e.lr.origin][1];if(e.lr.nonce<o)throw new Error(`Time travel for ${s(t)}`)}}async function C(t){const Creation=n(4),e=t.ur;async function r(){const n=[];for(let r=0;r<e.Jt.pr;r++){const o=e.Jt.yr()[r],i=void 0===t.Do.get(o).lr.owner&&await t.qn.he.nextOwner();n.push(i)}return n}function o(e){d(e,(e=>{if(e instanceof Creation)return t.ur._read(e),!1}))}p.Dt&&p.Ft(A,"Assign owners"),await I.To((async()=>{const n=await r(),i=[],s=P.Ut;try{P.Ut=t.ur,t.ur.zn=!1;for(const t of n){if(!t){i.push(t);continue}const e=l(t,E,(t=>{if("function"!=typeof t)return;const e=$.Qe(t);return $.Tt(e).Be(),e}));i.push(e)}}finally{P.Ut=s}o(i),t.Fo(),i.forEach(((n,r)=>{if(!n)return;const o=e.Jt.yr()[r];t.Do.get(o).lr.owner=n}));const c=await r(),a=[];for(const t of c){if(!t){a.push(t);continue}const e=l(t,E,(t=>{if("function"!=typeof t)return;return $.Qe(t)}));a.push(e)}a.forEach(((n,r)=>{if(!n)return;const o=e.Jt.yr()[r];t.Do.get(o).lr.owner=n})),o(a),t.ur.rr()})),await t.Mo()}async function N(t){const e=c(t.qn._e.network),n=[],r=P.Ut;try{P.Ut=t.ur,t.ur.Jn.sr((r=>{try{t.ur.tr(r);const o=t.Do.get(r).lr.owner,i=g(o,false,e).script();n.push(i)}finally{t.ur.er()}})),t.ur.rr()}finally{P.Ut=r}return await t.Mo(),n}function k(t){const e=t.ur;e.Jn.sr((e=>{const n=t.Do.get(e).lr;n.satoshis=n.satoshis||0,_((()=>{h(e.owner)||(e.owner=n.owner),h(e.satoshis)||(e.satoshis=n.satoshis)}))})),e.Mn.sr((t=>{_((()=>{i(null===t.owner),i(0===t.satoshis)}))}))}function U(t){const e=new O;for(const n of t.Gn)e.ar(n);for(const n of t.Wn)e.ar(n);for(const n of t.Jt)e.ar(n);return e.yr()}async function D(t,e){if(t.Bo)return t.Bo;const{Lo:r}=n(49),o=new Map,i=t.ur,s=[],c=new Map,a=new Map;i.Jn.sr(((t,e)=>{s.push(t),c.set(t,e)})),i.Mn.sr(((t,e)=>{s.push(t),a.set(t,e)}));for(const n of s){const i=await r(n,t,c,a,e);o.set(n,i)}return t.Bo=o,o}async function F(t){const e=u(t),n=r.deps.Buffer.from(e,"utf8");return(await f(n)).toString("hex")}async function M(t,e){if(t.Go)return t.Go;const n=new Map,r=[];for(const[t,o]of e){if(n.has(t))continue;const e=await F(o).then((e=>n.set(t,e)));r.push(e)}return await Promise.all(r),t.Go=n,n}function L(t,e){const n={Jo:t=>{const n=e.indexOf(t);return i(n>=0),n}};return t.Un.map((t=>({op:t.op(),data:w.Wo(t.data(),n)})))}function G(t,e,n,r){const o=t.ur,s=o.Jn.yr().map((t=>e.get(t))),c=o.Mn.yr().map((t=>e.get(t))),a={Jo:t=>{const e=r.indexOf(t);return i(e>=0),e}},h=o.Jt.yr().map((e=>t.Do.get(e).lr.owner)).map((t=>w.Wo(t,a))),u=o.Wn.yr().map((t=>o.Kn.get(t).lr.location)),f={app:t.Yo,version:t.Tr,base:t.Ko.toString("hex"),vrun:t.Ko.outputs.length,in:o.Gn.pr,ref:u,out:s,del:c,cre:h,exec:n};return p.Dt&&p.Ft(A,"Metadata",JSON.stringify(f,0,2)),f}function J(t,e,n,o){p.Dt&&p.Ft(A,"Create partial tx");const i=new S(t.Ko.toString("hex")),s=r.deps.Buffer,a=s.from("run","utf8"),h=v(e.version),u=s.from(h,"hex"),f=s.from(e.app,"utf8"),l=Object.assign({},e);delete l.app,delete l.version,delete l.vrun,delete l.base;const d=s.from(JSON.stringify(l),"utf8"),w=x.buildSafeDataOut([a,u,f,d]),_=new S.Output({script:w,satoshis:0});i.addOutput(_);const m=c(t.qn._e.network),E=t.ur;return E.Gn.sr((t=>{const e=E.Kn.get(t),n=e.lr.location,{ze:r,Ve:o}=b(n),s=e.lr.satoshis,c=e.lr.owner,a=g(c,false,m).script(),h={txid:r,vout:o,script:x.fromHex(a),satoshis:s};i.from(h)})),E.Jn.sr(((e,r)=>{const s=t.Do.get(e),c=n[r].length/2,a=Math.max(s.lr.satoshis,y(c,o)),h=x.fromHex(n[r]);i.addOutput(new S.Output({script:h,satoshis:a})),r++})),i}async function Y(t,e,r,o,i,s){if(t.zo){p.te&&p.qt(A,"Preverify");const c=new Date;try{const c=n(34),{Vo:a}=c,h="0000000000000000000000000000000000000000000000000000000000000000",u=!1,f=null,l=new a(e,r);await c(i,h,o,t,u,f,s,l)}catch(t){throw p.ne&&p.Qt(A,t),new Error(`Pre-verification failed: ${t.message}`)}p.Dt&&p.Ft(A,"Preverify (end): "+(new Date-c)+"ms")}}function W(t,e){const Code=n(1),r=t.ur;r.Jn.sr(((n,r)=>{const o=t.Ko.outputs.length+1+r,i=t.Do.get(n),s=`${e}_o${o}`;i.lr.origin.startsWith("record://")&&(i.lr.origin=s),i.lr.location=s,_((()=>{n.origin.startsWith("record://")&&(n.origin=s),t.Ho(n)||(n.location=s)})),n instanceof Code&&$.Tt(n).Ie(i.lr)})),r.Mn.sr(((n,r)=>{const o=t.Do.get(n),i=`${e}_d${r}`;o.lr.origin.startsWith("record://")&&(o.lr.origin=i),o.lr.location=i,_((()=>{n.origin.startsWith("record://")&&(n.origin=i),n.location=i})),n instanceof Code&&$.Tt(n).Ie(o.lr)}))}async function K(t,e,n){const o=r.deps.Buffer,i=z(e.ur),s=await V(t,e.qn),c=i.map((t=>o.alloc(t.domain()))),a=[...Array(i.length).keys()].filter((e=>!t.inputs[e].script.toBuffer().length));a.forEach((e=>t.inputs[e].setScript(c[e])));const h=t.toString("hex"),u=await e.qn.Co.pay(h,s);let f=null;try{if("string"!=typeof u)throw new Error;f=new S(u)}catch(t){throw new Error(`Invalid raw transaction returned by purse: ${u}`)}if(t.version!==f.version||t.nLockTime!==f.nLockTime||t.inputs.length>f.inputs.length||t.inputs.some(((t,e)=>f.inputs[e].prevTxId.toString("hex")!==t.prevTxId.toString("hex")))||t.inputs.some(((t,e)=>f.inputs[e].outputIndex!==t.outputIndex))||t.inputs.some(((t,e)=>f.inputs[e].sequenceNumber!==t.sequenceNumber))||t.outputs.length>f.outputs.length||t.outputs.some(((t,e)=>f.outputs[e].script.toHex()!==t.script.toHex()))||t.outputs.some(((t,e)=>f.outputs[e].satoshis!==t.satoshis)))throw new Error("Purse illegally modified tx during payment");return a.forEach((t=>f.inputs[t].setScript(""))),f}function z(t){return t.Gn.yr().map((e=>t.Kn.get(e))).map((t=>t.lr.owner)).map((t=>g(t)))}async function V(t,e){const n=t.inputs,o=n.map((t=>t.prevTxId.toString("hex"))),i=(await Promise.all(o.map((t=>e.fo(t))))).map((t=>new r.Transaction(t))),s=n.map(((t,e)=>i[e].outputs[t.outputIndex])),c=s.map((t=>t.script.toHex())),a=s.map((t=>t.satoshis));return c.map(((t,e)=>({script:t,satoshis:a[e]})))}async function H(t,e){p.te&&p.qt(A,"Cancelling payment"),"function"==typeof e.cancel&&await e.cancel(t.toString("hex"))}async function q(t,e,n){const r=z(e.ur),o=await V(t,e.qn),i=t.toString("hex"),s=await e.qn.he.sign(i,o,r);let c=null;try{if("string"!=typeof s)throw new Error;c=new S(s)}catch(t){throw new Error(`Invalid raw transaction returned by owner: ${s}`)}if(t.version!==c.version||t.nLockTime!==c.nLockTime||t.inputs.length>c.inputs.length||t.inputs.some(((t,e)=>c.inputs[e].prevTxId.toString("hex")!==t.prevTxId.toString("hex")))||t.inputs.some(((t,e)=>c.inputs[e].outputIndex!==t.outputIndex))||t.inputs.some(((t,e)=>c.inputs[e].sequenceNumber!==t.sequenceNumber))||t.outputs.length>c.outputs.length||t.outputs.some(((t,e)=>c.outputs[e].script.toHex()!==t.script.toHex()))||t.outputs.some(((t,e)=>c.outputs[e].satoshis!==t.satoshis)))throw new Error("Owner illegally modified tx during payment");return c}function Z(t,e,n){e.Gn.sr(((n,r)=>{if(t.inputs[r].isFullySigned())return;const o=e.Kn.get(n),i=`${`origin: ${o.lr.origin}`}\n${`location: ${o.lr.location}`}\n${`owner: ${o.lr.owner}`}`,c=t.inputs[r].script.toBuffer().length?"Bad signature":"Missing signature";throw new Error(`${c} for ${s(n)}\n\n${i}`)}));for(let e=0;e<n.inputs.length;e++)if(n.inputs[e].prevTxId.toString("hex")!==t.inputs[e].prevTxId.toString("hex")||n.inputs[e].outputIndex!==t.inputs[e].outputIndex)throw new Error(`Transaction input ${e} changed`);for(let e=0;e<n.outputs.length;e++)if(n.outputs[e].script.toHex()!==t.outputs[e].script.toHex())throw new Error(`Transaction output ${e} changed`)}async function X(t,e,n){let r=null;if("function"==typeof t.qn.Co.broadcast)try{await t.qn.Co.broadcast(e.toString("hex"))}catch(r){throw await Q(r,t,e,n)}try{r=await t.qn._e.broadcast(e.toString("hex"))}catch(r){throw await Q(r,t,e,n)}return"function"==typeof t.qn.ao.broadcast&&await t.qn.ao.broadcast(e.toString("hex")),r}async function Q(t,e,r,i){const s=t.toString();let c=`Broadcast failed: ${t.message}`;if(-1!==s.indexOf("tx has no inputs")||-1!==s.indexOf("insufficient priority")){c=`${c}\n\n${"Hint: Is the purse funded to pay for this transaction?"}`}if(-1!==s.indexOf("Missing inputs")||-1!==s.indexOf("txn-mempool-conflict"))for(const s of r.inputs)try{const r=s.prevTxId.toString("hex"),a=s.outputIndex,h=`${r}_o${a}`,u=await e.qn.qo(r,a);if(!u)continue;let f="Payment";try{const t=await o(h,void 0,e.qn,void 0,i);f=t instanceof n(1)?t.name:t.toString()}catch(t){}c=`${c}\n\n${f} was spent in another transaction\n`,c=`${c}\nLocation: ${h}`,c=`${c}\nSpending Tx: ${u}`}catch(t){}return new Error(c)}async function tt(t,e,n){const r=[],o=t.ur;o.Jn.sr(((o,s)=>{const c=e.get(o);i(c);const a=t.Ko.outputs.length+1+s,h=`jig://${n}_o${a}`;r.push(t.qn.po.set(h,c))})),o.Mn.sr(((o,s)=>{const c=e.get(o);i(c);const a=`jig://${n}_d${s}`;r.push(t.qn.po.set(a,c))})),await Promise.all(r)}j.Zo=T,j.Xo=C,j.Qo=N,j.ti=k,j.ei=U,j.ni=D,j.ri=M,j.oi=L,j.ii=G,j.si=J,j.zo=Y,j.ci=R,j.ai=K,j.hi=H,j.ui=q,j.fi=Z,j.li=X,j.di=W,j.pi=tt,t.exports=j},function(t,e,n){const{wi:r}=n(21),{ie:o,ce:i}=n(10),{B:s,Y:c,G:a,ht:h,tt:u}=n(0),{ot:f,oe:l}=n(14),{NotImplementedError}=n(11),{g:d}=n(6),p=n(2),w=n(25),y="Action";class b{constructor(t){this.yi=t}toString(){return`${this.constructor.name}`}op(){throw new NotImplementedError}data(){throw new NotImplementedError}}class g extends b{constructor(){super(null),this.bi=[],this.gi=[]}toString(){return`Deploy (count: ${this.bi.length})`}op(){return"DEPLOY"}data(){s(this.bi.length===this.gi.length);const t=[];for(let e=0;e<this.bi.length;e++){const n=this.bi[e],r=this.gi[e];t.push(n),t.push(r)}return t}}class _ extends b{constructor(t,e,n){super(t),this.Nt=e,this.lr=n}toString(){return`Upgrade ${c(this.yi)}`}op(){return"UPGRADE"}data(){const t=[];return t.push(this.yi),t.push(this.Nt),t.push(this.lr),t}}class m extends b{constructor(t,e,n){super(t),this._t=e,this._i=n}toString(){return`Call ${c(this.yi)} ${this._t}`}op(){return"CALL"}data(){const t=[];return t.push(this.yi),t.push(this._t),t.push(this._i),t}}class E extends b{constructor(t,e,n){super(e),this.mi=t,this._i=n}toString(){return`New ${c(this.yi)}`}op(){return"NEW"}data(){const t=[];return t.push(this.mi),t.push(this._i),t}}function v(t,e){const r=n(3),o=n(9).Ut,i=a(t);if(!i)return;v(i,e);if(r.Tt(i).kt)return;const s=h(i,"sealed")?i.sealed:"owner";switch(s){case"owner":o.Jt.Gt(i)||o.Wt(i);break;case!0:throw new Error(`Cannot ${e}: ${c(i)} is sealed`);case!1:break;default:throw new Error(`Invalid sealed option: ${s}`)}}function $(t){const Creation=n(4),e=n(9).Ut;d((()=>f(t,(t=>{if(t instanceof Creation)return e._read(t),!1}))))}t.exports={Pt:b,Ei:g,vi:_,$i:m,Pi:E,Be:function(t){const Code=n(1),e=n(9).Ut;s(t.length),s(t.every((t=>t instanceof Code))),p.Dt&&p.Ft(y,"Deploy",t.map((t=>c(t))).join(", ")),e.tn((()=>{t.forEach((t=>e.br(t))),t.forEach((t=>v(t,"deploy"))),t.forEach((t=>e.dr(t)));const n=new g;for(const e of t){const t=e.toString(),r=d((()=>l(Object.assign({},e))));$(r),o.forEach((t=>delete r[t])),s(!r.presets),n.bi.push(t),n.gi.push(r)}e.nr(n)}))},en:function(t,e){const Code=n(1),r=n(9).Ut;if(s(t instanceof Code),p.Dt&&p.Ft(y,"Upgrade",c(t)),u(i(d((()=>t.location))).He))throw new Error("Cannot upgrade destroyed jig");r.tn((()=>{v(t,"upgrade");const n=t.toString(),i=d((()=>l(Object.assign({},t))));$(i),o.forEach((t=>delete i[t])),s(!i.presets);const c=new _(t,n,i);r.vr(t,e),r.nr(c)}))},Yt:function(t){const e=n(9),Code=n(1),Jig=n(5),r=e.Ut;s(t instanceof Code||t instanceof Jig),p.te&&p.qt(y,"Destroy",c(t)),u(i(d((()=>t.location))).He)||r.tn((()=>{r.hr(t);if(!r.Bt.length){const e=new m(t,"destroy",[]);r.nr(e)}}))},Wt:function(t){const e=n(9).Ut,Code=n(1),Jig=n(5);if(s(t instanceof Code||t instanceof Jig),p.te&&p.qt(y,"Auth",c(t)),u(i(d((()=>t.location))).He))throw new Error("Cannot auth destroyed jigs");e.tn((()=>{e.Wt(t);if(!e.Bt.length){const n=new m(t,"auth",[]);e.nr(n)}}))},Oi:function(t,e,r,o,i=!0){const s=n(9).Ut;p.te&&p.qt(y,"Call",c(t),e),s.tn((()=>{$(r),s.tr(t),o(),s.er();if(!s.Bt.length&&i){const n=new m(t,e,r);s.nr(n)}}))},On:function(t,e,o,i){const Jig=n(5),s=n(9).Ut;p.te&&p.qt(y,"New",c(t)),s.tn((()=>{let n=t;for(;n!==Jig;)s._read(n),n=Object.getPrototypeOf(n);const c=r(e,o);$(c),s.br(e);if(void 0!==e.init(...c))throw new Error("init must not return a value");i&&s.dr(e),w.Ue(e).ke.Si.push("init");if(!s.Bt.length){const n=new E(t,e,c);s.nr(n)}}))},Lr:function(t,e,o){const Berry=n(12),i=n(9).Ut;if(p.te&&p.qt(y,"Pluck",c(t)),i.zn=!1,i.tn((()=>{let n=t;for(;n!==Berry;)i._read(n),n=Object.getPrototypeOf(n);const s=r(e,o);$(s);if(void 0!==e.init(...s))throw new Error("init must not return a value");w.Ue(e).ke.Si.push("init")})),i.Un.length)throw new Error("Not actions allowed during pluck");i.nn()}}},function(t,e,n){const{Sn:r,g:o}=n(6),{B:i,Y:s,ht:c,ut:a,rt:h,it:u,R:f,j:l,C:d,N:p,k:w,U:y,D:b,at:g,H:_,q:m,tt:E,Z:v}=n(0),{Eo:$,ft:P}=n(16),{ce:O,he:S,ue:x,Nr:A,kr:I}=n(10),{oe:R,ot:j,Zr:T}=n(14),C=n(8),N=C._,k=C.$,U=n(25),{re:D}=n(32),F=n(24),M=n(3),L=()=>n(9).Ut,G=()=>L().Bt;let J;let Y=null;class W{constructor(t,e=new F){return i(!U.xi(t)),this.Ai=new U(t,this),this.ke=e,this.yi=e.yi||this.Ai,e.yi||(this.Ii=new WeakMap),this.Ai}Ri(t,e,r){return this.ji()?Reflect.apply(t,e,r):this.Ti((()=>{this.Ci();const c=this.ke;c.Ni&&(e=void 0),this.ki()&&L()._read(this.yi);let a=U.Ue(e),h=a&&a.ke,u=!a||!h.Ui||!c.Di;c.Fi&&u&&"function"==typeof e&&(e=M.Qe(e),a=U.Ue(e),h=a&&a.ke,u=!a||!h.Ui||!c.Di);const Berry=n(12);e instanceof Berry&&"init"===t.name&&(u=!1);const f=a&&a.ke.Si;if(f&&f.includes(t.name))throw new Error(`${t.name} disabled`);if(c.Di&&!a)throw new Error(`Cannot call ${t.name} on ${s(e)}`);if(u)return Reflect.apply(t,e,r);const l=!a.Mi();return L().tn((()=>{G().length||(r=H(e,r)),G().length&&V(r),a.Bi(t.name,"call");const c=l?o((()=>R(r,N))):r;let h=null;const u=Y;try{!l&&Y||(Y={Li:new Set,dr:!1,yi:e});const f=()=>{const r=function(t,e){if(!t)return e;const Creation=n(4);if(!(t instanceof Creation))return null;const r=U.xi(e).name;if("function"!=typeof t[r])return null;if(t[r]===e)return e;const i=U.Ue(e).yi,s=o((()=>i.origin)),c=o((()=>i.nonce)),a=U.Ue(t).Gi(r),h=o((()=>a.origin)),u=o((()=>a.nonce));if(h===s){if(u<c)throw new Error("Method time travel");return t[r]}const f=L().Bt;if(!(f.length>=2&&f[f.length-2]===t))return null;let l=Object.getPrototypeOf(t);for(;l;){const t=g(l,r);if(t===e)return t;const n="function"==typeof l?l:l.constructor;if(t&&o((()=>n.origin===s)))return o((()=>{if(n.nonce<c)throw new Error("Method time travel")})),t;l=Object.getPrototypeOf(l)}return null}(e,this.Ai);if(!r)throw new Error(`Cannot call ${t.name} on ${s(e)}`);const i=U.xi(r),u=U.Ue(r).yi;this.ki()&&L()._read(u),h=Reflect.apply(i,e,c);if(h instanceof N.Promise||h instanceof k.Promise)throw new Error("async methods not supported");V(h),h=a.Ji(h,l),l&&a.Wi()},d=!a.ke.Yi||!a.ke.Yi.includes(t.name);if(n(20).Oi(e,t.name,r,f,d),l){const Creation=n(4);o((()=>j(U.xi(e),(t=>{if(t instanceof Creation)return!1;i(!U.xi(t))}))))}return h}finally{Y=u}}))}))}Ki(t,e,n){return this.ji()?Reflect.construct(t,e,n):this.Ti((()=>(this.Ci(),this.ki()&&L()._read(this.yi),Reflect.construct(t,e,n))))}zi(t,e,n){return this.ji()?P(t,e,n):this.Ti((()=>(this.Ci(),this.Vi(e,n.value,"define"),z(n,!0),this.Hi()&&L().vr(this.yi),n.value=this.qi(n.value),this.Zi(e)&&(Y.dr=!0),P(t,e,n))))}Xi(t,e){return this.ji()?Reflect.deleteProperty(t,e):this.Ti((()=>(this.Ci(),this.Vi(e,void 0,"delete"),this.Hi()&&L().vr(this.yi),Reflect.deleteProperty(t,e))))}Tt(t,e,r){return this.ji()?Reflect.get(t,e,r):this.Ti((()=>{this.Ci();const i=e===Symbol.hasInstance&&t[Symbol.hasInstance]!==N.Function.prototype[Symbol.hasInstance]&&t[Symbol.hasInstance]!==k.Function.prototype[Symbol.hasInstance];if(this.Qi(e)&&!i)return s=e,o((()=>Object.getPrototypeOf(n(1).prototype)[s]));var s;if(this.ts(e))return Reflect.get(t,e,r);if(this.ki()&&L()._read(this.yi),this.es(e))return Reflect.get(t,e,r);this.ns(e,"get");let c=Reflect.get(t,e,r);if(!c)return c;const a=this.Gi(e);return a&&(c=U.Ue(a).rs(c)),c}))}os(t,e){return this.ji()?Reflect.getOwnPropertyDescriptor(t,e):this.Ti((()=>{if(this.Ci(),this.ts(e))return;if(this.ki()&&L()._read(this.yi),this.es(e))return Reflect.getOwnPropertyDescriptor(t,e);this.ns(e,"get descriptor for");const n=Reflect.getOwnPropertyDescriptor(t,e);return n?(n.value=this.rs(n.value),n):n}))}ss(t){return this.ji()?Reflect.getPrototypeOf(t):this.Ti((()=>(this.Ci(),this.ki()&&L()._read(this.yi),Reflect.getPrototypeOf(t))))}Gt(t,e){return this.ji()?Reflect.has(t,e):this.Ti((()=>(this.Ci(),this.ki()&&L()._read(this.yi),!!this.cs(e)||(this.Bi(e,"check"),this.hs(e,"check"),Reflect.has(t,e)))))}us(t){return this.ji()?Reflect.isExtensible(t):this.Ti((()=>(this.Ci(),!0)))}fs(t){return this.ji()?Reflect.ownKeys(t):this.Ti((()=>{this.Ci(),this.ki()&&L()._read(this.yi);let e=Reflect.ownKeys(t);return e=e.sort($),e=e.filter((t=>this.ls(t))),e}))}ds(t){return this.ji()?Reflect.preventExtensions(t):this.Ti((()=>{throw this.Ci(),new Error("preventExtensions disabled")}))}ps(t,e,n,r){return this.ji()?(a(t,e,n),!0):this.Ti((()=>(this.Ci(),r!==this.Ai?(a(r,e,n),!0):(this.Vi(e,n,"set"),this.Hi()&&L().vr(this.yi),n=this.qi(n),this.Zi(e)&&(Y.dr=!0),o((()=>a(t,e,n))),!0))))}ws(t,e){return this.ji()?Reflect.setPrototypeOf(t,e):this.Ti((()=>{throw this.Ci(),new Error("setPrototypeOf disabled")}))}ys(){if(!this.ji())return this.Ti((()=>{this.Ci(),this.ki()&&L()._read(this.yi)}))}bs(t){return this.ji()?t:this.Ti((()=>(this.Ci(),this.rs(t))))}gs(t){return this.ji()?t:this.Ti((()=>(this.Ci(),V(t),t=this.qi(t))))}_s(){if(!this.ji())return this.Ti((()=>{this.Ci(),this.ki()&&L()._read(this.yi)}))}Es(){if(!this.ji())return this.Ti((()=>{this.Ci(),this.Hi()&&L().vr(this.yi),this.vs("update",s(this.yi))}))}Ti(t){const e=L();try{const n=t();if(e.Qt)throw e.Qt;return n}catch(t){throw e.Bt.length&&!e.Qt&&(e.Qt=t),t}}Ci(){const t=U.xi(this.yi);if(!c(t,"location"))return;const{Qt:e,Ae:n}=O(t.location);if(e&&!n)throw new Error(e)}Vi(t,e,n){if("__proto__"===t)throw new Error(`${n} __proto__ disabled`);if("symbol"==typeof t)throw new Error(`Cannot ${n} symbol property`);if(this.cs(t))throw new Error(`Cannot ${n} ${t}: reserved`);this.$s(t,e,n),this.Ps(t,e,n),this.Os(t,e,n),this.hs(t,n),this.Bi(t,n),this.vs(n,t),V(e)}vs(t,e){if(this.ke.Br)throw new Error(`Cannot ${t} ${e}: immutable`);if(this.Ss(),L().Ln.Gt(this.yi))throw new Error(`Cannot ${t} ${e}: unbound`)}ns(t,e){this.xs(t),this.As(t),this.Bi(t,e),this.hs(t,e)}es(t){return"function"==typeof this.Ai&&"prototype"===t||("constructor"===t||"symbol"==typeof t)}xs(t){if(this.Is(t))try{const e=U.xi(this.Ai);if("location"===t||"origin"===t||"nonce"===t){const n=Reflect.get(e,t),r=O("nonce"===t?e.location:n);if(E(r.Ae))throw new Error("Hint: Sync the jig to deploy it");if(E(r.Qt))throw new Error(`A previous error occurred\n\n${r.Qt}`);if(E(r.kt))return;if(!E(r.ze))throw new Error("Hint: Sync the jig to assign it in a transaction");if(E(r.qe)&&!E(r._hash))throw new Error}}catch(e){throw new Error(`Cannot read ${t}${e.message?"\n\n"+e.message:""}`)}}As(t){if(this.Zi(t))try{const e=U.xi(this.Ai);if("owner"===t||"satoshis"===t){const n=Reflect.get(e,t);if(void 0===n)throw new Error("Hint: Sync the jig to bind it in a transaction");const r=!0;"owner"===t&&S(n,r);const o=!0;"satoshis"===t&&x(n,o)}}catch(e){throw new Error(`Cannot read ${t}\n\n${e.message}`)}}Ps(t,e,n){if(this.Is(t))throw new Error(`Cannot ${n} ${t}`)}Os(t,e,n){if(!this.Zi(t))return;if("delete"===n)throw new Error(`Cannot ${n} ${t}`);if(this.Rs())throw new Error(`Cannot ${n} ${t}`);"owner"===t&&S(e,!1),"satoshis"===t&&x(e)}$s(t,e,n){this.ke.js&&("sealed"===t&&"delete"!==n&&M.fn(e),"upgradable"===t&&"delete"!==n&&M.ln(e),"interactive"===t&&"delete"!==n&&M.dn(e))}hs(t,e){if(!this.ke.Ts)return;const n=()=>{const n=`Cannot ${e} ${"symbol"==typeof t?t.toString():t}: reserved`;throw new Error(n)};f.includes(t)&&n(),this.ke.Cs&&d.includes(t)&&n(),this.ke.js&&l.includes(t)&&n(),this.ke.Ns&&p.includes(t)&&n()}Bi(t,e){const n="call"===e,r=n?"method":"property";if(!this.ls(t,n))throw new Error(`Cannot ${e} private ${r} ${t}`)}ls(t,e=!1){if(!this.ke.ks)return!0;if("string"!=typeof t||!t.startsWith("_"))return!0;if("__proto__"===t)return!0;const Jig=n(5),Berry=n(12),r=G();if(!r.length)return!e;const o=r[r.length-1];return"function"==typeof this.yi?o===this.yi||o.constructor===this.yi:(i(this.yi instanceof Jig||this.yi instanceof Berry),o.constructor===this.yi.constructor||o===this.yi.constructor)}Ss(){if(this.ke.Us&&!this.Mi())throw new Error(`Attempt to update ${s(this.yi)} outside of a method`)}rs(t){if(K(t))return t;return t instanceof n(4)||this.Ds(t)?t:this.Fs(t)}Ji(t,e,n=new Set){if(K(t))return t;if(n.has(t))return t;if(U.xi(t))return t;const r=this.Ds(t);if(!r){n.add(t);const r=t=>this.Ji(t,e,n);return o((()=>function(t,e){if(Object.keys(t).forEach((n=>{a(t,n,e(t[n]))})),_(t)){const n=Array.from(t.values());t.clear(),n.forEach((n=>t.add(e(n))))}if(m(t)){const n=Array.from(t.entries());t.clear(),n.forEach((([n,r])=>t.set(e(n),e(r))))}}(t,r))),t}return!e&&r?t:this.Fs(t)}Fs(t){if(K(t))return t;if(U.xi(t))return t;const e=this.Ms();if(e.has(t))return e.get(t);const n="function"==typeof t,r=F.Xe(this.yi,n),o=new W(t,r);return e.set(t,o),o}qi(t){if(K(t))return t;if(t instanceof n(4))return t;const e=U.Ue(t),r=U.xi(t)||t;return e?e.ke.yi===this.yi?r:R(e.Ai,N):(G().length&&Y.Li&&Y.Li.add(r),r)}Gi(t){let e=this.yi,r=this.Ai;for(;!c(r,t);){r=Object.getPrototypeOf(r),i(r),e="object"==typeof r?r.constructor:r;e instanceof n(4)||(e=null),e&&this.ki()&&U.Ue(e).ki()&&L()._read(e)}return e}Wi(){i(Y),T(Y.Li,((t,e)=>{if(!u(t))throw new Error(`Not serializable: ${s(t)}`);if(K(t))return;if(t instanceof n(4))return void e(!1);!function(t){o((()=>{if(Object.getOwnPropertySymbols(t).length)throw new Error("Symbol properties not supported");const e=[];(t instanceof N.Array||t instanceof k.Array)&&e.push("length");const n=!v(t);Object.getOwnPropertyNames(t).filter((t=>!e.includes(t))).map((e=>Object.getOwnPropertyDescriptor(t,e))).forEach((t=>z(t,n)))}))}(t);const r=U.Ue(t);if(!r)return void e(!0);const i=U.xi(t);return e(!1),r.ke.yi===this.yi?i:R(r.Ai,N)})),this.Rs()&&(Y.dr=!0),Y.dr&&L().dr(this.yi)}Ds(t){if(!Y)return!1;if(U.xi(t))return!1;const e=L().Bt;if(!(e.length&&e[e.length-1]===this.yi))return!1;if(Y.Li.has(t))return!0;let n=!1;return j(Y.Li,(e=>!n&&(!U.xi(e)&&(e===t?(n=!0,!1):void 0)))),n&&Y.Li.add(t),n}ji(){return this.ke.Sn&&r()}Qi(t){return this.ke.js&&function(){if(!J){const t=o((()=>Object.getPrototypeOf(n(1).prototype)));J=Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}return J}().includes(t)}cs(t){return this.Bs(t)||this.Ls(t)||this.Gs(t)}Bs(t){return this.ke.js&&w.includes(t)}Ls(t){return this.ke.Cs&&y.includes(t)}Gs(t){return this.ke.Ns&&b.includes(t)}ts(t){return this.Bs(t)&&l.includes(t)||this.Ls(t)&&d.includes(t)||this.Gs(t)&&p.includes(t)}ki(){return this.ke.Js&&G().length}Hi(){return this.ke.Ws&&G().length}Is(t){return this.ke.Ys&&A.includes(t)}Zi(t){return this.ke.Ks&&I.includes(t)}Mi(){const t=G();return t.length&&t[t.length-1]===this.yi}Ms(){return U.Ue(this.yi).Ii}Rs(){const t=U.xi(this.yi);return null===t.owner&&0===t.satoshis}Pr(){return Y&&Y.yi===this.yi&&Y.dr}}function K(t){return["undefined","boolean","number","string","symbol"].includes(typeof t)||null===t}function z(t,e=!0){if(!("value"in t))throw new Error("Descriptor must have a value");if("get"in t)throw new Error("Getters are not supported");if("set"in t)throw new Error("Getters are not supported");if(e&&!t.configurable)throw new Error("Descriptor must be configurable");if(!t.writable)throw new Error("Descriptor must be writable");if(!t.enumerable)throw new Error("Descriptor must be enumerable")}function V(t){if(!h(t))throw new Error(`Not serializable: ${s(t)}`)}function H(t,e){const Code=n(1);t instanceof Code&&M.Tt(t).Be();const Creation=n(4),r=R(e,N,(t=>{if("function"==typeof t&&!(t instanceof Creation)){const e=M.Qe(t);return M.Tt(e).Be(),e}t instanceof Code&&M.Tt(t).Be()}));return D([t,r],[t]),r}W.wi=H,t.exports=W},function(t,e,n){const r=/^\s*function\s+[a-zA-Z0-9$_]+\s*\(.*?{(.*)}\s*$/s,o=/^\s*class\s+[a-zA-Z0-9$_]+\s*{(.*)}\s*$/s,i=/^\s*class\s+[a-zA-Z0-9$_]+\s+extends\s+[a-zA-Z0-9$_]+\s*{(.*)}\s*$/s,s=/^(function\s+)([a-zA-Z0-9$_]+)(\s*)\((.*)$/s,c=/^(class\s+)([a-zA-Z0-9$_]+)(\s*){(.*)$/s,a=/^(class\s+)([a-zA-Z0-9$_]+)(\s*)extends(.*)$/s,h=/^\s*class\s+[a-zA-Z0-9_$]+\s+extends\s+[a-zA-Z0-9_.$]+\s*{/s,u=/^([a-zA-Z0-9_$]+)\s*\(/s,f=/(cov_[a-zA-Z0-9]+\(\).[a-zA-Z0-9\[\]]+\+\+,?)/g;t.exports={Rn:function(t,e){const n=Object.getPrototypeOf(e);if(n.prototype)return t.replace(h,`class ${e.name} extends ${n.name} {`);const r=t.match(u);return r&&"function"!==r[1]?`function ${t}`:t},jn:function(t){const e=t.match(s);if(e)return`${e[1]}${e[3]}(${e[4]}`;const n=t.match(c);if(n)return`${n[1]}${n[3]}{${n[4]}`;const r=t.match(a);if(r)return`${r[1]}${r[3]}extends${r[4]}`;throw new Error(`Bad source code: ${t}`)},xe:function(t,e){if(n(8).cn.includes(e))return t;const r=t.match(/^(function\s)(.*)/s);if(r)return`${r[1]}${e}${r[2]}`;const o=t.match(/^(class\s)(.*)/s);if(o)return`${o[1]}${e}${o[2]}`;throw new Error(`Bad source code: ${t}`)},In:function(t){return process.env.COVER?t.replace(f,""):t},vt:function(t){const e=t.match(r)||t.match(o)||t.match(i);if(!e)throw new Error(`Bad source code: ${t}`);let n=e[1];const s=(t,e,n)=>t.split(e).join(n);n=s(n,/\/\/.*?([\n\r])/s,"\n"),n=s(n,/\/\*.*?\*\//s,""),n=s(n,/(?:`(?:(?:\\`)|[^`])*?`)|(?:"(?:(?:\\")|[^"])*?")|(?:'(?:(?:\\')|[^'])*?')/s,"''");let c=0;for(let e=0;e<n.length;e++)if("{"===n[e]&&c++,"}"===n[e]&&c--,c<0)throw new Error(`Multiple definitions not permitted: ${t}`)}}},function(t,e,n){const{g:r}=n(6),{B:o,Y:i}=n(0);class s{constructor(){this.zs=new Set,this.Vs=new Map,this.Hs=null}ar(t){if(this.zs.has(t))return;const Creation=n(4);o(t instanceof Creation);const e=r((()=>t.origin));if(e.startsWith("error://")||e.startsWith("record://"))return this.zs.add(t),void(this.Hs=null);const s=this.Vs.get(e);if(s){const e=r((()=>t.location)),n=r((()=>s.location));if(e!==n){const r=`${i(t)}: ${e}`,o=`${i(s)}: ${n}`;throw new Error(`Inconsistent worldview\n\n${r}\n${o}`)}}else this.zs.add(t),this.Vs.set(e,t),this.Hs=null}hr(t){if(this.zs.has(t)){const e=r((()=>t.origin));this.Vs.delete(e),this.zs.delete(t),this.Hs=null}const Creation=n(4);o(t instanceof Creation);const e=r((()=>t.origin));if(e.startsWith("error://")||e.startsWith("record://"))return;const s=this.Vs.get(e);if(!s)return;const c=r((()=>t.location)),a=r((()=>s.location));if(c!==a){const e=`${i(t)}: ${c}`,n=`${i(s)}: ${a}`;throw new Error(`Inconsistent worldview\n\n${e}\n${n}`)}this.zs.delete(s),this.Vs.delete(e),this.Hs=null}Gt(t){if(this.zs.has(t))return!0;const Creation=n(4);if(!(t instanceof Creation))return!1;const e=r((()=>t.origin));if(e.startsWith("error://")||e.startsWith("record://"))return!1;const o=this.Vs.get(e);if(!o)return!1;const s=r((()=>t.location)),c=r((()=>o.location));if(s!==c){const e=`${i(t)}: ${s}`,n=`${i(o)}: ${c}`;throw new Error(`Inconsistent worldview\n\n${e}\n${n}`)}return!0}Tt(t){if(this.zs.has(t))return t;const Creation=n(4);if(!(t instanceof Creation))return;const e=r((()=>t.origin));if(e.startsWith("error://")||e.startsWith("record://"))return;const o=this.Vs.get(e);if(!o)return;const s=r((()=>t.location)),c=r((()=>o.location));if(s!==c){const e=`${i(t)}: ${s}`,n=`${i(o)}: ${c}`;throw new Error(`Inconsistent worldview\n\n${e}\n${n}`)}return o}sr(t){let e=0;for(const n of this.zs)t(n,e++)}yr(){return this.Hs=this.Hs||Array.from(this.zs),this.Hs}get pr(){return this.zs.size}[Symbol.iterator](){return this.zs[Symbol.iterator]()}static Ke(t,e){const Creation=n(4);if(!(t instanceof Creation))return!1;if(!(e instanceof Creation))return!1;if(t===e)return!0;const{ce:o}=n(10);return r((()=>{if(o(t.origin).Qt)return!1;if(o(e.origin).Qt)return!1;if(t.origin!==e.origin)return!1;if(t.location!==e.location){const n=`${i(t)}: ${t.location}`,r=`${i(e)}: ${e.location}`;throw new Error(`Inconsistent worldview\n\n${n}\n${r}`)}return!0}))}}t.exports=s},function(t,e,n){const{B:r}=n(0),o=n(25),{no:i}=n(17);class s{constructor(){this.yi=void 0,this.Sn=!1,this.Ys=!1,this.Ks=!1,this.Ts=!1,this.js=!1,this.Cs=!1,this.Ns=!1,this.ks=!1,this.Br=!1,this.Js=!1,this.Ws=!1,this.Di=!1,this.Ui=!1,this.Us=!1,this.Ni=!1,this.Yi=[],this.Si=[],this.Fi=!1,this.Tr=i}static Ce(){const t=new s;return t.yi=void 0,t.Sn=!0,t.Ys=!0,t.Ks=!0,t.Ts=!0,t.js=!0,t.Cs=!1,t.Ns=!1,t.ks=!0,t.Br=!1,t.Js=!0,t.Ws=!0,t.Di=!0,t.Ui=!0,t.Us=!0,t.Ni=!1,t.Si=[],t.Yi=[],t.Fi=!0,t}static Ne(t){const e=new s;return e.yi=void 0,e.Sn=!0,e.Ys=!0,e.Ks=!0,e.Ts=!0,e.js=!0,e.Cs=!1,e.Ns=!1,e.ks=!1,e.Br=!0,e.Js=!0,e.Ws=!1,e.Di=!1,e.Ui=!1,e.Us=!1,e.Ni=!t,e.Si=[],e.Yi=[],e.Fi=!1,e}static Me(){const t=new s;return t.yi=void 0,t.Sn=!0,t.Ys=!0,t.Ks=!0,t.Ts=!1,t.js=!0,t.Cs=!1,t.Ns=!1,t.ks=!1,t.Br=!0,t.Js=!1,t.Ws=!1,t.Di=!1,t.Ui=!1,t.Us=!0,t.Ni=!1,t.Si=[],t.Yi=[],t.Fi=!1,t}static $n(t){const e=new s;return e.yi=void 0,e.Sn=!0,e.Ys=!0,e.Ks=!0,e.Ts=!0,e.js=!1,e.Cs=!0,e.Ns=!1,e.ks=!0,e.Br=!1,e.Js=!0,e.Ws=!0,e.Di=!0,e.Ui=!0,e.Us=!0,e.Ni=!1,e.Si=t?["init"]:[],e.Yi=["init"],e.Fi=!1,e}static Mr(t){const e=new s;return e.yi=void 0,e.Sn=!0,e.Ys=!0,e.Ks=!0,e.Ts=!0,e.js=!1,e.Cs=!1,e.Ns=!0,e.ks=!1,e.Br=!0,e.Js=!0,e.Ws=!1,e.Di=!1,e.Ui=!1,e.Us=!1,e.Ni=!1,e.Si=t?["init"]:[],e.Yi=["init"],e.Fi=!1,e}static Xe(t,e){const n=o.Ue(t);r(n);const i=n.ke,c=new s;return c.yi=t,c.Sn=i.Sn,c.Ys=!1,c.Ks=!1,c.Ts=!1,c.js=!1,c.Cs=!1,c.Ns=!1,c.ks=i.ks,c.Br=i.Br||e,c.Js=i.Js,c.Ws=i.Ws,c.Di=i.Di,c.Ui=!1,c.Us=i.Us,c.Ni=i.Ni,c.Si=[],c.Yi=[],c.Fi=i.Fi,c}}t.exports=s},function(t,e,n){const{H:r,q:o,Z:i,dt:s,wt:c,B:a}=n(0),h=n(8),u=h._,f=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,w=s(Set.prototype),y=s(Map.prototype),b=s(Uint8Array.prototype).concat(s(Object.getPrototypeOf(Uint8Array.prototype))),g=c(Set.prototype),_=c(Map.prototype),m=c(Uint8Array.prototype).concat(c(Object.getPrototypeOf(Uint8Array.prototype))),E=["add","clear","copyWithin","delete","fill","reverse","set","sort"],v=["entries","every","filter","find","findIndex","forEach","get","has","includes","indexOf","join","keys","lastIndexOf","map","reduce","reduceRight","slice","some","subarray","toLocaleString","toString","values",Symbol.iterator];class ${constructor(t,e){const n=new u.Proxy(t,this);return f.set(n,t),l.set(t,e),l.set(n,e),d.set(n,this),this.qs=e,this.Zs=t,this.Xs=r(t),this.Qs=o(t),this.tc=i(t),n}apply(t,e,n){return this.qs.Ri?this.qs.Ri(this.Zs,e,n):Reflect.apply(this.Zs,e,n)}construct(t,e,n){return this.qs.Ki?this.qs.Ki(this.Zs,e,n):Reflect.construct(this.Zs,e,n)}defineProperty(t,e,n){return this.qs.zi?this.qs.zi(this.Zs,e,n):Reflect.defineProperty(this.Zs,e,n)}deleteProperty(t,e){return this.qs.Xi?this.qs.Xi(this.Zs,e):Reflect.deleteProperty(this.Zs,e)}getOwnPropertyDescriptor(t,e){return this.qs.os?this.qs.os(this.Zs,e):Reflect.getOwnPropertyDescriptor(this.Zs,e)}getPrototypeOf(t){return this.qs.ss?this.qs.ss(this.Zs):Reflect.getPrototypeOf(this.Zs)}has(t,e){return this.qs.Gt?this.qs.Gt(this.Zs,e):Reflect.has(this.Zs,e)}isExtensible(t){return this.qs.us?this.qs.us(this.Zs):Reflect.isExtensible(this.Zs)}ownKeys(t){return this.qs.fs?this.qs.fs(this.Zs):Reflect.ownKeys(this.Zs)}preventExtensions(t){return this.qs.ds?this.qs.ds(this.Zs):Reflect.preventExtensions(this.Zs)}set(t,e,n,r){return this.qs.ps?this.qs.ps(this.Zs,e,n,r):Reflect.set(this.Zs,e,n,r)}setPrototypeOf(t,e){return this.qs.ws?this.qs.ws(this.Zs,e):Reflect.setPrototypeOf(this.Zs,e)}get(t,e,n){if(this.Xs&&w.includes(e)||this.Qs&&y.includes(e)||this.tc&&b.includes(e))return this.qs.ys&&this.qs.ys(),Reflect.get(this.Zs,e,this.Zs);if(this.Xs&&g.includes(e)||this.Qs&&_.includes(e)||this.tc&&m.includes(e)){const t=Reflect.get(this.Zs,e,n);if(this.qs.ys&&this.qs.ys(),p.has(t))return p.get(t);const r=new P(this.Xs,this.Qs,this.tc,e),o=new Proxy(t,r);return p.set(t,o),o}return this.qs.Tt?this.qs.Tt(this.Zs,e,n):Reflect.get(this.Zs,e,n)}static Ue(t){return l.get(t)}static xi(t){return f.get(t)}static ec(t,e){const n=f.get(t),r=l.get(t),o=d.get(t);a(n),o.Zs=e,l.delete(n),l.set(e,r),f.set(t,e)}}class P{constructor(t,e,n,r){this.Xs=t,this.Qs=e,this.Z=n,this.nc=r,this._read=v.includes(r),this.vr=E.includes(r),this.rc=t&&["add"].includes(r)||e&&["set"].includes(r)||n&&["copyWithin","fill","reverse","sort"].includes(r),this.oc=t&&["entries","values",Symbol.iterator].includes(r)||e&&["entries","keys","values",Symbol.iterator].includes(r),this.ic=this.oc&&"entries"===r,this.sc=e&&"get"===r,this.cc=t&&["add","delete","has"].includes(r)||e&&["delete","get","has","set"].includes(r),this.ac=e&&"set"===r,this.hc=t&&"forEach"===r||e&&"forEach"===r}apply(t,e,n){const r=$.Ue(e);r&&(r._s&&this._read&&r._s(),r.Es&&this.vr&&r.Es()),this.hc&&(n[0]=t=>r&&r.bs&&t?r.bs(t):t),this.cc&&n[0]&&r&&r.gs&&(n[0]=r.gs(n[0])),this.ac&&n[1]&&r&&r.gs&&(n[1]=r.gs(n[1]));const o=$.xi(e)||e,i=Reflect.apply(t,o,n);return this.rc?e:this.sc?r&&r.bs&&i?r.bs(i):i:this.oc?new S(i,r,this.ic):i}}class O{constructor(t,e,n){this.uc=t,this.qs=e,this.fc=n}next(){const t=this.uc.next(),e={};if(e.done=t.done,e.value=t.value,this.qs&&this.qs.bs)if(this.fc&&e.value){const t=e.value[0]?this.qs.bs(e.value[0]):e.value[0],n=e.value[1]?this.qs.bs(e.value[1]):e.value[1];e.value=[t,n]}else e.value=e.value?this.qs.bs(e.value):e.value;return e}[Symbol.iterator](){return this}}const S=h.Fe(O,{},!0,!1)[0];t.exports=$},function(t,e,n){const{Y:r,K:o,V:i,H:s,q:c,Z:a,tt:h,et:u}=n(0),{qr:f}=n(16),l=n(8),d=l.O,p=l.P,w=new Set(["constructor","prototype"]),y=new Set;"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("").forEach((t=>y.add(t)));const b=(t,e)=>{throw new Error(`Cannot encode ${r(t)}\n\n${e}`)},g=(t,e)=>{throw new Error(`Cannot decode ${r(JSON.stringify(t))}\n\n${e}`)};function _(t,e,n,o,i){switch(typeof t){case"undefined":return function(t){const e=new t.Object;return e.$und=1,e}(o);case"string":case"boolean":return t;case"number":return function(t,e){if(isNaN(t)||!isFinite(t)||u(t)){const n=new e.Object;return isNaN(t)&&(n.$nan=1),t===1/0&&(n.$inf=1),t===-1/0&&(n.$ninf=1),u(t)&&(n.$n0=1),n}return t}(t,o);case"symbol":break;case"object":case"function":return m(t,e,n,o,i)}b(t,`Unsupported type ${r(typeof t)}`)}function m(t,e,h,u,l){if(!t)return null;if(h.has(t)){const e=new u.Object;return e.$dup=u.Array.from(h.get(t)),e}if(h.set(t,e),(d.has(t)||p.has(t))&&b(t,"Unsupported intrinsic"),o(t))return function(t,e,n,o,i){const s=f(t).some((t=>t.startsWith("$"))),c=new o.Object;let a=c,h=e;s&&(c.$obj=new o.Object,a=c.$obj,h=e.concat(["$obj"]));return f(t).forEach((e=>{w.has(e)&&b(t,`Reserved key: ${r(e)}`);const s=h.concat([e.toString()]);a[e]=_(t[e],s,n,o,i)})),c}(t,e,h,u,l);if(i(t))return function(t,e,n,o,i){const s=f(t);if(s.length===t.length){const r=new o.Array;return s.forEach((s=>{const c=e.concat([s.toString()]),a=_(t[s],c,n,o,i);r.push(a)})),r}{const c=new o.Object,a=new o.Object,h=e.concat(["$arr"]);return s.forEach((e=>{w.has(e)&&b(t,`Reserved key: ${r(e)}`);const s=h.concat([e.toString()]);a[e]=_(t[e],s,n,o,i)})),c.$arr=a,c}}(t,e,h,u,l);if(s(t))return function(t,e,n,o,i){const s=new o.Object;s.$set=new o.Array;let c=0;const a=e.concat(["$set"]);for(const e of t){const t=_(e,a.concat([c.toString()]),n,o,i);s.$set.push(t),c++}if(f(t).length){s.props=new o.Object;const c=e.concat(["props"]);f(t).forEach((e=>{w.has(e)&&b(t,`Reserved key: ${r(e)}`);const a=c.concat([e.toString()]);s.props[e]=_(t[e],a,n,o,i)}))}return s}(t,e,h,u,l);if(c(t))return function(t,e,n,o,i){const s=new o.Object;s.$map=new o.Array;let c=0;const a=e.concat(["$map"]);for(const[e,r]of t){const t=new o.Array;t.push(_(e,a.concat([c.toString(),"0"]),n,o,i)),t.push(_(r,a.concat([c.toString(),"1"]),n,o,i)),s.$map.push(t),c++}if(f(t).length){s.props=new o.Object;const c=e.concat(["props"]);f(t).forEach((e=>{w.has(e)&&b(t,`Reserved key: ${r(e)}`);const a=c.concat([e.toString()]);s.props[e]=_(t[e],a,n,o,i)}))}return s}(t,e,h,u,l);if(a(t))return function(t,e,n,r,o){f(t).length!==t.length&&b(t,"Uint8Arrays must not contain props");const i=new r.Object,s=Buffer.from(new Uint8Array(t));return i.$ui8a=s.toString("base64"),i}(t,0,0,u);if(l){const Creation=n(4);if(t instanceof Creation)return function(t,e,n,r,o){const i=new r.Object;return i.$jig=o(t),i}(t,0,0,u,l);if(Object.getPrototypeOf(t).constructor instanceof Creation)return function(t,e,n,o,i){const s=new o.Object,c=Object.assign({},t),a=e.concat(["$arb"]),h=e.concat(["T"]);return Object.keys(c).forEach((e=>{w.has(e)&&b(t,`Reserved key: ${r(e)}`)})),s.$arb=_(c,a,n,o,i),s.T=_(Object.getPrototypeOf(t).constructor,h,n,o,i),s}(t,e,h,u,l)}b(t,"Unsupported object")}function E(t,e,n,o,i){switch(typeof t){case"string":case"boolean":return t;case"number":return function(t){!isNaN(t)&&isFinite(t)||g(t,`Unsupported number ${r(t)}`);return u(t)?0:t}(t);case"object":case"function":return v(t,e,n,o,i)}g(t,`Unsupported type ${r(typeof t)}`)}function v(t,e,n,s,c){if(!t)return null;if(o(t)){let a;if(Object.keys(t).forEach((e=>{e.startsWith("$")&&(a&&g(t,"Multiple $ keys"),a=e)})),"$und"===a&&1===t.$und)return;if("$n0"===a&&1===t.$n0)return-0;if("$nan"===a&&1===t.$nan)return NaN;if("$inf"===a&&1===t.$inf)return 1/0;if("$ninf"===a&&1===t.$ninf)return-1/0;if(!a)return function(t,e,n,o,i){const s=new o.Object;return n.set(t,s),f(t).forEach((c=>{w.has(c)&&g(s,`Reserved key: ${r(c)}`),s[c]=E(t[c],e,n,o,i)})),s}(t,e,n,s,c);if("$obj"===a)return function(t,e,n,i,s){const c=t.$obj;o(c)&&c||g(t,"Invalid $obj");const a=new i.Object;return n.set(t,a),f(c).forEach((t=>{w.has(t)&&g(a,`Reserved key: ${r(t)}`),a[t]=E(c[t],e,n,i,s)})),a}(t,e,n,s,c);if("$arr"===a)return function(t,e,n,i,s){o(t.$arr)&&t.$arr||g(t,"Invalid $arr");const c=new i.Array;n.set(t,c);const a=t.$arr;return f(a).forEach((t=>{w.has(t)&&g(c,`Reserved key: ${r(t)}`),c[t]=E(a[t],e,n,i,s)})),c}(t,e,n,s,c);if("$dup"===a)return function(t,e,n,r,o){const s=t.$dup;i(s)||g(t,"Invalid $dup");let c=e;for(let e=0;e<s.length;e++){const n=s[e];n in c||g(t,"Invalid dup path"),c=c[n]}n.has(c)||g(t,"Invalid dup path");const a=n.get(c);return n.set(t,a),a}(t,e,n);if("$set"===a)return function(t,e,n,s,c){i(t.$set)||g(t,"Invalid $set");h(t.props)&&!o(t.props)&&g(t,"Invalid $set props");const a=new s.Set;n.set(t,a);for(const r of t.$set)a.add(E(r,e,n,s,c));const u=t.props;u&&f(u).forEach((t=>{w.has(t)&&g(a,`Reserved key: ${r(t)}`),a[t]=E(u[t],e,n,s,c)}));return a}(t,e,n,s,c);if("$map"===a)return function(t,e,n,s,c){i(t.$map)||g(t,"Invalid $map");h(t.props)&&!o(t.props)&&g(t,"Invalid $map props");const a=new s.Map;n.set(t,a);for(const r of t.$map){i(r)&&2===r.length||g(t);const o=E(r[0],e,n,s,c),h=E(r[1],e,n,s,c);a.set(o,h)}const u=t.props;u&&f(u).forEach((t=>{w.has(t)&&g(a,`Reserved key: ${r(t)}`),a[t]=E(u[t],e,n,s,c)}));return a}(t,e,n,s,c);if("$ui8a"===a)return function(t,e,n,r,o){"string"!=typeof t.$ui8a&&g(t,"Invalid $ui8a");t.$ui8a.split("").some((t=>!y.has(t)))&&g(t,"Invalid $ui8a base64");const i=Buffer.from(t.$ui8a,"base64"),s=new r.Uint8Array(i);return n.set(s,s),s}(t,0,n,s)}if(i(t))return function(t,e,n,r,o){const i=new r.Array;n.set(t,i);for(const s of t)i.push(E(s,e,n,r,o));return i}(t,e,n,s,c);if(c){if(o(t)&&h(t.$jig))return function(t,e,n,r,o){const i=o(t.$jig);i||g(t,"Not a jig");return n.set(t,i),i}(t,0,n,0,c);if(o(t)&&h(t.$arb)&&h(t.T))return function(t,e,n,r,i){const s=new r.Object;n.set(t,s);const c=E(t.$arb,e,n,r,i);o(c)||g(t,"Invalid $arb");Object.assign(s,c);const a=E(t.T,e,n,r,i);a||g(t,"Not code");return Object.setPrototypeOf(s,a.prototype),s}(t,e,n,s,c)}g(t,`Unsupported object ${r(t)}`)}t.exports={Wo:function(t,e={}){return _(t,[],e.lc||new Map,e._||l.$,e.Jo)},dc:function(t,e={}){return E(t,t,new Map,e._||l.$,e.wc)}}},function(t,e,n){const r=n(7),o=n(9),i=n(34),s=n(2),{B:c,Y:a,bt:h,F:u}=n(0),{ro:f}=n(33),{ArgumentError}=n(11),l="Transaction";class d{constructor(){this.ur=new o,this.ur.Vn=!1,this.ur.zn=!1,this.Ko=new r.Transaction,this.Qn=null,this.yc=null,this.ze=null,this.bc=null,this.gc=null,this._c=null,this.mc=null,this.Ec=null,this.vc=null,this.jr=!1,this.$c=!1}set base(t){const e=new r.Transaction(t);if(e.inputs.length)throw new Error("Only custom outputs are supported in base transactions");this.Ko=e}get base(){return this.Ko.toString("hex")}get outputs(){return[...this.ur.Jn]}get deletes(){return[...this.ur.Mn]}update(t){if("function"!=typeof t)throw new ArgumentError("Invalid callback");if(s.te&&s.qt(l,"Update"),d.Mt)throw new Error("update disabled during atomic update");if(this.mc)throw new Error("update disabled during export");if(this.Ec)throw new Error("update disabled during publish");if(this.gc)throw new Error("update disabled during pay");if(this._c)throw new Error("update disabled during sign");if(this.bc)throw new Error("update disabled during build");if(this.vc)throw new Error("update disabled during cache");if(this.jr)throw new Error("update disabled once published");if(this.$c)throw new Error("update disabled once cached");this.Qn=null,this.yc=null,this.ze=null;const e=o.Ut;try{o.Ut=this.ur,o.Ut.Zn();let n=null;try{d.Mt=!0,n=t()}finally{d.Mt=!1}if(n instanceof Promise)throw new Error("async transactions not supported");return o.Ut.Xn(),n}catch(t){throw this.rollback(),t}finally{o.Ut=e}}pay(){if(d.Mt)throw new Error("pay disabled during atomic update");if(this._c)throw new Error("pay disabled during sign");if(this.mc)throw new Error("pay disabled during export");if(this.Ec)throw new Error("pay disabled during publish");if(this.gc)return this.gc;if(this.bc)throw new Error("pay disabled during build");if(this.vc)throw new Error("pay disabled during cache");if(this.jr)throw new Error("pay disabled once published");if(this.$c)throw new Error("pay disabled once cached");const t=u(),e=new h("pay",t.Et),o=async()=>{const{ci:t,ai:o}=n(19);await t.To((async()=>{const t=r.Transaction.FEE_PER_KB;this.yc=await o(this.yc,this.Qn,t),this.ze=null,e.vt()}))};return this.gc=this.Pc(e,!1).then((()=>o())),this.gc.then((()=>{this.gc=null})).catch((t=>{throw this.gc=null,t})),this.gc}sign(){if(d.Mt)throw new Error("sign disabled during atomic update");if(this.gc)throw new Error("sign disabled during pay");if(this.mc)throw new Error("sign disabled during export");if(this.Ec)throw new Error("sign disabled during publish");if(this._c)return this._c;if(this.bc)throw new Error("sign disabled during build");if(this.vc)throw new Error("sign disabled during cache");if(this.jr)throw new Error("sign disabled once published");if(this.$c)throw new Error("sign disabled once cached");const t=u(),e=new h("sign",t.Et),o=async()=>{const{ci:t,ui:o}=n(19);await t.To((async()=>{const t=r.Transaction.FEE_PER_KB;this.yc=await o(this.yc,this.Qn,t),this.ze=null,e.vt()}))};return this._c=this.Pc(e,!1).then((()=>o())),this._c.then((()=>{this._c=null})).catch((t=>{throw this._c=null,t})),this._c}cache(){s.te&&s.qt(l,"Cache");const t=new Date;if(d.Mt)throw new Error("cache disabled during atomic update");if(this.gc)throw new Error("cache disabled during pay");if(this._c)throw new Error("cache disabled during sign");if(this.mc)throw new Error("cache disabled during export");if(this.Ec)throw new Error("cache disabled during publish");if(this.bc)throw new Error("cache disabled during build");if(this.vc)return this.vc;if(this.$c)return!0;const e=u(),r=new h("cache",e.Et),o=async()=>{const{pi:t,di:e}=n(19);this.ze=this.ze||this.yc.hash,await t(this.Qn,this.Qn.Bo,this.ze),r.vt(),e(this.Qn,this.ze)};this.vc=this.Pc(r,!1).then((()=>o()));return this.vc.then((()=>{s.Dt&&s.Ft(l,"Cache (end): "+(new Date-t)+"ms"),this.$c=!0,this.vc=null})).catch((t=>{throw this.vc=null,t})),this.vc}publish(t={}){s.te&&s.qt(l,"Publish");const e=new Date;if(d.Mt)throw new Error("publish disabled during atomic update");if(this.gc)throw new Error("publish disabled during pay");if(this._c)throw new Error("publish disabled during sign");if(this.mc)throw new Error("publish disabled during export");if(this.Ec)return this.Ec;if(this.jr)return!0;if(this.bc)throw new Error("publish disabled during build");if(this.vc)throw new Error("publish disabled during cache");if(void 0!==t.pay&&"boolean"!=typeof t.pay)throw new ArgumentError(`Invalid pay: ${a(t.pay)}`);if(void 0!==t.sign&&"boolean"!=typeof t.sign)throw new ArgumentError(`Invalid sign: ${a(t.sign)}`);const n=void 0===t.pay||t.pay,r=void 0===t.sign||t.sign;if(this.$c&&n)throw new Error("pay disabled once cached");if(this.$c&&r)throw new Error("sign disabled once cached");const o=u(),i=new h("publish",o.Et);this.Ec=this.Pc(i,!0).then((()=>this.Oc(n,r,i)));return this.Ec=this.Ec.then((()=>{s.Dt&&s.Ft(l,"Publish (end): "+(new Date-e)+"ms"),this.jr=!0,this.Ec=null})).catch((t=>{throw this.Ec=null,t})),this.Ec=this.Ec.then((()=>this.ze)),this.Ec}export(t={}){s.te&&s.qt(l,"Export");const e=new Date;if(d.Mt)throw new Error("export disabled during atomic update");if(this.gc)throw new Error("export disabled during pay");if(this._c)throw new Error("export disabled during sign");if(this.Ec)throw new Error("export disabled during publish");if(this.vc)throw new Error("export disabled during cache");if(this.mc)return this.mc;if(void 0!==t.pay&&"boolean"!=typeof t.pay)throw new ArgumentError(`Invalid pay: ${a(t.pay)}`);if(void 0!==t.sign&&"boolean"!=typeof t.sign)throw new ArgumentError(`Invalid sign: ${a(t.sign)}`);const n=void 0===t.pay||t.pay,r=void 0===t.sign||t.sign;if(this.$c&&n)throw new Error("pay disabled once cached");if(this.$c&&r)throw new Error("sign disabled once cached");if(this.jr&&n)throw new Error("pay disabled once published");if(this.jr&&r)throw new Error("sign disabled once published");const o=u(),i=new h("export",o.Et);this.mc=this.Pc(i,!1).then((()=>this.Sc(n,r,i)));return this.mc.then((t=>(s.Dt&&s.Ft(l,"Export (end): "+(new Date-e)+"ms"),this.mc=null,t))).catch((t=>{throw this.mc=null,t})),this.mc}rollback(){if(s.te&&s.qt(l,"Rollback"),d.Mt)throw new Error("rollback disabled during atomic update");if(this.mc)throw new Error("rollback disabled during export");if(this.Ec)throw new Error("rollback disabled during publish");if(this.gc)throw new Error("rollback disabled during pay");if(this._c)throw new Error("rollback disabled during sign");if(this.bc)throw new Error("rollback disabled during build");if(this.vc)throw new Error("rollback disabled during cache");if(this.jr)throw new Error("rollback disabled once published");this.ur.nn(),this.ur=new o,this.ur.Vn=!1,this.ur.zn=!1}static async xc(t,e,n){s.te&&s.qt(l,"Replay");const r=f(t),o=await i(t,e,r,n,!1,null,undefined,!1),c=new d;return c.ur=o.ur,c.Qn=o,c.yc=t,c.ze=e,c}Pc(t,e){if(this.Qn&&this.yc)return e&&this.Qn.jo(!0),Promise.resolve();if(c(!this.Qn&&!this.yc),this.bc)return this.bc;const n=this.ur.Qn();if(!n)throw new Error("Nothing to commit");return n.Ko=this.Ko,e&&n.jo(!0),this.bc=this.Ac(n,t),this.bc.then((t=>(this.bc=null,t))).catch((t=>{throw this.bc=null,t})),this.bc}async Ac(t,e){try{await t.Mo();const o=t.ur;c(!o.Yn.length);const{Zo:i,Xo:s,Qo:a,ti:h,ei:u,ni:f,ri:l,oi:d,ii:p,si:w,zo:y}=n(19);await s(t),e.vt();const b=await a(t);e.vt(),await i(t,e),e.vt(),h(t);const g=u(o),_=await f(t,e);e.vt();const m=await l(t,_),E=p(t,m,d(o,g),g),v=w(t,E,b,r.Transaction.FEE_PER_KB);await y(t.qn,o,_,E,v,e),e.vt(),this.Qn=t,this.yc=v,this.ze=null}catch(e){throw t.Ro()&&t.ko(e),e}}async Oc(t,e,o){const{ni:i,ci:c,ai:h,hi:u,ui:f,fi:d,li:p,di:w,pi:y}=n(19);this.Qn.Ro()||this.Qn.jo(!0);try{const n=this.Qn.ur,b=await i(this.Qn,o);o.vt(),this.ze=await c.To((async()=>{const i=this.yc,c=r.Transaction.FEE_PER_KB,w=t?await h(i,this.Qn,c):i;o.vt();let y=null;try{y=e?await f(w,this.Qn,c):w,o.vt(),d(y,n,i)}catch(t){try{await u(w,this.Qn.qn.Co)}catch(t){s.ne&&s.Qt(l,t)}throw t}let b=null;try{b=await p(this.Qn,y,o)}catch(t){try{await u(w,this.Qn.qn.Co)}catch(t){s.ne&&s.Qt(l,t)}throw t}if("string"!=typeof b||64!==b.length)throw new Error(`Invalid txid: ${a(b)}`);return o.vt(),b})),o.vt(),w(this.Qn,this.ze),await y(this.Qn,b,this.ze),o.vt();(n.Un.some((t=>"DEPLOY"===t.op()))||n.Un.some((t=>"UPGRADE"===t.op())))&&this.Qn.qn.co.add(this.ze),this.Qn.No()}catch(t){throw this.Qn.ko(t),t}}async Sc(t,e,o){const{ci:i,ai:c,hi:a,ui:h}=n(19),u=await i.To((async()=>{const n=this.yc,i=r.Transaction.FEE_PER_KB,u=t?await c(n,this.Qn,i):n;o.vt();let f=null;try{f=e?await h(u,this.Qn,i):u,o.vt()}catch(t){try{await a(u,this.Qn.qn.Co)}catch(t){s.ne&&s.Qt(l,t)}throw t}return f}));return o.vt(),u.toString("hex")}}d.Mt=!1,t.exports=d},function(t,e){function n(t,e){const n=3&t.length,r=t.length-n;let o=e;const i=3432918353,s=461845907;let c=0,a=0,h=0;for(;c<r;)h=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,h=(65535&h)*i+(((h>>>16)*i&65535)<<16)&4294967295,h=h<<15|h>>>17,h=(65535&h)*s+(((h>>>16)*s&65535)<<16)&4294967295,o^=h,o=o<<13|o>>>19,a=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=27492+(65535&a)+((58964+(a>>>16)&65535)<<16);switch(h=0,n){case 3:h^=(255&t.charCodeAt(c+2))<<16;case 2:h^=(255&t.charCodeAt(c+1))<<8;case 1:h^=255&t.charCodeAt(c),h=(65535&h)*i+(((h>>>16)*i&65535)<<16)&4294967295,h=h<<15|h>>>17,h=(65535&h)*s+(((h>>>16)*s&65535)<<16)&4294967295,o^=h}return o^=t.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0}t.exports={create:function(t=960,e=7){if("number"!=typeof t||!Number.isInteger(t)||t<=0)throw new Error("invalid size: "+t);if(t%8!=0)throw new Error("size must be a multiple of 8: "+t);if("number"!=typeof e||!Number.isInteger(e)||e<=0)throw new Error("invalid numHashes: "+e);return{buckets:new Array(t).fill(0),numHashes:e}},add:function(t,e){if("string"!=typeof e)throw new Error("invalid key: "+e);if(!this.possiblyHas(t,e))for(let r=1;r<=t.numHashes;r++){const o=n(e,r)%t.buckets.length;t.buckets[o]++}},remove:function(t,e){if("string"!=typeof e)throw new Error("invalid key: "+e);const r=[];for(let o=1;o<=t.numHashes;o++){const i=n(e,o)%t.buckets.length;if(!t.buckets[i])return!1;r.push(i)}return r.forEach((e=>t.buckets[e]--)),!0},possiblyHas:function(t,e){for(let r=1;r<=t.numHashes;r++){const o=n(e,r)%t.buckets.length;if(!t.buckets[o])return!1}return!0},toBase64:function(t){const e=t.buckets,n=new Array(1+e.length/8);n[0]=t.numHashes;for(let t=0,r=1;t<e.length;t+=8,r++)n[r]=(e[t+0]>0)<<7|(e[t+1]>0)<<6|(e[t+2]>0)<<5|(e[t+3]>0)<<4|(e[t+4]>0)<<3|(e[t+5]>0)<<2|(e[t+6]>0)<<1|(e[t+7]>0)<<0;return Buffer.from(n).toString("base64")},fromBase64:function(t){const e=Buffer.from(t,"base64"),n=e[0],r=new Array(8*(e.length-1));for(let t=1,n=0;t<e.length;t++,n+=8)r[n+0]=e[t]>>7&1,r[n+1]=e[t]>>6&1,r[n+2]=e[t]>>5&1,r[n+3]=e[t]>>4&1,r[n+4]=e[t]>>3&1,r[n+5]=e[t]>>2&1,r[n+6]=e[t]>>1&1,r[n+7]=e[t]>>0&1;return{numHashes:n,buckets:r}}}},function(t,e,n){const r=n(3);class Hex{static stringToBytes(t){if("string"!=typeof t||t.length%2!=0)throw new Error(`Bad hex: ${t}`);t=t.toLowerCase();const e="0123456789abcdef".split(""),n=[];for(let r=0;r<t.length;r+=2){const o=e.indexOf(t[r]),i=e.indexOf(t[r+1]);if(-1===o||-1===i)throw new Error(`Bad hex: ${t}`);n.push(16*o+i)}return n}static bytesToString(t){if(!Array.isArray(t))throw new Error(`Bad bytes: ${t}`);return t.forEach((t=>{if(!(t=>Number.isInteger(t)&&t>=0&&t<256)(t))throw new Error(`Bad digit: ${t}`)})),t.map((t=>t.toString("16"))).map((t=>1===t.length?"0"+t:t)).join("")}}Hex.toString(),Hex.presets={},Hex.presets.main={},Hex.presets.test={},Hex.presets.main.location="727e7b423b7ee40c0b5be87fba7fa5673ea2d20a74259040a7295d9c32a90011_o1",Hex.presets.main.origin="727e7b423b7ee40c0b5be87fba7fa5673ea2d20a74259040a7295d9c32a90011_o1",Hex.presets.main.nonce=1,Hex.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",Hex.presets.main.satoshis=0,Hex.presets.test.location="1f0abf8d94477b1cb57629d861376616f6e1d7b78aba23a19da3e6169caf489e_o2",Hex.presets.test.origin="1f0abf8d94477b1cb57629d861376616f6e1d7b78aba23a19da3e6169caf489e_o2",Hex.presets.test.nonce=1,Hex.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",Hex.presets.test.satoshis=0,t.exports=r.Te(Hex)},function(t,e,n){const r=n(7),{PrivateKey:o,PublicKey:i,Address:s}=r,c=n(31),{Blockchain:a,Cache:h,Lock:u,Logger:f,Owner:l,Purse:d,State:p}=n(51),Jig=n(5),Berry=n(12),Code=n(1),w=n(3),y=n(36),b=n(15),Creation=n(4),CommonLock=n(42),g=n(27),{re:_}=n(32),m=n(8),E=n(2),{Y:v,lt:$,yt:P}=n(0),{Ic:O,Rc:S}=n(41),x=n(18),{ArgumentError}=n(11),{ro:A,jc:I}=n(33),BrowserCache=n(68),DiskCache=n(52),R=n(71),Inventory=n(72),LocalCache=n(38),LocalOwner=n(53),LocalPurse=n(73),LocalState=n(74),Mockchain=n(75),NodeCache=n(76),PayServer=n(77),RunConnect=n(57),RunDB=n(78),StateServer=n(79),Viewer=n(80),WhatsOnChain=n(81),BlockchainWrapper=n(40),CacheWrapper=n(37),OwnerWrapper=n(44),PurseWrapper=n(45),StateWrapper=n(39),j="Run";class T{constructor(t={}){E.te&&E.qt(j,"Create"),D(t),D(T.defaults);const e=Object.keys(t);this.Tc=F(t.api,e.includes("api"),t.blockchain||T.defaults.blockchain,t.network||T.defaults.network),this.Cc=M(t.apiKey,e.includes("apiKey")),this.Nc=G(t.autofund,e.includes("autofund")),this.Ft=z(t.debug,e.includes("debug")),this.Ht=H(t.logger,e.includes("logger")),this.kc=Z(t.networkRetries,e.includes("networkRetries")),this.Uc=X(t.networkTimeout,e.includes("networkTimeout"));const n=q(t.network,e.includes("network")),r=st(t.wallet,e.includes("wallet"));this.qn=new c,this.qn.Cr=J(t.backingLimit,e.includes("backingLimit")),this.qn.lo=K(t.client,e.includes("client")),this.qn.po=W(t.cache,e.includes("cache"),n),this.qn._e=Y(t.blockchain,e.includes("blockchain"),this.Tc,this.Cc,n),this.qn.ao=rt(t.state,e.includes("state"),n,this.Tc,this.Cc),this.qn.Co=et(t.purse,e.includes("purse"),this.qn._e,r),this.qn.Yo=L(t.app,e.includes("app")),this.qn.he=Q(t.owner,e.includes("owner"),this.qn._e,r),this.qn.Et=ot(t.timeout,e.includes("timeout")),this.qn.co=it(t.trust,e.includes("trust")),this.qn.zo=tt(t.preverify,e.includes("preverify")),this.qn.Or=nt(t.rollbacks,e.includes("rollbacks")),U(this),this.Dc=V(t.inventory,e.includes("inventory")),k(this),this.activate()}get api(){return this.Tc}get apiKey(){return this.Cc}get app(){return this.qn.Yo}get autofund(){return this.Nc}get backingLimit(){return this.qn.Cr}get blockchain(){return this.qn._e}get cache(){return this.qn.po}get client(){return this.qn.lo}get debug(){return this.Ft}get inventory(){return this.Dc}get logger(){return this.Ht}get network(){return this.blockchain.network}get networkRetries(){return this.kc}get networkTimeout(){return this.Uc}get owner(){return this.qn.he}get preverify(){return this.qn.zo}get purse(){return this.qn.Co}get rollbacks(){return this.qn.Or}get timeout(){return this.qn.Et}get state(){return this.qn.ao}get wallet(){return this.qn.Co===this.qn.he?this.qn.Co:void 0}set api(t){t=F(t,!0),this.qn._e=Y(void 0,!1,t,this.Cc,this.network),this.qn.ao=rt(void 0,!1,this.blockchain.network,t,this.Cc),U(this),this.Tc=t}set apiKey(t){t=M(t,!0),this.qn._e=Y(void 0,!1,this.Tc,t,this.network),this.qn.ao=rt(void 0,!1,this.blockchain.network,this.Tc,t),U(this),this.Cc=t}set app(t){this.qn.Yo=L(t,!0)}set autofund(t){this.Nc=G(t,!0),k(this)}set backingLimit(t){t=J(t,!0),this.qn.Cr=t}set blockchain(t){this.qn._e=Y(t,!0),this.Tc=void 0,this.Cc=void 0,this.qn.Co instanceof LocalPurse&&(this.qn.Co.blockchain=this.qn._e),U(this),k(this)}set cache(t){this.qn.po=W(t,!0,this.network),U(this)}set client(t){this.qn.lo=K(t,!0)}set debug(t){this.Ft=z(t,!0),at(this)}set inventory(t){this.Dc&&this.Dc.detach(this),this.Dc=V(t,!0),this.Dc&&this.Dc.attach(this)}set logger(t){this.Ht=H(t,!0),at(this)}set network(t){q(t,!0),this.qn._e=Y(void 0,!1,this.Tc,this.Cc,t),this.qn.ao=rt(void 0,!1,t,this.Tc,this.Cc),U(this)}set networkRetries(t){this.kc=Z(t,!0),C(this)&&(x.defaults.retries=this.kc)}set networkTimeout(t){this.Uc=X(t,!0),C(this)&&(x.defaults.timeout=this.Uc)}set owner(t){const e=Q(t,!0,this.qn._e,null);e!==this.qn.he&&(this.qn.he=e,U(this),this.Dc&&this.Dc.detach(this),this.Dc=new Inventory,this.Dc.attach(this))}set preverify(t){this.qn.zo=tt(t,!0)}set purse(t){this.qn.Co=et(t,!0,this.blockchain,null),U(this)}set rollbacks(t){this.qn.Or=nt(t,!0)}set state(t){this.qn.ao=rt(t,!0,this.network,this.api,this.apiKey),U(this)}set timeout(t){this.qn.Et=ot(t,!0)}set wallet(t){st(t,!0),this.purse=t,this.owner=t}load(t,e={}){if(N(this),g.Mt)throw new Error("load disabled during atomic update");return e.trust&&this.trust(t.slice(0,64)),b(t,void 0,this.qn)}sync(){if(g.Mt)throw new Error("sync all disabled during atomic update");return y.Fc()}deploy(t){N(this);const e=ht(t);return w.Tt(e).Be(),e}transaction(t){N(this);const e=new g,n=e.update(t);return e.publish(),n}import(t,e={}){if(g.Mt)throw new Error("import disabled during atomic update");const n=new r.Transaction(t),o=e.txid||n.hash;return e.trust&&this.trust(o),g.xc(n,o,this.qn)}trust(t){if(t instanceof Array)t.forEach((t=>this.trust(t)));else{if(E.te&&E.qt(j,"Trust",t),!ct(t))throw new ArgumentError(`Not trustable: ${v(t)}`);"cache"===t&&(t="state"),this.qn.co.add(t)}}on(t,e){if(!c.Mc.includes(t))throw new ArgumentError(`Invalid event: ${v(t)}`);if("function"!=typeof e)throw new ArgumentError(`Invalid listener: ${v(P)}`);this.qn.Bc.some((n=>n.Lc===t&&n.Gc===e))||this.qn.Bc.push({Lc:t,Gc:e})}off(t,e){if(!c.Mc.includes(t))throw new ArgumentError(`Invalid event: ${v(t)}`);if("function"!=typeof e)throw new ArgumentError(`Invalid listener: ${v(e)}`);this.qn.Bc=this.qn.Bc.filter((n=>!(n=>n.Lc===t&&n.Gc===e)(n)))}activate(){if(E.te&&E.qt(j,"Activate"),g.Mt)throw new Error("activate disabled during atomic update");return T.instance=this,this.Dc&&this.Dc.attach(this),this.qn.an(),this.logger=this.Ht,this.debug=this.Ft,this.networkRetries=this.kc,this.networkTimeout=this.Uc,this}deactivate(){if(E.te&&E.qt(j,"Deactivate"),g.Mt)throw new Error("deactivate disabled during atomic update");return T.instance=null,this.Dc&&this.Dc.detach(this),this.qn.sn(),this}}function C(t){return c.M===t.qn}function N(t){if(c.M!==t.qn){throw new Error(`This Run instance is not active\n\n${"Hint: Call run.activate() on this instance first"}`)}}function k(t){t.blockchain instanceof Mockchain&&t.purse instanceof LocalPurse&&t.autofund&&t.blockchain.fund(t.purse.bsvAddress,1e10)}function U(t){t.qn._e instanceof BlockchainWrapper&&(t.qn._e.cache=t.qn.po),t.qn.ao instanceof StateWrapper&&(t.qn.ao.cache=t.qn.po),t.qn.Co instanceof PurseWrapper&&(t.qn.Co.blockchain=t.qn._e)}function D(t){if(t.blockchain&&void 0!==t.api&&t.blockchain.api!==t.api)throw new Error(`Blockchain mismatch with "${t.api}" api`);if(t.blockchain&&void 0!==t.apiKey&&t.blockchain.apiKey!==t.apiKey)throw new Error(`Blockchain mismatch with "${t.apiKey}" apiKey`);if(t.blockchain&&void 0!==t.network&&t.blockchain.network!==t.network)throw new Error(`Blockchain mismatch with "${t.network}" network`)}function F(t,e,n,r){if("run"===t||"whatsonchain"===t)return t;if("mattercloud"===t)throw new Error("MatterCloud API is no longer supported");if(void 0!==t||e)throw new Error(`Invalid api: ${v(t)}`);if("string"==typeof T.defaults.api)return F(T.defaults.api,!0,void 0,r);if(void 0===n){if("main"===r||"test"===r)return"run";if("stn"===r)return"whatsonchain"}}function M(t,e){if("string"==typeof t)return t;if(void 0===t&&!e)return T.defaults.apiKey;throw new Error(`Invalid apiKey: ${v(t)}`)}function L(t,e){if("string"==typeof t)return t;if(void 0===t&&!e)return L(T.defaults.app,!0);throw new Error(`Invalid app: ${v(t)}`)}function G(t,e){if("boolean"==typeof t)return t;if(void 0===t&&!e)return G(T.defaults.autofund,!0);throw new Error(`Invalid autofund: ${v(t)}`)}function J(t,e){if(t>=0)return t;if(void 0===t&&!e)return J(T.defaults.backingLimit,!0);throw new Error(`Invalid backingLimit: ${v(t)}`)}function Y(t,e,n,r,o,i){if(t instanceof a)return t;const s=c.M&&c.M._e;if(void 0===t&&!e)switch(o){case"mock":if(void 0!==n)throw new Error(`"mock" network is not compatible with the "${n}" api`);return s instanceof Mockchain?s:new Mockchain;case"main":case"test":case"stn":{if((s instanceof RunConnect||s instanceof WhatsOnChain)&&s.api===n&&s.apiKey===r&&s.network===o)return s;const t={apiKey:r,network:o};switch(typeof n){case"string":switch(n){case"run":return new RunConnect(t);case"whatsonchain":return new WhatsOnChain(t)}break;case"undefined":return"stn"===o?new WhatsOnChain(t):new RunConnect(t);default:throw new Error(`Invalid api: ${v(n)}`)}}break;default:return Y(T.defaults.blockchain,!0)}throw new Error(`Invalid blockchain: ${v(t)}`)}function W(t,e,n){if(t instanceof h)return t;if(void 0===t&&!e){const t=c.M&&c.M.po,e=c.M&&c.M._e,r=e&&e.network;return t&&r===n?t:T.defaults.cache instanceof h?T.defaults.cache:O()?new BrowserCache:S()?new NodeCache:new LocalCache}if(t instanceof RunDB){throw new Error(`${"The RunDB plugin is now a state provider, not a cache"}\n\n${"Hint: Try run.state = new RunDB()"}`)}throw new Error(`Invalid cache: ${v(t)}`)}function K(t,e){if("boolean"==typeof t)return t;if(void 0===t&&!e)return K(T.defaults.client,!0);throw new Error(`Invalid client: ${v(t)}`)}function z(t,e){if("boolean"==typeof t)return t;if(void 0===t&&!e)return z(T.defaults.debug,!0);throw new Error(`Invalid debug: ${v(t)}`)}function V(t,e){if(t instanceof Inventory)return t;if(e)throw new Error(`Invalid inventory: ${v(t)}`);return new Inventory}function H(t,e){if(t instanceof f)return t;if(null===t)return null;if(void 0===t&&!e)return T.defaults.logger;throw new Error(`Invalid logger: ${v(t)}`)}function q(t,e){if("mock"===t||"main"===t||"test"===t||"stn"===t)return t;if(void 0===t&&!e)return T.defaults.network;throw new Error(`Invalid network: ${v(t)}`)}function Z(t,e){if(t>=0&&Number.isSafeInteger(t))return t;if(void 0===t&&!e)return Z(T.defaults.networkRetries,!0);throw new Error(`Invalid network retries: ${v(t)}`)}function X(t,e){if("number"==typeof t&&t>=0&&!Number.isNaN(t))return t;if(void 0===t&&!e)return X(T.defaults.networkTimeout,!0);throw new Error(`Invalid network timeout: ${v(t)}`)}function Q(t,e,n,r){if(r){if(t&&e&&t!==r)throw new Error("Cannot set different owner and wallet");return r}if(t instanceof l)return t;if(void 0===t&&!e){if(T.defaults.owner instanceof l)return T.defaults.owner;if("string"==typeof T.defaults.owner||T.defaults.owner instanceof o)try{return new LocalOwner(T.defaults.owner,n.network)}catch(t){}return new LocalOwner(void 0,n.network)}if("string"==typeof t||t instanceof o)try{return new LocalOwner(t,n.network)}catch(t){}if("string"==typeof t||t instanceof i||t instanceof s)try{return new Viewer(t.toString(),n.network)}catch(t){}if("object"==typeof t)try{return new Viewer(t)}catch(t){}throw new Error(`Invalid owner: ${v(t)}`)}function tt(t,e){if("boolean"==typeof t)return t;if(void 0===t&&!e)return tt(T.defaults.preverify,!0);throw new Error(`Invalid preverify: ${v(t)}`)}function et(t,e,n,r){if(r){if(t&&e&&t!==r)throw new Error("Cannot set different purse and wallet");return r}if(t instanceof d)return t;if(void 0===t&&!e){if(T.defaults.purse instanceof d)return T.defaults.purse;if("string"==typeof T.defaults.purse||T.defaults.purse instanceof o)try{return new LocalPurse({privkey:T.defaults.purse,blockchain:n})}catch(t){}return new LocalPurse({blockchain:n})}if("string"==typeof t||t instanceof o)try{return new LocalPurse({privkey:t,blockchain:n})}catch(t){}throw new Error(`Invalid purse: ${v(t)}`)}function nt(t,e){if("boolean"==typeof t)return t;if(void 0===t&&!e)return nt(T.defaults.rollbacks,!0);throw new Error(`Invalid rollbacks: ${v(t)}`)}function rt(t,e,n,r,o){if(t instanceof p)return t;if(void 0===t&&!e){const t=c.M&&c.M.ao,e=c.M&&c.M._e,i=e&&e.network,s=t&&t.api,a=t&&t.apiKey;return t&&i===n&&s===r&&a===o?t:T.defaults.state instanceof p?T.defaults.state:"main"===n||"test"===n?new StateServer({apiKey:o="run"===r?o:void 0}):new LocalState}throw new Error(`Invalid state: ${v(t)}`)}function ot(t,e){if("number"==typeof t&&t>=0&&!Number.isNaN(t))return t;if(void 0===t&&!e)return T.defaults.timeout;throw new Error(`Invalid timeout: ${v(t)}`)}function it(t,e){let n=[];if("string"==typeof t){if(!ct(t))throw new Error(`Not trustable: ${v(t)}`);"cache"===t&&(t="state"),n.push(t)}else if(Array.isArray(t)){for(const e of t)if(!ct(e))throw new Error(`Not trustable: ${v(e)}`);n=n.concat(t.map((t=>"cache"===t?"state":t)))}else{if(void 0!==t||e)throw new Error(`Not trustable: ${v(t)}`);{const t=c.M&&c.M.co;t?n=n.concat(Array.from(t)):T.defaults.trust&&(n=n.concat(Array.from(it(T.defaults.trust,!0))))}}return new Set(n.concat(["61e1265acb3d93f1bf24a593d70b2a6b1c650ec1df90ddece8d6954ae3cdd915","49145693676af7567ebe20671c5cb01369ac788c20f3b1c804f624a1eda18f3f","284ce17fd34c0f41835435b03eed149c4e0479361f40132312b4001093bb158f","6fe169894d313b44bd54154f88e1f78634c7f5a23863d1713342526b86a39b8b","5332c013476cd2a2c18710a01188695bc27a5ef1748a51d4a5910feb1111dab4","81bcef29b0e4ed745f3422c0b764a33c76d0368af2d2e7dd139db8e00ee3d8a6","71fba386341b932380ec5bfedc3a40bce43d4974decdc94c419a94a8ce5dfc23","780ab8919cb89323707338070323c24ce42cdec2f57d749bd7aceef6635e7a4d","90a3ece416f696731430efac9657d28071cc437ebfff5fb1eaf710fe4b3c8d4e","727e7b423b7ee40c0b5be87fba7fa5673ea2d20a74259040a7295d9c32a90011","3b7ef411185bbe3d01caeadbe6f115b0103a546c4ef0ac7474aa6fbb71aff208","b17a9af70ab0f46809f908b2e900e395ba40996000bf4f00e3b27a1e93280cf1","72a61eb990ffdb6b38e5f955e194fed5ff6b014f75ac6823539ce5613aea0be8","312985bd960ae4c59856b3089b04017ede66506ea181333eec7c9bb88b11c490","05f67252e696160a7c0099ae8d1ec23c39592378773b3a5a55f16bd1286e7dcb","d792d10294a0d9b05a30049f187a1704ced14840ecf41d00663d79c695f86633","318d2a009e29cb3a202b2a167773341dcd39809b967889a7e306d504cc266faf","5a8d4b4da7c5f27a39adac3a9256a7e15e03a7266c81ac8369a3b634560e7814","d7273b6790a4dec4aa116661aff0ec35381794e552807014ca6a536f4454976d","d6170025a62248d8df6dc14e3806e68b8df3d804c800c7bfb23b0b4232862505","ce8629aa37a1777d6aa64d0d33cd739fd4e231dc85cfe2f9368473ab09078b78","ca1818540d2865c5b6a53e06650eafadc10b478703aa7cf324145f848fec629b","1de3951603784df7c872519c096445a415d9b0d3dce7bbe3b7a36ca82cf1a91c","367b4980287f8abae5ee4b0c538232164d5b2463068067ec1e510c91114bced2","1f0abf8d94477b1cb57629d861376616f6e1d7b78aba23a19da3e6169caf489e","8b9380d445b6fe01ec7230d8363febddc99feee6064d969ae8f98fdb25e1393f","03e21aa8fcf08fa6985029ad2e697a2309962527700246d47d891add3cfce3ac","5435ae2760dc35f4329501c61c42e24f6a744861c22f8e0f04735637c20ce987","b44a203acd6215d2d24b33a41f730e9acf2591c4ae27ecafc8d88ef83da9ddea","424abf066be56b9dd5203ed81cf1f536375351d29726d664507fdc30eb589988","f97d4ac2a3d6f5ed09fad4a4f341619dc5a3773d9844ff95c99c5d4f8388de2f","63e0e1268d8ab021d1c578afb8eaa0828ccbba431ffffd9309d04b78ebeb6e56","03320f1244e509bb421e6f1ff724bf1156182890c3768cfa4ea127a78f9913d2","4a1929527605577a6b30710e6001b9379400421d8089d34bb0404dd558529417","0bdf33a334a60909f4c8dab345500cbb313fbfd50b1d98120227eae092b81c39","7d14c868fe39439edffe6982b669e7b4d3eb2729eee7c262ec2494ee3e310e99","33e78fa7c43b6d7a60c271d783295fa180b7e9fce07d41ff1b52686936b3e6ae","d476fd7309a0eeb8b92d715e35c6e273ad63c0025ff6cca927bd0f0b64ed88ff","24cde3638a444c8ad397536127833878ffdfe1b04d5595489bd294e50d77105a","bfa5180e601e92af23d80782bf625b102ac110105a392e376fe7607e4e87dc8d","c0a79e8afb7cabe5f25bdaa398683d6dfe68a2912b29fe948ed130d14e3a2380","3f9de452f0c3c96be737d42aa0941b27412211976688967adb3174ee18b04c64"]))}function st(t,e){if(void 0===t&&!e)return t;if("object"!=typeof t||null===t)throw new Error(`Invalid wallet: ${v(t)}`);if(!(t instanceof l))throw new Error("wallet does not implement the Owner API");if(!(t instanceof d))throw new Error("wallet does not implement the Purse API");return t}function ct(t){return"*"===t||("cache"===t||("state"===t||"string"==typeof t&&(64===t.length&&/[a-fA-F0-9]+/.test(t))))}function at(t){if(!C(t))return;const e={};t.Ht&&t.Ht.info&&(e.info=t.Ht.info.bind(t.Ht)),t.Ht&&t.Ht.warn&&(e.warn=t.Ht.warn.bind(t.Ht)),t.Ht&&t.Ht.error&&(e.error=t.Ht.error.bind(t.Ht)),t.Ht&&t.Ht.debug&&t.Ft&&(e.debug=t.Ht.debug.bind(t.Ht)),E.Ht=e}function ht(t){const e=w.Kt(t)||w.zt(),n=w.Tt(e);return T.instance?n.ye||n.Ee(t):n.Te(t),e}T.instance=null,T.defaults={},T.defaults.api=void 0,T.defaults.apiKey=void 0,T.defaults.app="",T.defaults.autofund=!0,T.defaults.backingLimit=1e8,T.defaults.blockchain=void 0,T.defaults.cache=void 0,T.defaults.client=!1,T.defaults.debug=!1,T.defaults.inventory=void 0,T.defaults.logger={warn:console.warn,error:console.error},T.defaults.network="main",T.defaults.networkRetries=2,T.defaults.networkTimeout=1e4,T.defaults.owner=void 0,T.defaults.preverify=!0,T.defaults.purse=void 0,T.defaults.rollbacks=!0,T.defaults.state=void 0,T.defaults.timeout=3e4,T.defaults.trust=[],T.configure=(t,e)=>{T.defaults=Object.assign({},T.defaults),t.APP&&(T.defaults.app=t.APP),e=e||t.NETWORK||T.defaults.network,T.defaults.network=e,"debug"===t.LOGGER?(T.defaults.logger=console,T.defaults.debug=!0):t.LOGGER&&JSON.parse(t.LOGGER)?(T.defaults.logger=console,T.defaults.debug=!1):t.LOGGER&&!JSON.parse(t.LOGGER)&&(T.defaults.logger={}),E.Ht=T.defaults.logger;const n=t.PURSE||t[`PURSE_${e.toUpperCase()}`];void 0!==n&&(T.defaults.purse=n);const r=t.OWNER||t[`OWNER_${e.toUpperCase()}`];void 0!==r&&(T.defaults.owner=r),void 0!==t.API&&(T.defaults.api=t.API);const o=t.APIKEY||t[`APIKEY_${(T.defaults.api||"").toUpperCase()}`];void 0!==o&&(T.defaults.apiKey=o)},T.cover=t=>{m.cn.includes(t)||m.cn.push(t)},T.Berry=Berry,T.Code=Code,T.Jig=Jig,T.Creation=Creation,T.Transaction=g,T.plugins={},T.plugins.BrowserCache=BrowserCache,T.plugins.DiskCache=DiskCache,T.plugins.IndexedDbCache=R,T.plugins.Inventory=Inventory,T.plugins.LocalCache=LocalCache,T.plugins.LocalOwner=LocalOwner,T.plugins.LocalPurse=LocalPurse,T.plugins.LocalState=LocalState,T.plugins.Mockchain=Mockchain,T.plugins.NodeCache=NodeCache,T.plugins.PayServer=PayServer,T.plugins.RunConnect=RunConnect,T.plugins.RunDB=RunDB,T.plugins.StateServer=StateServer,T.plugins.Viewer=Viewer,T.plugins.WhatsOnChain=WhatsOnChain,T.plugins.BlockchainWrapper=BlockchainWrapper,T.plugins.CacheWrapper=CacheWrapper,T.plugins.OwnerWrapper=OwnerWrapper,T.plugins.PurseWrapper=PurseWrapper,T.plugins.StateWrapper=StateWrapper,T.extra={},$(T.extra,"asm",(()=>n(55))),$(T.extra,"B",(()=>n(82))),$(T.extra,"Base58",(()=>n(83))),$(T.extra,"expect",(()=>n(84))),$(T.extra,"Group",(()=>n(54))),$(T.extra,"Hex",(()=>n(29))),$(T.extra,"NFT",(()=>n(85))),$(T.extra,"sha256",(()=>n(86))),$(T.extra,"Token",(()=>n(60))),$(T.extra,"Token10",(()=>n(87))),$(T.extra,"Token20",(()=>n(60))),$(T.extra,"Tx",(()=>n(59))),$(T.extra,"txo",(()=>n(58))),T.Sn=n(6).Sn,T.wn=n(10),T.Jc=n(13),T.Wc=n(23),T.bn=n(14),T.Yc=n(16),T.Kc=n(46),T.zc=n(47),T.pn=n(3).pn,T.Vc=n(41),T.Hc=n(26),T.St=n(2),T._n=n(21),T.xt=n(0),T.qc=n(25),T.Zc=n(56),T.At=n(9),T.Xc=n(18),T.R=n(0).R,T.j=n(0).j,T.C=n(0).C,T.En=n(24),T.vn=m,T.Qc=n(48),T.zr=n(13).zr,T.ta=n(35),T.ea=n(22),T.na=n(28),T.g=n(6).g,T.Tr=n(17),T.api={},T.api.Blockchain=a,T.api.Logger=f,T.api.Purse=d,T.api.Cache=h,T.api.Lock=u,T.api.Owner=l,T.api.State=p,T.errors=n(11),T.errors.RequestError=n(18).So,T.util={},T.util.CommonLock=CommonLock,T.util.deps=t=>{if("string"!=typeof t||!t.length)throw new Error(`Invalid transaction: ${v(t)}`);return I(new r.Transaction(t))},T.util.metadata=t=>{if("string"!=typeof t||!t.length)throw new Error(`Invalid transaction: ${v(t)}`);return A(new r.Transaction(t))},T.util.install=ht,T.util.unify=function(...t){if(!t.length)throw new ArgumentError("No creations to unify");if(t.some((t=>!(t instanceof Creation))))throw new ArgumentError("Must only unify creations");_(t,t)},T.util.uninstall=function(t){const e=w.Kt(t);if(!e)return;w.Tt(e).je()},Object.defineProperty(T.util,"sha256",{get:()=>c.Gr,set:t=>{if("function"!=typeof t)throw new Error(`'Invalid sha256: ${v(t)}`);c.Gr=t},configurable:!0,enumerable:!0}),T.version="0.6.37",T.protocol=n(17).no,T.bsv=r,t.exports=T},function(t,e,n){const r=n(7),{B:o,L:i}=n(0),s=n(3),{Hr:c}=n(13),{ClientModeError}=n(11),a=["load","sync","publish","update"];class h{constructor(){this._e=void 0,this.ao=void 0,this.po=void 0,this.he=void 0,this.Co=void 0,this.Yo=void 0,this.Bc=[],this.Cr=1e8,this.Et=1e4,this.co=new Set,this.zo=!0,this.lo=!1,this.Or=!1}an(){h.M!==this&&(h.M&&h.M.sn(),h.M=this,r.Networks.defaultNetwork=r.Networks[i(this._e.network)],s.an())}sn(){h.M&&(s.sn(),h.M=null)}cr(t,e){o(a.includes(t)),this.Bc.filter((e=>e.Lc===t)).forEach((n=>n.Gc(t,e)))}async wo(t,e){return this.co.has("*")||this.co.has(t)||"state"===e&&this.co.has("state")||await this.ao.pull(`trust://${t}`)}async fo(t){const e=await this.ao.pull(`tx://${t}`);if(void 0!==e)return e;if(this.lo)throw new ClientModeError(t,"transaction");return await this._e.fetch(t)}async qo(t,e){const n=await this.ao.pull(`spend://${t}_o${e}`);return void 0!==n?n:this.lo?void 0:await this._e.spends(t,e)}async ra(t){const e=await this.ao.pull(`time://${t}`);return void 0!==e?e:this.lo?void 0:await this._e.time(t)}}h.M=null,h.Gr=c,h.Mc=a,t.exports=h},function(t,e,n){const{Y:r,B:o,ht:i}=n(0),{ot:s,Zr:c}=n(14),{g:a}=n(6);let h=!0;t.exports={oa:function(t,e,i){return a((()=>{const h=t.concat(e),u={};h.forEach((t=>{const e=u[t.origin];if(e){const n=`1st location: ${t.location}`,o=`2nd location: ${e.location}`,i=`Inconsistent reference: ${r(t)}\n\n${n}\n${o}`;throw new Error(i)}u[t.origin]=t}));const f={},l=new Set,d=new Map;h.forEach((t=>{f[t.origin]=t}));const Creation=n(4);a((()=>s(h,(t=>{if(t instanceof Creation){l.add(t);const e=t.origin,n=u[e];if(n&&t.nonce>n.nonce){const e=`1st location: ${t.location}`,o=`2nd location: ${n.location}`;throw new Error(`Time travel: ${r(t)}\n\n${e}\n${o}`)}const o=f[e];(!o||t.nonce>o.nonce)&&(f[e]=t)}})))),i&&(f[i.origin]=i),c(i,((t,e)=>{if(t!==i&&t instanceof Creation)return e(!1),f[t.origin]}));for(const e of l){const n=new Map;c(e,((t,r)=>{if(t!==e&&t instanceof Creation){const e=f[t.origin];return t!==e&&n.set(e,t),o(e),r(!1),e}})),t.includes(e)||d.set(e,n)}const p={};return Object.entries(f).forEach((([t,e])=>{p[t]=[e.location,e.nonce]})),{ia:p,sa:d}}))},ca:function(t){a((()=>{for(const[e,r]of t.entries()){const Creation=n(4);c(e,((t,n)=>{if(t!==e&&t instanceof Creation)return n(!1),r.get(t)||t}))}}))},re:function(t,e=[]){const Creation=n(4);if(!h)return;const u=t=>a((()=>!i(t,"origin")||t.origin.startsWith("error://")?t:t.origin));return a((()=>{const n=new Map;return e.forEach((t=>{o(t instanceof Creation);const e=u(t);if(!(!n.has(e)||n.get(e).nonce===t.nonce)){const o=a((()=>`There are conflicting jigs for ${t.origin}, nonces ${n.get(e).nonce}, ${t.nonce}`));throw new Error(`Cannot unify inconsistent ${r(t)}\n\n${o}`)}n.set(e,t)})),a((()=>s(t,(t=>{if(t instanceof Creation){const o=u(t),i=n.get(o)||t;if(n.has(o)||n.set(o,t),t.nonce>i.nonce){if(e.includes(i)){const e=`1st location: ${t.location}`,n=`2nd location: ${i.location}`;throw new Error(`Cannot unify inconsistent ${r(t)}\n\n${e}\n${n}`)}n.set(o,t)}}})))),c(t,(t=>{if(t instanceof Creation)return n.get(u(t))}))}))},aa:function(t){h=t}}},function(t,e,n){const r=n(7),{ce:o}=n(10);function i(t){const{vo:e}=n(17),o="Not a RUN transaction: invalid OP_RETURN protocol",i="Not a RUN transaction: invalid RUN metadata";if(!t.outputs.length)throw new Error(o);let s=null;const c=new r.Transaction;for(let e=0;e<t.outputs.length;e++){s=t.outputs[e].script.chunks;if(!(6!==s.length||0!==s[0].opcodenum||106!==s[1].opcodenum||"run"!==s[2].buf.toString()))break;c.addOutput(t.outputs[e]),s=null}if(!s)throw new Error(o);const a=e(s[3].buf.toString("hex")),h=s[4].buf?s[4].buf.toString():"";try{const t=s[5].buf.toString("utf8"),e=JSON.parse(t);if(6!==Object.keys(e).length||"number"!=typeof e.in||!Array.isArray(e.ref)||!Array.isArray(e.out)||!Array.isArray(e.del)||!Array.isArray(e.cre)||!Array.isArray(e.exec)||e.ref.some((t=>"string"!=typeof t))||e.out.some((t=>"string"!=typeof t))||e.del.some((t=>"string"!=typeof t))||e.exec.some((t=>"object"!=typeof t)))throw new Error(i);return e.app=h,e.version=a,e.base=c.toString("hex"),e.vrun=c.outputs.length,e}catch(t){throw new Error(i)}}t.exports={ro:i,jc:function(t){const e=i(t),n=new Set;for(let r=0;r<e.in;r++){const e=t.inputs[r].prevTxId.toString("hex");n.add(e)}for(const t of e.ref){if(t.startsWith("native://"))continue;const e=t.slice(0,64);n.add(e);if(t.includes("?berry=")){const e=o(t);let r=e.qe;if(r.length>64)try{r=JSON.parse(e.qe).txid}catch(t){}64===r.length&&n.add(r)}}return Array.from(n)}}},function(t,e,n){const r=n(7),{Y:o,bt:i}=n(0),{eo:s}=n(16),c=n(2),a=n(15),h=n(9),{oa:u,ca:f,aa:l}=n(32),{g:d}=n(6),p=n(26),w=n(8),{ei:y,ti:b,ni:g,ri:_,Qo:m,oi:E,ii:v,si:$,di:P,pi:O}=n(19),S=n(23),{TrustError,ExecutionError}=n(11),x="Replay";async function A(t,e,A,I,R,j,T,C){const N=n(64);c.te&&c.qt(x,"Replay",e);const k=new Date;(T=T||new i("replay",I.Et)).vt();if(!C&&(A.exec.some((t=>"DEPLOY"===t.op))||A.exec.some((t=>"UPGRADE"===t.op)))&&!await I.wo(e,"replay"))throw new TrustError(e,"replay");let U=[],D=[];const F=new a.yo;for(let e=0;e<A.in;e++){const n=t.inputs[e];if(!n)throw new Error(`Jig input missing for _i${e}`);const r=n.prevTxId.toString("hex"),o=n.outputIndex,i=a(`${r}_o${o}`,void 0,I,F,T);U.push(i)}for(let t=0;t<A.ref.length;t++){const e=A.ref[t],n=a(e,void 0,I,F,T);D.push(n)}if(U=await Promise.all(U),D=await Promise.all(D),j&&!U.some((t=>t.location===j.location)))throw new Error(`${o(j)} not found in the transaction\n\ntxid: ${e}\njig: ${j.location}`);const M=new h;M.Vn=!0,M.zn=!1;const L=h.Ut;l(!1);const G=I.Cr;I.Cr=Number.MAX_SAFE_INTEGER;let J=null,Y=null;try{const t=u(U,D,j);J=t.ia,Y=t.sa,j&&(U[U.findIndex((t=>t.location===j.location))]=j),U.forEach((t=>M.vr(t))),D.forEach((t=>M._read(t))),h.Ut=M;for(const t of A.exec){const{op:e,data:n}=t;if(2!==Object.keys(t).length)throw new Error("Invalid exec");if("string"!=typeof e)throw new Error(`Invalid op: ${e}`);if("object"!=typeof n||!n)throw new Error(`Invalid data: ${n}`);const r=new S;for(const t of U)r.ar(t);for(const t of D)r.ar(t);for(const t of M.Jt)r.ar(t);N(e,n,r.yr())}}catch(t){throw M.nn(t),new ExecutionError(t.message)}finally{h.Ut=L,I.Cr=G,l(!0)}let W=null,K=null;try{if(W=M.Qn(),!W)throw new Error("Invalid metadata: no commit generated");W.Yo=A.app,W.Tr=A.version,W.Ko=new r.Transaction(A.base),W.ia=J,K=await async function(t,e,n,r,o,i){c.Dt&&c.Ft(x,"Verify",n);const a=new Date,h=t.ur,u=y(h);!function(t,e,n){const r={_:w._,wc:t=>n[t]},o=e.cre.map((t=>p.dc(t,r)));if(t.ur.Jt.pr!==e.cre.length)throw new Error("Invalid number of cre entries");for(let e=0;e<o.length;e++){const n=o[e],r=t.ur.Jt.yr()[e],i=t.Do.get(r);d((()=>{r.owner=n})),i.lr.owner=n}}(t,r,u);const f=await m(t);b(t);const l=await g(t,o);o.vt();const P=await _(t,l),O=E(h,u),S=v(t,P,O,u),A=$(t,S,f,0);s(S)!==s(r)&&function(t,e,n,r,o){c.ne&&c.Qt(x,"Expected metadata:",JSON.stringify(t,0,3));c.ne&&c.Qt(x,"Actual metadata:",JSON.stringify(e,0,3));function i(t,e,n,o){if(t===e)return;const i=r.get(n);o?(c.Qt(x,"Expected state:",JSON.stringify(o,0,3)),c.Qt(x,"Actual state:",JSON.stringify(i,0,3))):c.Qt(x,"State mismatch:",JSON.stringify(i,0,3))}c.ne&&(t.out.length===e.out.length?t.out.forEach(((t,r)=>{i(t,e.out[r],n.Jn.yr()[r],o&&o.ha(r))})):c.Qt(x,`Expected ${t.out.length} outputs but actual was ${e.out.length}`),t.del.length===e.del.length?t.del.forEach(((t,r)=>{i(t,e.del[r],n.Mn.yr()[r],o&&o.hr(r))})):c.Qt(x,`Expected ${t.del.length} deletes but actual was ${e.del.length}`));throw new Error("Metadata mismatch\n\nHint: See logs")}(r,S,h,l,i);for(let t=0;t<S.in;t++){const n=e.inputs[t],r=A.inputs[t];if(n.prevTxId.toString("hex")!==r.prevTxId.toString("hex"))throw new Error(`Txid mismatch on input ${t}`);if(n.outputIndex!==r.outputIndex)throw new Error(`Vout mismatch on input ${t}`)}for(let t=0;t<S.out.length;t++){const n=e.outputs[t+S.vrun+1],r=A.outputs[t+S.vrun+1];if(!n)throw new Error(`Jig output missing for _o${t+S.vrun+1}`);if(n.script.toString("hex")!==r.script.toString("hex"))throw new Error(`Script mismatch on output ${t+S.vrun+1}`);if(n.satoshis<r.satoshis){const e=`Hint: Transaction has ${n.satoshis} but expected ${r.satoshis}`;throw new Error(`Satoshis mismatch on output ${t+S.vrun+1}\n\n${e}`)}}c.Dt&&c.Ft(x,"Verify (end): "+(new Date-a)+"ms");return l}(W,t,e,A,T,C)}catch(t){throw new ExecutionError(t.message)}return R&&(P(W,e),await O(W,K,e),T.vt()),f(Y),c.Dt&&c.Ft(x,"Replay (end): "+(new Date-k)+"ms"),W}A.Vo=class{constructor(t,e){this.ur=t,this.Bo=e}ha(t){return this.Bo.get(this.ur.Jn.yr()[t])}hr(t){return this.Bo.get(this.ur.Mn.yr()[t])}},t.exports=A},function(t,e,n){const{Y:r,ut:o}=n(0),{oe:i}=n(14),{g:s}=n(6),{Ye:c,Cn:a}=n(10),h=n(8)._,u=n(2);t.exports=class{constructor(t,e,n){if(u.Dt&&u.Ft("Snapshot","Snapshot",r(t),e?"(bindings only)":""),this.yi=t,this.Sr=e,this.Ir=!n,e){const e=this.lr={};s((()=>{e.location=t.location,e.origin=t.origin,e.nonce=t.nonce,e.owner=i(t.owner,h),e.satoshis=t.satoshis}))}else this.Ar()}Ar(){const t=this.yi;this.Sr=!1,this.Ir=!0;const Jig=n(5),Code=n(1),Berry=n(12),e=n(3);if(t instanceof Jig)this.ua="jig";else if(t instanceof Code)this.ua=e.Tt(t).kt?"native":"code";else{if(!(t instanceof Berry))throw new Error(`Not a creation: ${r(t)}`);this.ua="berry"}if(s((()=>{const e=Object.assign({},t),n=i(e,h);this.lr=n})),"jig"!==this.ua&&"berry"!==this.ua||(this.fa=s((()=>t.constructor))),"code"===this.ua){const n=e.Tt(t);this.Nt=n.Nt,this.la=n.Le()}}nn(t){if("native"!==this.ua&&this.Ir)return s((()=>{if(this.Sr)if(t){const e=a({Qt:`A previous error occurred\n\n${t}`});o(this.yi,"location",e)}else o(this.yi,"location",c);else{if("code"===this.ua){n(3).Tt(this.yi).Je(this.la)}if(Object.keys(this.yi).forEach((t=>{delete this.yi[t]})),Object.keys(this.lr).forEach((t=>{o(this.yi,t,this.lr[t])})),t){const Jig=n(5),Code=n(1);if((this.yi instanceof Jig||this.yi instanceof Code)&&this.lr.location===c){const e=a({Qt:`Deploy failed\n\n${t}`});o(this.yi,"origin",e),o(this.yi,"location",e)}}}}))}}},function(t,e,n){const r=n(7),{B:o,tt:i}=n(0),{g:s}=n(6),{ot:c}=n(14),{ie:a,Cn:h}=n(10),u=n(35),f=n(2),l=n(19),{no:d}=n(17),p="Commit",w=new Map;class y{constructor(t){f.Dt&&f.Ft(p,"Create",t.Nn),o(t.Un.length),o(t.Gn.pr||t.Jn.pr||t.Mn.pr),this.ur=t,this.qn=t.qn,this.Yo=this.qn.Yo,this.Tr=d,this.Ko=new r.Transaction,this.da=[],this.Do=new Map,this.Fo(),this.ia=null,this.pa=[],this.wa=[],this.jr=!1,this.ur.zn&&(this.jo(!0),this.Mo().then((()=>l(this)))),this.ur.Vn||(this.ur.Jn.sr((t=>this.qn.cr("update",t))),this.ur.Mn.sr((t=>this.qn.cr("update",t)))),this.states=null,this.stateHashes=null}Fo(){const t=t=>{if(!this.Do.has(t)){const e=new u(t);this.Do.set(t,e)}};this.ur.Jn.sr((e=>t(e))),this.ur.Mn.sr((e=>t(e)))}jo(t){t?(o(!this.jr),o(!w.has(this.ur.Nn)),w.set(this.ur.Nn,this)):(w.delete(this.ur.Nn),o(!this.wa.length),o(!this.da.length))}Ro(){return w.has(this.ur.Nn)}async Mo(){const t=this.ur;t.Yn=t.Yn.filter((t=>!t.jr)),t.Yn.length&&(t.Yn.filter((t=>!t.da.includes(this))).forEach((t=>t.da.push(this))),await new Promise(((t,e)=>this.pa.push({resolve:t,reject:e}))))}async ya(){o(this.Ro()),await new Promise(((t,e)=>this.wa.push({resolve:t,reject:e})))}ba(t){const e=this.ur;for(const[n,r]of t.Do){const t=e.Gn.Tt(n)||e.Wn.Tt(n);if(!t)continue;const o=e.Kn.get(t);o&&a.forEach((t=>{o.lr[t]=r.lr[t]}));const c=this.Do.get(t);if(c){const t=c.lr;c.lr.origin=r.lr.origin,i(t.owner)||(t.owner=r.lr.owner),i(t.satoshis)||(t.satoshis=r.lr.satoshis)}s((()=>{t.origin=r.lr.origin,i(t.owner)||(t.owner=r.lr.owner),i(t.satoshis)||(t.satoshis=r.lr.satoshis)}))}e.Yn=e.Yn.filter((e=>e!==t)),e.Yn.length||(this.pa.forEach((t=>t.resolve())),this.pa=[])}Ho(t){return this.da.some((e=>e.ur.Gn.Gt(t)))}async Uo(t){if(this.ia)return this.ia;const e=n(15),r=new e.yo,o=this.ur,i=o.Gn.yr().concat(o.Wn.yr()).map((t=>o.Kn.get(t).lr.location)),s=await Promise.all(i.map((n=>e(n,void 0,this.qn,r,t))));return this.ia=y.ga(s,t),this.ia}static async ga(t,e){f.Dt&&f.Ft(p,"Build refmap");const Creation=n(4),r={};return s((()=>c(t,(e=>{if(e instanceof Creation)return s((()=>{(!(e.origin in r)||r[e.origin][1]<=e.nonce)&&(r[e.origin]=[e.location,e.nonce])})),t.includes(e)})))),r}No(){this.jr=!0,this.wa.forEach((t=>t.resolve())),this.wa=[],this.da.forEach((t=>t.ba(this)));const t=t=>{this.Ho(t)||this.qn.cr("publish",t)};this.ur.Jn.sr((e=>t(e))),this.ur.Mn.sr((e=>t(e))),this.da=[],this.jo(!1)}ko(t){o(t);const e=this.ur;this.jr=!1,this.da.forEach((e=>e.ko(t))),this.da=[];const n=t&&0===this.wa.length;if(f.ne&&f.Qt(p,n?"Unhandled":"",t),this.ur.nn(t),n){const n=h({Qt:`Unhandled ${t}`});s((()=>{e.Jn.sr((t=>{t.location=n})),e.Mn.sr((t=>{t.location=n}))}))}e.Vn||(e.Jn.sr((t=>this.qn.cr("update",t))),e.Mn.sr((t=>this.qn.cr("update",t)))),t&&(this.wa.forEach((e=>e.reject(t))),this.wa=[]),this.jo(!1)}}y.Rr=t=>w.get(t),y.Fc=async()=>{const t=[];for(const e of w.values())t.push(e.ya());return Promise.all(t)},t.exports=y},function(t,e,n){const r=n(2),o=n(28),{Xr:i}=n(14),{Y:s,K:c,V:a}=n(0),h=["jig","berry","tx"];class CacheWrapper{constructor(t=this){this.tag="Object"===t.constructor.name?"Cache":t.constructor.name,this.unwrappedCache=t,this.unwrappedGet=t.get,this.unwrappedSet=t.set,this.setWrappingEnabled(!0)}setWrappingEnabled(t){t?(this.get=CacheWrapper.prototype.wrappedGet,this.set=CacheWrapper.prototype.wrappedSet):(this.get=this.unwrappedGet,this.set=this.unwrappedSet)}async wrappedGet(t){if("string"!=typeof t||!t.length)throw new Error(`Invalid key: ${s(t)}`);r.te&&r.qt(this.tag,"Get",t);const e=new Date,n=await this.unwrappedGet.call(this.unwrappedCache,t);if(r.Dt&&r.Ft(this.tag,"Get (end): "+(new Date-e)+"ms"),r.Dt&&r.Ft(this.tag,"Value:",JSON.stringify(n,0,3)),void 0!==n&&!u(n))throw new Error(`Invalid value retrieved for ${t}: ${n}`);return n}async wrappedSet(t,e){if("string"!=typeof t||!t.length)throw new Error(`Invalid key: ${s(t)}`);if(!u(e))throw new Error(`Cannot cache ${s(e)}`);if(h.includes(t.split("://")[0])){const n=await this.unwrappedGet.call(this.unwrappedCache,t);if(void 0!==n&&!i(e,n)){r.ne&&r.Qt(this.tag,"Expected:",JSON.stringify(n,0,3)),r.ne&&r.Qt(this.tag,"Actual:",JSON.stringify(e,0,3));throw new Error(`Attempt to set different values for the same key: ${t}\n\n${"This is an internal Run bug. Please report it to the library developers."}`)}}r.te&&r.qt(this.tag,"Set",t),r.Dt&&r.Ft(this.tag,"Value:",JSON.stringify(e,0,3));const n=new Date,c=await this.unwrappedSet.call(this.unwrappedCache,t,e);if(r.Dt&&r.Ft(this.tag,"Set (end): "+(new Date-n)+"ms"),t.startsWith("jig://")&&"code"===e.kind){const e=await this.unwrappedGet.call(this.unwrappedCache,"config://code-filter")||o.create();o.add(e,t),await this.unwrappedSet.call(this.unwrappedCache,"config://code-filter",e)}return c}}function u(t){switch(typeof t){case"undefined":return!1;case"boolean":return!0;case"number":return Number.isFinite(t);case"string":return!0;case"object":return null===t||(c(t)?!Object.keys(t).some((e=>!u(t[e]))):!!a(t)&&(t.length===Object.keys(t).length&&!Object.keys(t).some((e=>!u(t[e])))));case"function":case"symbol":return!1}}t.exports=CacheWrapper},function(t,e,n){const r=n(2),{Y:o,yt:i}=n(0),s=n(28),CacheWrapper=n(37);class LocalCache extends CacheWrapper{constructor(t={}){super(),this._a=new Map,this.ma=0,this.Ea=1e3*c(t.maxSizeMB)*1e3}get maxSizeMB(){return this.Ea/1e3/1e3}set maxSizeMB(t){this.Ea=1e3*c(t)*1e3,this.va()}get sizeBytes(){return this.ma}async get(t){const e=this._a.has(t),n=this._a.get(t);if(e)return this._a.delete(t),this._a.set(t,n),n}async set(t,e){const n=this._a.has(t);this._a.delete(t),this._a.set(t,e),n||(this.ma+=LocalCache.$a(t),this.ma+=LocalCache.$a(e),this.va())}clear(){r.Dt&&r.Ft("LocalCache","Clear"),this._a.clear(),this.ma=0}va(){if(!(this.ma<=i(this.Ea)))for(this.Pa("config://code-filter"),this.Pa("config://recent-broadcasts");this.ma>i(this.Ea);){const t=this._a.keys().next().value,e=this._a.get(t);if(t.startsWith("jig://")&&"code"===e.kind){const e=this._a.get("config://code-filter");e&&(s.remove(e,t),this._a.set("config://code-filter",e))}this._a.delete(t),this.ma-=LocalCache.$a(t),this.ma-=LocalCache.$a(e)}}static $a(t){switch(typeof t){case"undefined":throw new Error("Cannot cache undefined");case"boolean":return 5;case"number":if(Number.isFinite(t))return 9;throw new Error(`Cannot cache number: ${o(t)}`);case"string":return 2*t.length+1;case"object":{if(!t)return 5;const e=Object.keys(t);let n=1+4*e.length;return e.forEach((e=>{n+=LocalCache.$a(e),n+=LocalCache.$a(t[e])})),n}case"function":throw new Error(`Cannot cache function: ${o(t)}`);case"symbol":throw new Error(`Cannot cache symbol: ${o(t)}`)}}Pa(t){const e=this._a.get(t);void 0!==e&&(this._a.delete(t),this._a.set(t,e))}}function c(t){if(void 0===t)return 10;if("number"==typeof t&&!Number.isNaN(t)&&t>=0)return t;throw new Error(`Invalid maxSizeMB: ${o(t)}`)}t.exports=LocalCache},function(t,e,n){const r=n(7),{Y:o}=n(0),i=n(2),s=n(28),LocalCache=n(38);class StateWrapper{constructor(t=this,e=new LocalCache){this.tag="Object"===t.constructor.name?"State":t.constructor.name,this.cache=e,this.unwrappedState=t,this.unwrappedPull=t.pull,this.unwrappedBroadcast=t.broadcast,this.unwrappedLocations=t.locations,this.setWrappingEnabled(!0)}setWrappingEnabled(t){t?(this.pull=StateWrapper.prototype.wrappedPull,this.broadcast=this.unwrappedBroadcast&&StateWrapper.prototype.wrappedBroadcast,this.locations=this.unwrappedLocations&&StateWrapper.prototype.wrappedLocations):(this.pull=this.unwrappedPull,this.broadcast=this.unwrappedBroadcast,this.locations=this.unwrappedLocations)}async wrappedPull(t,e){if("string"!=typeof t||!t.length)throw new Error(`Invalid key: ${o(t)}`);if(void 0!==e&&("object"!=typeof e||!e))throw new Error(`Invalid options: ${o(e)}`);e=e||{};const n=this.cache&&await this.cache.get(t);if(void 0!==n)return n;if(!e.filter){const t=await this.cache.get("config://code-filter");t&&(e.filter=s.toBase64(t))}i.te&&i.qt(this.tag,"Pull",t,o(e));const r=new Date,c=await this.unwrappedPull.call(this.unwrappedState,t,e);return i.Dt&&i.Ft(this.tag,"Pull (end): "+(new Date-r)+"ms"),c&&this.cache&&await this.cache.set(t,c),c}async wrappedLocations(t){if("string"==typeof t)try{t=r.Script.fromAddress(t).toHex()}catch(e){try{t=new r.Script(t).toHex()}catch(e){throw new Error(`Invalid script: ${o(t)}`)}}else if(t instanceof r.Address)t=r.Script.fromAddress(t).toHex();else{if(!(t instanceof r.Script))throw new Error(`Invalid script: ${o(t)}`);t=t.toHex()}i.te&&i.qt(this.tag,"Locations",t);const e=new Date;let n=await this.unwrappedLocations.call(this.unwrappedState,t);if(i.Dt&&i.Ft(this.tag,"Trusted (end): "+(new Date-e)+"ms"),!Array.isArray(n)||n.some((t=>"string"!=typeof t)))throw new Error(`Received invalid locations: ${o(n)}`);const s=new Set;return n=n.filter((t=>s.has(t)?(i.ee&&i.Xt(this.tag,"Duplicate utxo returned from server:",t),!1):(s.add(t),!0))),n}async wrappedBroadcast(t){if("string"!=typeof t||!t.length)throw new Error(`Invalid rawtx: ${o(t)}`);i.te&&i.qt(this.tag,"Broadcast");const e=new Date;await this.unwrappedBroadcast.call(this.unwrappedState,t),i.Dt&&i.Ft(this.tag,"Broadcast (end): "+(new Date-e)+"ms")}}t.exports=StateWrapper},function(t,e,n){const r=n(7),o=n(56),i=n(2),LocalCache=n(38),{Y:s,lt:c}=n(0),a=/^(?:[a-fA-F0-9][a-fA-F0-9])*$/;class BlockchainWrapper{constructor(t=this,e=new LocalCache){this.tag="Object"===t.constructor.name?"Blockchain":t.constructor.name,this.cache=e,this.unwrappedBlockchain=t,this.unwrappedBroadcast=t.broadcast,this.unwrappedFetch=t.fetch,this.unwrappedUtxos=t.utxos,this.unwrappedSpends=t.spends,this.unwrappedTime=t.time,this!==this.unwrappedBlockchain&&c(this,"network",(()=>this.unwrappedBlockchain.network)),this.setWrappingEnabled(!0)}setWrappingEnabled(t){t?(this.broadcast=BlockchainWrapper.prototype.wrappedBroadcast,this.fetch=BlockchainWrapper.prototype.wrappedFetch,this.utxos=BlockchainWrapper.prototype.wrappedUtxos,this.spends=BlockchainWrapper.prototype.wrappedSpends,this.time=BlockchainWrapper.prototype.wrappedTime):(this.broadcast=this.unwrappedBroadcast,this.fetch=this.unwrappedFetch,this.utxos=this.unwrappedUtxos,this.spends=this.unwrappedSpends,this.time=this.unwrappedTime)}async wrappedBroadcast(t){let e=null;try{e=new r.Transaction(t)}catch(t){throw new Error(`Invalid transaction: ${s(t.toString())}`)}if(t="string"==typeof t?t:e.toString(),0===e.inputs.length)throw new Error("tx has no inputs");if(0===e.outputs.length)throw new Error("tx has no outputs");try{if(!0!==e.verify())throw new Error(e.verify())}catch(t){throw t.message.includes("duplicate input")?new Error("bad-txns-inputs-duplicate"):t}if(this.cache){const e=await this.cache.get("config://recent-broadcasts"),n=e&&e.find((e=>e.rawtx===t));if(n)return i.te&&i.qt(this.tag,"Already broadcasted",n.txid),n.txid}i.te&&i.qt(this.tag,"Broadcast",e.hash);const n=new Date,c=await this.unwrappedBroadcast.call(this.unwrappedBlockchain,t);i.Dt&&i.Ft(this.tag,"Broadcast (end): "+(new Date-n)+"ms");if("string"!=typeof c||64!==c.length||!a.test(c))throw new Error(`Invalid response txid: ${c}`);if(i.Dt&&e.hash!==c)throw new Error(`Txid response mismatch: ${c}`);if(this.cache){const n=[];if(void 0===await this.cache.get(`time://${c}`)){const t=this.cache.set(`time://${c}`,Date.now());t instanceof Promise&&t.catch((t=>{})),n.push(t)}for(const t of e.inputs){const e=`${t.prevTxId.toString("hex")}_o${t.outputIndex}`;n.push(this.cache.set(`spend://${e}`,c))}n.push(this.cache.set(`tx://${c}`,t)),n.push(o.Oa(this.cache,e,c)),await Promise.all(n)}return c}async wrappedFetch(t){if("string"!=typeof t||64!==t.length||!a.test(t))throw new Error(`Invalid txid: ${s(t)}`);const e=this.cache?await this.cache.get(`tx://${t}`):void 0;if(void 0!==e)return e;i.te&&i.qt(this.tag,"Fetch",t);const n=new Date,o=await this.unwrappedFetch.call(this.unwrappedBlockchain,t);if(i.Dt&&i.Ft(this.tag,"Fetch (end): "+(new Date-n)+"ms"),"string"!=typeof o||!o.length||!a.test(o))throw new Error(`Invalid rawtx fetched for ${t}: ${o}`);if(i.Dt&&new r.Transaction(o).hash!==t)throw new Error(`Transaction fetch mismatch for ${t}`);if(this.cache){const e=[];e.push(this.cache.set(`tx://${t}`,o));new r.Transaction(o).inputs.forEach((n=>{const r=`${n.prevTxId.toString("hex")}_o${n.outputIndex}`;e.push(this.cache.set(`spend://${r}`,t))})),await Promise.all(e)}return o}async wrappedUtxos(t){if("string"==typeof t)try{t=r.Script.fromAddress(t).toHex()}catch(e){try{t=new r.Script(t).toHex()}catch(e){throw new Error(`Invalid script: ${s(t)}`)}}else if(t instanceof r.Address)t=r.Script.fromAddress(t).toHex();else{if(!(t instanceof r.Script))throw new Error(`Invalid script: ${s(t)}`);t=t.toHex()}i.te&&i.qt(this.tag,"Utxos",t);const e=new Date;let n=await this.unwrappedUtxos.call(this.unwrappedBlockchain,t);if(i.Dt&&i.Ft(this.tag,"Utxos (end): "+(new Date-e)+"ms"),!Array.isArray(n)||n.some((t=>"string"!=typeof t.txid||(64!==t.txid.length||(!a.test(t.txid)||("number"!=typeof t.vout||(!Number.isInteger(t.vout)||(t.vout<0||("string"!=typeof t.script||(!a.test(t.script)||("number"!=typeof t.satoshis||(!Number.isInteger(t.satoshis)||(t.satoshis<0||void 0)))))))))))))throw new Error(`Received invalid utxos: ${s(n)}`);const c=new Set;return n=n.filter((t=>{const e=`${t.txid}_o${t.vout}`;return c.has(e)?(i.ee&&i.Xt(this.tag,"Duplicate utxo returned from server:",e),!1):(c.add(e),!0)})),this.cache&&await o.Sa(this.cache,n,t),n}async wrappedSpends(t,e){if("string"!=typeof t||64!==t.length||!a.test(t))try{const n=t.split("_o");t=n[0],e=parseInt(n[1]);if("string"!=typeof t||64!==t.length||!a.test(t))throw new Error}catch(e){throw new Error(`Invalid txid: ${s(t)}`)}if("number"!=typeof e||!Number.isInteger(e)||e<0)throw new Error(`Invalid vout: ${s(e)}`);const n=this.cache?await this.cache.get(`spend://${t}_o${e}`):void 0;if(void 0!==n)return n;i.te&&i.qt(this.tag,`Spends ${t}_o${e}`);const r=new Date,o=await this.unwrappedSpends.call(this.unwrappedBlockchain,t,e);if(i.Dt&&i.Ft(this.tag,"Spends (end): "+(new Date-r)+"ms"),null!==o&&("string"!=typeof o||64!==o.length||!a.test(o)))throw new Error(`Invalid spend txid fetched for ${t}_o${e}: ${o}`);return o&&this.cache&&await this.cache.set(`spend://${t}_o${e}`,o),o}async wrappedTime(t){if("string"!=typeof t||64!==t.length||!a.test(t))throw new Error(`Invalid txid: ${s(t)}`);const e=this.cache?await this.cache.get(`time://${t}`):void 0;if(void 0!==e)return e;i.te&&i.qt(this.tag,"Time",t);const n=new Date,r=await this.unwrappedTime.call(this.unwrappedBlockchain,t);if(i.Dt&&i.Ft(this.tag,"Time (end): "+(new Date-n)+"ms"),"number"!=typeof r||r<0)throw new Error(`Invalid time fetched for ${t}: ${r}`);return this.cache&&await this.cache.set(`time://${t}`,r),r}}t.exports=BlockchainWrapper},function(t,e,n){const r=n(7);function o(){return process&&process.version}function i(){return"undefined"!=typeof window&&window.document&&window.navigator}function s(){if("string"!=typeof r.version||!r.version.startsWith("v1.")){throw new Error(`Run requires version 1.x of the bsv library\n\n${"Hint: Please install bsv version 1.5.4 or install the Run SDK from NPM"}`)}}function c(){if(!o())return;const t=Number(process.version.match(/^v(\d+\.\d+)/)[1]);if(t<10)throw new Error("Run is supported only on Node 10 and above");if(t>=17)throw new Error("Run is supported only on Node 16 and below")}function a(){if(!i())return;const t=window.navigator.userAgent;if(-1!==t.indexOf("MSIE")||-1!==t.indexOf("Trident"))throw new Error("Run is not supported on Internet Explorer. Please upgrade to Edge.");if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);if([parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)][0]<13)throw new Error("Run is not supported on this iOS version. Please upgrade to iOS 13 or above.")}}t.exports={Rc:o,Ic:i,vt:function(){s(),c(),a()},xa:s,Aa:c,Ia:a}},function(t,e,n){const r=n(3);class CommonLock{constructor(t,e){this.address=t,this.testnet=e}script(){if("string"!=typeof this.address)throw new Error(`Address is not a string: ${this.address}`);const t=[],e=[];let n,r,o;const i=this.address;for(let s=0;s<i.length;s++){if(n=0,r="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz".indexOf(i[s]),r<0)throw new Error(`Invalid character in address: ${i}\n\nDetails: i=${s}, c=${i[s]}`);for(r||e.length^s||e.push(0);n in t||r;)o=t[n],o=o?58*o+r:r,r=o>>8,t[n]=o%256,n++}for(;n--;)e.push(t[n]);if(e.length<6)throw new Error(`Address too short: ${i}`);if(0!==e[0]&&111!==e[0])throw new Error(`Address may only be a P2PKH type: ${i}`);if(!0===this.testnet&&0===e[0]||!1===this.testnet&&111===e[0])throw new Error("Invalid network");return[118,169,20,...e.slice(1,e.length-4),136,172].map((t=>t.toString("16"))).map((t=>1===t.length?"0"+t:t)).join("")}domain(){return 108}}CommonLock.sealed=!0,CommonLock.toString();const o=r.zt();r.Tt(o).Vt(CommonLock,!0),t.exports=o},function(t,e,n){const r=n(7),o=n(2),{B:i,J:s,ut:c,S:a,I:h,Y:u}=n(0),{eo:f}=n(16),{ce:l,Cn:d}=n(10),{g:p}=n(6),{Gr:w}=n(13),y=n(3),b=n(21),g=n(24),_=n(26),m=n(8),{$o:E}=n(17),{TrustError}=n(11);class v{constructor(t,e){i(e instanceof Promise),this.uo=t,this.ho=e}}t.exports=async function(t,e,i,$,P,O){o.te&&o.qt("Recreate","Recreate",t),E(e.version);let S=null;if("berry"===e.kind||i&&!$.co.has("state")){const n=f(e),o=new r.deps.Buffer(n,"utf8");if(S=(await w(o)).toString("hex"),i&&S!==i){const n=`Cannot recreate ${t} from an incorrect state`,r=`State: ${JSON.stringify(e)}`;throw new Error(`${n}\n\n${r}\n\n${"Hint: Is the cache corrupted or returning wrong values?"}`)}}const x=new Map,A={_:m._,wc:t=>(x.set(t,null),(t=>{class e{}return e.location=t,e})(t))},I=_.dc(e.props,A);switch(e.cls&&_.dc(e.cls,A),e.kind){case"code":{const r=t.split("_")[0];return async function(t,e,r,o,i,a,h){const u={},f=e.origin.startsWith("_")?o:e.origin.slice(0,64);try{if(!await i.wo(f,"state"))throw new TrustError(f,"state")}catch(t){if(!await i.wo(o,"state"))throw new TrustError(o,"state")}const w=s(t.src);if(w){const t=e.deps[w].location,s=d(Object.assign({ze:o},l(t))),c=n(15),f=await c(s,void 0,i,a,h,!1);r.set(t,f),u[w]=f}const b=y.zt(),g=m.Tn(t.src,u)[0],[E,$]=y.hn(b,g),P=!1;y.Tt(b).Ee(E,P);const O=async()=>{for(const t of r.keys()){if(r.get(t))continue;const e=d(Object.assign({ze:o},l(t))),s=n(15),c=await s(e,void 0,i,a,h,!1);r.set(t,c)}const e={_:m._,wc:t=>{const e=r.get(t),n=d(Object.assign({ze:o},l(t)));if(!e)throw new Error(`Jig not loaded: ${n}`);return e}},s=_.dc(t.props,e);p((()=>{Object.keys(b).forEach((t=>{delete b[t]})),Object.keys(s).forEach((t=>c(b,t,s[t])))})),p((()=>{b.location=d(Object.assign({ze:o},l(b.location))),b.origin=d(Object.assign({ze:o},l(b.origin)))})),p((()=>{const t=y.un(b,$,b.deps);c(b,"deps",t),Object.keys(s.deps||{}).forEach((t=>{b.deps[t]=s.deps[t]}))})),i.cr("load",b)},S=O();return new v(b,S)}(e,I,x,r,$,P,O)}case"jig":{const r=t.split("_")[0];return async function(t,e,r,o,i,s,h){const u=!0,f=g.$n(u),w=new b(e,f);async function y(){for(const t of r.keys()){if(r.get(t))continue;const e=d(Object.assign({ze:o},l(t))),c=n(15),a=await c(e,void 0,i,s,h,!1);r.set(t,a)}const e=r.get(t.cls.$jig);p((()=>Object.setPrototypeOf(w,e.prototype)));const a={_:m._,wc:t=>{const e=r.get(t),n=d(Object.assign({ze:o},l(t)));if(!e)throw new Error(`Jig not loaded: ${n}`);return e}},u=_.dc(t.props,a);p((()=>{Object.keys(u).forEach((t=>{c(w,t,u[t])}))})),p((()=>{w.location=d(Object.assign({ze:o},l(w.location))),w.origin=d(Object.assign({ze:o},l(w.origin)))})),i.cr("load",w)}a.add(w);const E=y();return new v(w,E)}(e,I,x,r,$,P,O)}case"berry":return async function(t,e,r,o,i,s,a){const u=!0,f=g.Mr(u),w=new b(e,f);async function y(){for(const t of r.keys()){if(r.get(t))continue;const e=d(Object.assign({_hash:o},l(t))),c=n(15),h=await c(e,void 0,i,s,a,!1);r.set(t,h)}const B=r.get(t.cls.$jig);p((()=>Object.setPrototypeOf(w,B.prototype)));const e={_:m._,wc:t=>{const e=r.get(t),n=d(Object.assign({_hash:o},l(t)));if(!e)throw new Error(`Jig not loaded: ${n}`);return e}},h=_.dc(t.props,e);p((()=>{Object.keys(h).forEach((t=>{c(w,t,h[t])}))})),p((()=>{w.location=d(Object.assign({_hash:o},l(w.location))),w.origin=d(Object.assign({_hash:o},l(w.origin)))})),i.cr("load",w)}h.add(w);const E=y();return new v(w,E)}(e,I,x,S,$,P,O);default:{const n=`Cannot recreate ${t} from an invalid state`,r=`Invalid jig kind: ${u(e.kind)}`;throw new Error(`${n}\n\n${r}`)}}}},function(t,e,n){const r=n(2),o=/^(?:[a-fA-F0-9][a-fA-F0-9])*$/;class OwnerWrapper{constructor(t=this){this.tag="Object"===t.constructor.name?"Owner":t.constructor.name,this.unwrappedOwner=t,this.unwrappedNextOwner=t.nextOwner,this.unwrappedSign=t.sign,this.setWrappingEnabled(!0)}setWrappingEnabled(t){t?(this.nextOwner=OwnerWrapper.prototype.wrappedNextOwner,this.sign=OwnerWrapper.prototype.wrappedSign):(this.nextOwner=this.unwrappedNextOwner,this.sign=this.unwrappedSign)}async wrappedNextOwner(){r.te&&r.qt(this.tag,"Next owner");const t=new Date,e=await this.unwrappedNextOwner.call(this.unwrappedOwner);return r.Dt&&r.Ft(this.tag,"Next owner (end): "+(new Date-t)+"ms"),e}async wrappedSign(t,e,n){if(e=e||[],n=n||[],"string"!=typeof t||!o.test(t))throw new Error(`Invalid tx to sign: ${t}`);r.te&&r.qt(this.tag,"Sign");const i=new Date,s=await this.unwrappedSign.call(this.unwrappedOwner,t,e,n);if(r.Dt&&r.Ft(this.tag,"Sign (end): "+(new Date-i)+"ms"),"string"!=typeof s||!o.test(s))throw new Error(`Invalid signed tx: ${s}`);return s}}t.exports=OwnerWrapper},function(t,e,n){const r=n(7),o=n(2),{Y:i}=n(0),s=/^(?:[a-fA-F0-9][a-fA-F0-9])*$/;class PurseWrapper{constructor(t=this,e=null){this.tag="Object"===t.constructor.name?"Purse":t.constructor.name,this.blockchain=e,this.unwrappedPurse=t,this.unwrappedPay=t.pay,this.unwrappedBroadcast=t.broadcast,this.unwrappedCancel=t.cancel,this.setWrappingEnabled(!0)}setWrappingEnabled(t){t?(this.pay=PurseWrapper.prototype.wrappedPay,this.broadcast=this.unwrappedBroadcast&&PurseWrapper.prototype.wrappedBroadcast,this.cancel=this.unwrappedCancel&&PurseWrapper.prototype.wrappedCancel):(this.pay=this.unwrappedPay,this.broadcast=this.unwrappedBroadcast,this.cancel=this.unwrappedCancel)}async wrappedPay(t,e){t instanceof r.Transaction&&(t=t.toString());const n=()=>{throw new Error(`Invalid tx to pay: ${i(t)}`)};"string"==typeof t&&s.test(t)||n();try{new r.Transaction(t)}catch(t){n()}void 0===e&&(e=[]);if(!Array.isArray(e)||e.some((t=>"string"!=typeof t.script))||e.some((t=>"number"!=typeof t.satoshis)))throw new Error(`Invalid parents: ${i(e)}`);o.te&&o.qt(this.tag,"Pay");const c=new Date,a=await this.unwrappedPay.call(this.unwrappedPurse,t,e);if(o.Dt&&o.Ft(this.tag,"Pay (end): "+(new Date-c)+"ms"),"string"!=typeof a||!s.test(a))throw new Error(`Invalid paid tx: ${a}`);return a}async wrappedBroadcast(t){const e=()=>{throw new Error(`Invalid tx to broadcast: ${i(t)}`)};"string"==typeof t&&s.test(t)||e();try{new r.Transaction(t)}catch(t){e()}o.te&&o.qt(this.tag,"Broadcast");const n=new Date,c=await this.unwrappedBroadcast.call(this.unwrappedPurse,t);return o.Dt&&o.Ft(this.tag,"Broadcast (end): "+(new Date-n)+"ms"),c}async wrappedCancel(t){const e=()=>{throw new Error(`Invalid tx to cancel: ${i(t)}`)};"string"==typeof t&&s.test(t)||e();try{new r.Transaction(t)}catch(t){e()}o.te&&o.qt(this.tag,"Cancel");const n=new Date,c=await this.unwrappedCancel.call(this.unwrappedPurse,t);return o.Dt&&o.Ft(this.tag,"Cancel (end): "+(new Date-n)+"ms"),c}}t.exports=PurseWrapper},function(t,e,n){const r=n(62),{bo:o,_o:i,mo:s}=n(16),{g:c}=n(6),{In:a}=n(22);t.exports=class{constructor(){const t=`var n=${a(s.toString())};var m=${a(o.toString())};m(n);`,e=`(()=>{\n      ${r};\n      ${t};\n      SES.lockdown();\n      var C = this.Compartment;\n      delete this.SES;\n      delete this.Compartment;\n      return C\n    })()`;{const t=n(63);this.Compartment=t.runInNewContext(e)}this.globalOverrides={},i.forEach((t=>{this.globalOverrides[t]=void 0}));const h=this.Ra();h.global.c=console,h.global.s=c,this.globalOverrides.console=h.evaluate("\n      const o = { }\n      Object.keys(c).forEach(name => {\n        o[name] = (...args) => s(() => c[name](...args))\n      })\n      o\n    ")}makeCompartment(){const t=this.Ra();Object.assign(t.global,this.globalOverrides);return{evaluate:e=>(this.ja(e),t.evaluate(e)),global:new Proxy({},{set:(e,n,r)=>(e[n]=t.global[n]=r,!0),deleteProperty:(e,n)=>(delete e[n],n in this.globalOverrides?t.global[n]=this.globalOverrides[n]:delete t.global[n],!0),defineProperty:(e,n,r)=>(Object.defineProperty(e,n,r),Object.defineProperty(t.global,n,r),!0)})}}Ra(){return new this.Compartment}ja(t){if(/for\s*\([^)]+\s+in\s+\S+\)/g.test(t))throw new Error("for-in loops are not supported")}}},function(t,e,n){const r=n(8),{Y:o}=n(0),{Sn:i}=n(6),{ArgumentError}=n(11),s=r._,c=new WeakMap;function a(t){const e=c.get(t);if(!e)throw new ArgumentError(`Not a dynamic type: ${o(t)}`);return e}function h(){const t=c.get(this),e=t?t.Ge:this;return s.Function.prototype.toString.apply(e)}class u{constructor(){const t=r.Tn("function dynamic() {}")[0],e=e=>{delete t.prototype[e]};Object.getOwnPropertyNames(t.prototype).forEach(e),Object.getOwnPropertySymbols(t.prototype).forEach(e);const n={},o=new l,i=new Proxy(n,o),s=Object.getPrototypeOf(t.prototype);Object.setPrototypeOf(n,s),Object.setPrototypeOf(t.prototype,i),Object.freeze(t.prototype);const a=new f;o.fe(i,a);const h=new Proxy(t,a);return a.fe(t,n,h),c.set(h,a),h}static $e(t){return a(t).Ge}static Re(t,e){a(t).Re(e)}static Ta(t){return a(t).Ca}static We(t,e){a(t).We(e)}}class f{fe(t,e,n){this.Na=t,this.Ge=t,this.Ca=n,this.Ai=n,this.ka=e}apply(t,e,n){return Reflect.apply(this.Ge,e,n)}construct(t,e,n){let r=n;try{r=u.Ta(n)}catch(t){}return Reflect.construct(this.Ge,e,r)}defineProperty(t,e,n){if("prototype"===e)throw new Error("Cannot define prototype");if("toString"===e)throw new Error("Cannot define toString");if(!n.configurable)throw new Error("Cannot define nonconfigurable property");return Reflect.defineProperty(this.Ge,e,n),!0}deleteProperty(t,e){if("prototype"===e)throw new Error("Cannot delete prototype");if("toString"===e)throw new Error("Cannot delete toString");return Reflect.deleteProperty(this.Ge,e),!0}get(t,e,n){return"prototype"===e?this.Na.prototype:"toString"===e?h:Reflect.get(this.Ge,e,n)}getPrototypeOf(t){return Reflect.getPrototypeOf(this.Ge)}getOwnPropertyDescriptor(t,e){if("prototype"===e)return Object.getOwnPropertyDescriptor(this.Na,e);const n=Reflect.getOwnPropertyDescriptor(this.Ge,e);if(!n)return n;const r=Reflect.getOwnPropertyDescriptor(t,e);return r&&!r.configurable||(n.configurable=!0),n}has(t,e){return Reflect.has(this.Ge,e)}isExtensible(t){return Reflect.isExtensible(this.Na)}ownKeys(t){return Reflect.ownKeys(this.Ge)}preventExtensions(t){return Object.preventExtensions(this.Na),Object.preventExtensions(this.Ge),!0}set(t,e,n,r){if("prototype"===e)throw new Error("Cannot set prototype");if("toString"===e)throw new Error("Cannot set toString");return Reflect.set(this.Ge,e,n),!0}setPrototypeOf(t,e){return Reflect.setPrototypeOf(this.Ge,e),!0}Re(t){if("function"!=typeof t)throw new ArgumentError(`Inner type must be a function type: ${o(t)}`);let e=t;for(;e&&e!==Function.prototype&&e!==s.Function.prototype;){if(Object.getOwnPropertyNames(e).includes("toString"))throw new ArgumentError(`toString is a reserved property: ${t}`);e=Reflect.getPrototypeOf(e)}Reflect.isExtensible(this.Na)&&Reflect.isExtensible(t)||(Reflect.preventExtensions(this.Na),Reflect.preventExtensions(t));const n=this.Ge===this.Na||t===this.Na,r=this.Ge.toString().startsWith("class"),i=t.toString().startsWith("class");if(!n&&r!==i)throw new ArgumentError(`Classes can only be changed to classes and functions to functions: ${o(t)}`);const c=t=>{delete this.ka[t]};Object.getOwnPropertyNames(this.ka).forEach(c),Object.getOwnPropertySymbols(this.ka).forEach(c);const a=Reflect.getPrototypeOf(t.prototype);Reflect.setPrototypeOf(this.ka,a);Object.getOwnPropertyNames(t.prototype).concat(Object.getOwnPropertySymbols(t.prototype)).forEach((e=>{const n=Reflect.getOwnPropertyDescriptor(t.prototype,e);Reflect.defineProperty(this.ka,e,n)})),this.ka.constructor=this.Ca,this.Ge=t}We(t){this.Ca!==this.Ai&&c.delete(this.Ca),c.set(t,this),this.Ca=t,this.ka.constructor=t}}class l{fe(t,e){this.Ai=t,this.Ua=e}defineProperty(t,e,n){throw new Error("defineProperty disabled")}deleteProperty(t,e){throw new Error("deleteProperty disabled")}preventExtensions(){throw new Error("preventExtensions disabled")}set(t,e,n,r){if(r===this.Ai)throw new Error("Cannot set property");const o=Reflect.getPrototypeOf(r);try{return Reflect.setPrototypeOf(r,Reflect.getPrototypeOf(Object)),r[e]=n,!0}catch(t){throw new Error("Cannot set property")}finally{Reflect.setPrototypeOf(r,o)}}setPrototypeOf(t,e){if(!i())throw new Error("setPrototypeOf disabled");return Reflect.setPrototypeOf(t,e),Reflect.setPrototypeOf(this.Ua.Ge.prototype,e),!0}}t.exports=u},function(t,e){t.exports=class{constructor(){this.tasks=[]}async To(t){return new Promise(((e,n)=>{this.tasks.push({func:t,reject:n,resolve:e}),1===this.tasks.length&&this.Da()}))}async Da(){const t=this.tasks[0];try{const e=t.func();t.resolve(e instanceof Promise?await e:e)}catch(e){t.reject(e)}finally{this.tasks.shift(),this.tasks.length&&this.Da()}}}},function(t,e,n){const r=n(2),{B:o,Y:i,tt:s}=n(0),{ce:c}=n(10),{g:a}=n(6),{Oo:h}=n(17),u=n(26);t.exports={Lo:async function(t,e,n,c,f){r.Dt&&r.Ft("Capture","Capture",i(t));const l=e.ur,d=e.Do.get(t);o(d);const p=await e.Uo(f);f.vt();const w={Jo:t=>{const r=n.get(t);if(s(r))return`_o${e.Ko.outputs.length+1+r}`;const i=c.get(t);if(s(i))return`_d${i}`;const h=l.Wn.Tt(t);if(h)return l.Kn.get(h).lr.location;const u=a((()=>t.origin));if(u.startsWith("native://"))return u;const f=p[u]&&p[u][0];return o(f),f}},y={};d.fa&&(y.cls=u.Wo(d.fa,w)),y.kind=d.ua;const b=Object.assign({},d.lr),g=n.get(t),_=c.get(t),m=s(g)?`_o${e.Ko.outputs.length+1+g}`:`_d${_}`;return b.location=m,o(!b.origin.startsWith("record://")||b.origin.startsWith(`record://${l.Nn}`)),b.origin.startsWith(`record://${l.Nn}`)&&(b.origin=m),y.props=u.Wo(b,w),d.Nt&&(y.src=d.Nt),y.version=h(e.Tr),y},do:function(t,e){const n={Jo:t=>{const e=a((()=>t.location)),n=c(e);return o(s(n.ze)&&!s(n.ur)&&!s(n.Qt)),e}},r={};r.cls=u.Wo(t.constructor,n),r.kind="berry";const i=a((()=>Object.assign({},t)));return r.props=u.Wo(i,n),r.version=h(e),r}}},function(t,e,n){const r=n(7),{B:o,Y:i,bt:s,tt:c,F:a}=n(0),h=n(2),{ot:u,Zr:f}=n(14),{g:l}=n(6),{ce:d}=n(10),{ro:p}=n(33),w="Sync";t.exports=async function(t,e={}){const Jig=n(5),Code=n(1),y=n(3);if(n(27).Mt)throw new Error("sync disabled in atomic update");o(t instanceof Jig||t instanceof Code);const b=a();e.Et=e.Et||new s("sync",b.Et),e.Fa=e.Fa||new Map,h.te&&h.qt(w,"Sync",i(t));const g=new Date;if(e.Fa.has(t))return;t instanceof Code&&l((()=>d(t.location))).Ae&&y.Tt(t).Be();let _=!1,m=null;const E=async function(){try{_=await async function(t,e,r){const o=n(36);let s=!1;for(;;){const n=l((()=>t.location)),r=d(n);if(c(r.Qt))throw new Error(`Cannot sync\n\n${r.Qt}`);if(!c(r.ur))break;h.Dt&&h.Ft(w,`Waiting to publish ${i(t)}`),s=!0;const a=o.Rr(r.ur);if(!a)throw new Error(`Cannot sync ${i(t)}: transaction in progress`);h.Dt&&h.Ft(w,"Sync",a.ur.Nn),await a.ya(),e.Et.vt()}return r.cr("sync",t),s}(t,e,b)}catch(t){m=t}e.Et.vt();try{_||await async function(t,e,s){if(!1===e.forward)return;let a=l((()=>t.location)),u=d(a);for(;e.Et.vt(),!c(u.He);){if(c(u.ur))throw new Error(`Cannot sync ${i(t)}: transaction in progress`);o(c(u.ze)&&c(u.Ve));const f=await s.qo(u.ze,u.Ve);if(!f)break;e.Et.vt(),h.te&&h.qt(w,"Forward syncing to",f);const y=await s.fo(f);e.Et.vt();const b=new r.Transaction(y);let g=null;try{g=p(b)}catch(t){h.ne&&h.Qt(w,t);break}const _=n(34),m=!0,E=t,v=!1;await _(b,f,g,s,m,E,e.Et,v),e.Et.vt(),a=l((()=>t.location)),u=d(a)}s.cr("sync",t)}(t,e,b)}catch(t){m=m||t}return e.Et.vt(),t}();e.Fa.set(t,E),e.Fa.set(l((()=>t.origin)),E),await E;try{await async function(t,e,r){if(!1===e.inner)return;if(void 0===e.inner&&r)return;h.Dt&&h.Ft(w,"Inner sync");const Jig=n(5),Code=n(1),o=new Set;l((()=>u(t,(e=>e===t||(e instanceof Jig||e instanceof Code?(o.add(e),!1):void 0)))));const i=[],s=new Map;for(const t of o){const n=e.Fa.get(t)||e.Fa.get(l((()=>t.origin)));!1!==e.forward&&n?s.set(t,n):i.push(t.sync(e))}await Promise.all(i);for(const t of s.keys())s.set(t,await s.get(t));e.Et.vt(),!1!==e.forward&&l((()=>f(t,(t=>s.get(t)))))}(t,e,_)}catch(t){if(!m)throw t}if(e.Et.vt(),m)throw m;h.Dt&&h.Ft(w,"Sync (end): "+(new Date-g)+"ms")}},function(t,e,n){const{NotImplementedError}=n(11);class r{get network(){throw new NotImplementedError}async broadcast(t){throw new NotImplementedError}async fetch(t){throw new NotImplementedError}async utxos(t){throw new NotImplementedError}async time(t){throw new NotImplementedError}async spends(t,e){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("string"==typeof t.network&&("function"==typeof t.broadcast&&("function"==typeof t.fetch&&("function"==typeof t.utxos&&("function"==typeof t.time&&"function"==typeof t.spends))))))}}class o{async get(t){throw new NotImplementedError}async set(t,e){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("function"==typeof t.get&&"function"==typeof t.set))}}class i{script(){throw new NotImplementedError}domain(){throw new NotImplementedError}static[Symbol.hasInstance](t){if("object"!=typeof t||!t)return!1;if("function"!=typeof t.constructor.prototype.script)return!1;if(Object.getOwnPropertyNames(t).includes("script"))return!1;const e=t.script();if(e.length%2!=0)return!1;const n="01234567890abcdefABCDEF".split("");if(e.split("").some((t=>!n.includes(t))))return!1;return"function"==typeof t.constructor.prototype.domain&&(!Object.getOwnPropertyNames(t).includes("domain")&&(!!Number.isSafeInteger(t.domain())&&!(t.domain()<0)))}}class s{info(...t){}debug(...t){}warn(...t){}error(...t){}static[Symbol.hasInstance](t){return!Array.isArray(t)&&(("object"==typeof t||"function"==typeof t)&&!!t)}}class c{async sign(t,e,n){throw new NotImplementedError}async nextOwner(){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("function"==typeof t.sign&&("function"==typeof t.nextOwner||"function"==typeof t.owner)))}}class a{async pay(t,e){throw new NotImplementedError}async broadcast(t){throw new NotImplementedError}async cancel(t){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&"function"==typeof t.pay)}}class h{async pull(t,e){throw new NotImplementedError}async locations(t){throw new NotImplementedError}async broadcast(t){throw new NotImplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&"function"==typeof t.pull)}}t.exports={Blockchain:r,Cache:o,Lock:i,Logger:s,Owner:c,Purse:a,State:h}},function(t,e,n){{const CacheWrapper=n(37),{Gr:e}=n(31),r=n(69),o=n(70),i=n(2),s="DiskCache";class DiskCache extends CacheWrapper{constructor(t={}){super(),this.dir=t.dir||DiskCache.defaults.dir;try{r.mkdirSync(this.dir,{recursive:!0})}catch(t){t.toString().includes("already exists")||i.ne&&i.Qt(s,`Failed to create cache directory: ${t.toString()}`)}}async set(t,e){const n=await this.Ma(t);return new Promise(((o,c)=>{r.writeFile(n,JSON.stringify(e),{encoding:"utf8",flag:"w"},(e=>{e&&i.ne&&i.Qt(s,`Failed to save ${t}: ${e}`),o()}))}))}async get(t){const e=await this.Ma(t);return new Promise(((n,o)=>{const c={encoding:"utf8",flag:"r"};r.readFile(e,c,((o,a)=>{let h,u=o;for(let t=0;t<3;t++)try{a&&!u||(a=r.readFileSync(e,c)),h=JSON.parse(a)}catch(t){u=t;continue}i.ne&&u&&!u.toString().includes("no such file")&&i.Qt(s,`Failed to read ${t}: ${u}`),n(h)}))}))}async Ma(t){const n=Buffer.from(await e(Buffer.from(t,"utf8"))).toString("hex");return o.join(this.dir,n)}}DiskCache.defaults={dir:"./.runcache"},t.exports=DiskCache}},function(t,e,n){const r=n(7),{PrivateKey:o,Script:i,Transaction:s}=r,{L:c,Y:a}=n(0),{Vr:h,zr:u}=n(13),OwnerWrapper=n(44);class LocalOwner extends OwnerWrapper{constructor(t,e){super();const r=(e=e||n(30).instance&&n(30).instance.blockchain.network)&&c(e);if(void 0!==t&&"string"!=typeof t&&!(t instanceof o))throw new Error(`Invalid private key: ${a(t)}`);if(r&&t&&t instanceof o&&t.network.name!==r)throw new Error("Private key network mismatch");try{this.bsvPrivateKey=new o(t,r)}catch(e){throw new Error(`Invalid private key: ${a(t)}\n\n${e}`)}if(t&&this.bsvPrivateKey.toString()!==t.toString())throw new Error(`Invalid private key: ${a(t)}`);this.bsvPublicKey=this.bsvPrivateKey.publicKey,this.bsvAddress=this.bsvPublicKey.toAddress(),this.privkey=this.bsvPrivateKey.toString(),this.pubkey=this.bsvPublicKey.toString(),this.address=this.bsvAddress.toString()}async sign(t,e,o){const CommonLock=n(42),Group=n(54),c=new s(t);e.forEach(((t,e)=>{t&&(c.inputs[e].output=new s.Output({satoshis:t.satoshis,script:new i(t.script)}))}));for(let t=0;t<c.inputs.length;t++){const n=o[t]instanceof CommonLock,s=c.inputs[t].output&&c.inputs[t].output.script.isPublicKeyHashOut()&&c.inputs[t].output.script.toAddress().toString()===this.address;if(n||s){const n=new i(e[t].script);if(n.toAddress().toString()!==this.address)continue;const r=await h(c,t,n,e[t].satoshis,this.bsvPrivateKey),o=i.fromASM(`${r} ${this.pubkey}`);c.inputs[t].setScript(o)}if(o[t]instanceof Group&&o[t].pubkeys.includes(this.pubkey)&&c.inputs[t].script.chunks.length<=o[t].required){const n=c.inputs[t].script.chunks.slice(1).map((t=>t.buf.toString("hex"))),s={script:new r.Script(e[t].script),satoshis:e[t].satoshis},a=await f(c,t,s,n,o[t].pubkeys);if(a.includes(this.pubkey))continue;const u=new i(e[t].script),l=await h(c,t,u,e[t].satoshis,this.bsvPrivateKey),d=o[t].pubkeys.map((t=>{const e=a.indexOf(t);return-1!==e?n[e]:t===this.pubkey?l:null})).filter((t=>null!==t)),p=i.fromASM(`OP_0 ${d.join(" ")}`);c.inputs[t].setScript(p)}}return c.toString("hex")}async nextOwner(){return this.address}}async function f(t,e,n,o,i){const s=r.crypto.Signature.SIGHASH_ALL|r.crypto.Signature.SIGHASH_FORKID,c=new r.crypto.BN(n.satoshis),a=await u(t,s,e,n.script,c),h=i.map((t=>new r.PublicKey(t))),f=o.map((t=>{const e=t.slice(0,t.length-2),n=r.deps.Buffer.from(e,"hex"),o=r.crypto.Signature.fromDER(n);return h.findIndex((t=>r.crypto.ECDSA.verify(a,o,t,"little")))})),l=f.findIndex((t=>-1===t));if(-1!==l)throw new Error(`Bad signature at index ${l}`);return f.map((t=>i[t]))}LocalOwner.Ba=f,t.exports=LocalOwner},function(t,e,n){const r=n(3),asm=n(55),Hex=n(29);class Group{constructor(t,e){this.pubkeys=t,this.required=void 0===e?this.pubkeys.length:e}script(){if(!Array.isArray(this.pubkeys))throw new Error("pubkeys not an array");if(this.pubkeys.length<1)throw new Error("pubkeys must have at least one entry");if(this.pubkeys.length>16)throw new Error("No more than 16 pubkeys allowed");const t=new Set;for(const e of this.pubkeys)t.add(e);if(t.size!==this.pubkeys.length)throw new Error("pubkeys contains duplicates");this.pubkeys.forEach((t=>Hex.stringToBytes(t)));if("number"!=typeof this.required||!Number.isInteger(this.required)||this.required<1)throw new Error("required must be a non-negative integer");if(this.required>this.pubkeys.length)throw new Error("required must be <= the number of pubkeys");return asm(`OP_${this.required} ${this.pubkeys.join(" ")} OP_${this.pubkeys.length} OP_CHECKMULTISIG`)}domain(){return 1+74*this.required}add(t){this.pubkeys.includes(t)||this.pubkeys.push(t)}}Group.deps={asm,Hex},Group.sealed=!1,Group.toString(),Group.presets={},Group.presets.main={},Group.presets.test={},Group.presets.main.location="780ab8919cb89323707338070323c24ce42cdec2f57d749bd7aceef6635e7a4d_o1",Group.presets.main.origin="90a3ece416f696731430efac9657d28071cc437ebfff5fb1eaf710fe4b3c8d4e_o1",Group.presets.main.nonce=2,Group.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",Group.presets.main.satoshis=0,Group.presets.test.location="63e0e1268d8ab021d1c578afb8eaa0828ccbba431ffffd9309d04b78ebeb6e56_o1",Group.presets.test.origin="03320f1244e509bb421e6f1ff724bf1156182890c3768cfa4ea127a78f9913d2_o1",Group.presets.test.nonce=3,Group.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",Group.presets.test.satoshis=0,t.exports=r.Te(Group)},function(t,e,n){const r=n(3),Hex=n(29);function asm(t){const e=t.split(" ");let n=[];for(const t of e){if(void 0!==asm.OP_CODES[t]){n.push(asm.OP_CODES[t]);continue}const e=Hex.stringToBytes(1===t.length?"0"+t:t);if(1===e.length&&0===e[0]){n.push(e[0]);continue}if(1===e.length&&e[0]>=1&&e[0]<=16){n.push(e[0]+80);continue}if(e.length<=75){n=n.concat(e.length).concat(e);continue}if(e.length<256){n=n.concat(asm.OP_CODES.OP_PUSHDATA1).concat([e.length]).concat(e);continue}const r=t=>parseInt(t.toString(),10);if(e.length<65536){const t=[e.length%256,r(e.length/256)];n=n.concat(asm.OP_CODES.OP_PUSHDATA2).concat(t).concat(e);continue}const o=[e.length%256,r(e.length/256)%256,r(e.length/256/256)%256,r(e.length/256/256/256)];n=n.concat(asm.OP_CODES.OP_PUSHDATA4).concat(o).concat(e)}return Hex.bytesToString(n)}asm.OP_CODES={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_IF:99,OP_NOTIF:100,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SPLIT:127,OP_NUM2BIN:128,OP_BIN2NUM:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_1ADD:139,OP_1SUB:140,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255},asm.deps={Hex},asm.toString(),asm.presets={},asm.presets.main={},asm.presets.test={},asm.presets.main.location="284ce17fd34c0f41835435b03eed149c4e0479361f40132312b4001093bb158f_o1",asm.presets.main.origin="61e1265acb3d93f1bf24a593d70b2a6b1c650ec1df90ddece8d6954ae3cdd915_o1",asm.presets.main.nonce=3,asm.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",asm.presets.main.satoshis=0,asm.presets.test.location="03e21aa8fcf08fa6985029ad2e697a2309962527700246d47d891add3cfce3ac_o1",asm.presets.test.origin="1f0abf8d94477b1cb57629d861376616f6e1d7b78aba23a19da3e6169caf489e_o1",asm.presets.test.nonce=3,asm.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",asm.presets.test.satoshis=0,t.exports=r.Te(asm)},function(t,e,n){const{$t:r}=n(0),o="config://recent-broadcasts";function i(t,e,n){const r=e.inputs.map((t=>({txid:t.prevTxId.toString("hex"),vout:t.outputIndex}))),o=e.outputs.map(((t,e)=>{const r=t.script.toHex(),o=t.satoshis;return{txid:n,vout:e,script:r,satoshis:o}})),i={rawtx:e.toString(),txid:n,time:Date.now(),inputs:r,outputs:o};t.push(i)}function s(t,e,n){t.forEach((t=>{t.outputs.forEach((t=>{t.script===n&&(e.some((e=>e.txid===t.txid&&e.vout===t.vout))||e.push(t))}))})),r(e,(e=>!t.some((t=>t.inputs.some((t=>t.txid===e.txid&&t.vout===e.vout))))))}function c(t,e=1e4){r(t,(t=>Date.now()-t.time<e))}t.exports={Oa:async function(t,e,n,r=1e4){const s=await t.get(o)||[];c(s,r),i(s,e,n),await t.set(o,s)},Sa:async function(t,e,n,r=1e4){const i=await t.get(o);i&&(c(i,r),s(i,e,n))},ar:i,La:s,Ga:c}},function(t,e,n){const{Kr:r}=n(13),o=n(18),BlockchainWrapper=n(40),{So:i}=o;t.exports=class extends BlockchainWrapper{constructor(t={}){super(),this.api="run",this.network=function(t){if(void 0===t)return"main";if("string"!=typeof t)throw new Error(`Invalid network: ${t}`);if("main"!==t&&"test"!==t)throw new Error(`RunConnect API does not support the "${t}" network`);return t}(t.network),this.request=o,this.host="https://api.run.network"}async broadcast(t){const e=`${this.host}/v1/${this.network}/tx`,n={method:"POST",body:{rawtx:t}};return await this.request(e,n)}async fetch(t){const e=`${this.host}/v1/${this.network}/rawtx/${t}`;return(await this.request(e)).toString("hex")}async utxos(t){const e=await r(t),n=`${this.host}/v1/${this.network}/utxos/${e}`;return await this.request(n,{cache:1e3})}async time(t){const e=`${this.host}/v1/${this.network}/tx/${t}`,n=await this.request(e,{cache:1e3});if(this.cache){const e=[];e.push(this.cache.set(`tx://${t}`,n.hex)),n.vout.forEach(((n,r)=>{n.spentTxId&&e.push(this.cache.set(`spend://${t}_o${r}`,n.spentTxId))})),await Promise.all(e)}return 1e3*n.time||Date.now()}async spends(t,e){try{const n=`${this.host}/v1/${this.network}/spends/${t}_o${e}`;return(await this.request(n)).spentTxId}catch(t){if(t instanceof i&&404===t.status)return null;throw t}}}},function(t,e,n){const r=n(3),Tx=n(59),Hex=n(29);function txo(t){const e={};function n(t,e){const n={};return function(t){const e=Hex.stringToBytes(t);let n=0;function r(){return e[n++]}function o(){return r()+256*r()}function i(t){const r=Hex.bytesToString(e.slice(n,n+t));return n+=t,r}const s=[];for(;n<e.length;){const t=r();if(t>0&&t<76)s.push({buf:i(t),len:t,opcodenum:t});else if(76===t){const e=r();s.push({buf:i(e),len:e,opcodenum:t})}else if(77===t){const e=o();s.push({buf:i(e),len:e,opcodenum:t})}else if(78===t){const e=o()+256*o()*256;s.push({buf:i(e),len:e,opcodenum:t})}else s.push({opcodenum:t})}return s}(t).forEach(((t,r)=>{if(t.buf){n["b"+r]=function(t){const e=t=>t.toString(2).padStart(8,0),n=t.length;let r="";for(let o=0;o<=(n-1)/3;o++){const i=3*o+1>=n,s=3*o+2>=n;r+=(e(t[3*o])+e(i?0:t[3*o+1])+e(s?0:t[3*o+2])).match(/.{1,6}/g).map(((t,e)=>3===e&&s||2===e&&i?"=":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[+("0b"+t)])).join("")}return r}(Hex.stringToBytes(t.buf));const o=t.buf.replace(/[0-9a-f]{2}/g,"%$&");if(e)try{n["s"+r]=decodeURIComponent(o)}catch(t){}e&&(n["h"+r]=t.buf)}else n["b"+r]={op:t.opcodenum}})),n}const r=new Tx(t);return e.in=r.inputs.map((function(t,e){const r=n(t.script);return r.e={h:t.prevTxId,i:t.outputIndex},r.i=e,r.seq=t.sequenceNumber,r})),e.out=r.outputs.map((function(t,e){const r=n(t.script,!0);return r.e={v:t.satoshis,i:e},r.i=e,r})),e.lock=r.nLockTime,e}txo.deps={Tx,Hex},Tx.toString(),txo.presets={},txo.presets.main={},txo.presets.test={},txo.presets.main.location="05f67252e696160a7c0099ae8d1ec23c39592378773b3a5a55f16bd1286e7dcb_o2",txo.presets.main.origin="312985bd960ae4c59856b3089b04017ede66506ea181333eec7c9bb88b11c490_o1",txo.presets.main.nonce=2,txo.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",txo.presets.main.satoshis=0,txo.presets.test.location="d476fd7309a0eeb8b92d715e35c6e273ad63c0025ff6cca927bd0f0b64ed88ff_o2",txo.presets.test.origin="33e78fa7c43b6d7a60c271d783295fa180b7e9fce07d41ff1b52686936b3e6ae_o1",txo.presets.test.nonce=2,txo.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",txo.presets.test.satoshis=0,t.exports=r.Te(txo)},function(t,e,n){const r=n(3),Hex=n(29);class Tx{constructor(t){const e=Hex.stringToBytes(t);let n=0;function r(){return e[n++]}function o(){return r()+256*r()}function i(){return o()+256*o()*256}function s(){return i()+256*i()*256*256*256}function c(){const t=r();return 255===t?s():254===t?i():253===t?o():t}function a(){const t=Hex.bytesToString(e.slice(n,n+32).reverse());return n+=32,t}function h(){const t=c(),r=Hex.bytesToString(e.slice(n,n+t));return n+=t,r}this.version=i();const u=c();this.inputs=[];for(let t=0;t<u;t++)this.inputs.push({prevTxId:a(),outputIndex:i(),script:h(),sequenceNumber:i()});const f=c();this.outputs=[];for(let t=0;t<f;t++)this.outputs.push({satoshis:s(),script:h()});this.nLockTime=i()}}Tx.deps={Hex},Tx.toString(),Tx.presets={},Tx.presets.main={},Tx.presets.test={},Tx.presets.main.location="05f67252e696160a7c0099ae8d1ec23c39592378773b3a5a55f16bd1286e7dcb_o1",Tx.presets.main.origin="312985bd960ae4c59856b3089b04017ede66506ea181333eec7c9bb88b11c490_o2",Tx.presets.main.nonce=2,Tx.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",Tx.presets.main.satoshis=0,Tx.presets.test.location="d476fd7309a0eeb8b92d715e35c6e273ad63c0025ff6cca927bd0f0b64ed88ff_o1",Tx.presets.test.origin="33e78fa7c43b6d7a60c271d783295fa180b7e9fce07d41ff1b52686936b3e6ae_o2",Tx.presets.test.nonce=2,Tx.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",Tx.presets.test.satoshis=0,t.exports=r.Te(Tx)},function(t,e,n){const Jig=n(5),r=n(3);class Token extends Jig{init(t,e){this.Ja(t);if(!(this.constructor!==Token))throw new Error("Token must be extended");const n=caller===this.constructor,r=caller&&caller.constructor===this.constructor;if(!n&&!r)throw new Error("Must create token using mint()");this.sender=r?caller.owner:null,this.amount=t,e&&(this.owner=e)}static mint(t,e){return this.supply+=t,new this(t,e)}send(t,e=this.amount){if(this.Ja(e),this.amount===e)this.destroy();else{if(!(this.amount>e))throw new Error("Not enough funds");this.amount-=e}return new this.constructor(e,t)}combine(...t){if(!t.length)return this;const e=t.concat(this);if(e.some((t=>t.constructor!==this.constructor)))throw new Error("Cannot combine different token classes");if(e.some((t=>(t=>e.reduce(((e,n)=>n===t?e+1:e),0))(t)>1)))throw new Error("Cannot combine duplicate tokens");return t.forEach((t=>{this.amount+=t.amount,t.destroy()})),this.sender=null,this.Ja(this.amount),this}destroy(){super.destroy(),this.amount=0,this.sender=null}Ja(t){if("number"!=typeof t)throw new Error("amount is not a number");if(!Number.isInteger(t))throw new Error("amount must be an integer");if(t<=0)throw new Error("amount must be positive");if(t>Number.MAX_SAFE_INTEGER)throw new Error("amount too large")}}Token.sealed=!1,Token.decimals=0,Token.icon={emoji:null},Token.symbol=null,Token.supply=0,Token.version="2.0",Token.toString(),Token.presets={},Token.presets.main={},Token.presets.test={},Token.presets.main.location="72a61eb990ffdb6b38e5f955e194fed5ff6b014f75ac6823539ce5613aea0be8_o1",Token.presets.main.origin="72a61eb990ffdb6b38e5f955e194fed5ff6b014f75ac6823539ce5613aea0be8_o1",Token.presets.main.nonce=1,Token.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",Token.presets.main.satoshis=0,Token.presets.test.location="7d14c868fe39439edffe6982b669e7b4d3eb2729eee7c262ec2494ee3e310e99_o1",Token.presets.test.origin="7d14c868fe39439edffe6982b669e7b4d3eb2729eee7c262ec2494ee3e310e99_o1",Token.presets.test.nonce=1,Token.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",Token.presets.test.satoshis=0,t.exports=r.Te(Token)},function(t,e,n){n(41).vt();const r=n(7),o=n(30),{Jr:i}=n(13),{lt:s}=n(0);global.Jig=o.Jig,global.Berry=o.Berry,s(global,"Token",(()=>o.extra.Token)),i(r),t.exports=o},function(t){t.exports=JSON.parse('"!function(t,o){\\"object\\"==typeof exports&&\\"undefined\\"!=typeof module?o(exports):\\"function\\"==typeof define&&define.amd?define([\\"exports\\"],o):o((t=t||self).SES={})}(this,(function(t){\\"use strict\\";function o(t,o){if(!t)throw new TypeError(o)}const{getPrototypeOf:r}=Object;const{getOwnPropertyDescriptor:e,getPrototypeOf:n}=Object;function a(t){return n(t).constructor}const i=[\\"Array\\",\\"ArrayBuffer\\",\\"ArrayBufferPrototype\\",\\"ArrayIteratorPrototype\\",\\"ArrayPrototype\\",\\"AsyncFunction\\",\\"AsyncFunctionPrototype\\",\\"AsyncGenerator\\",\\"AsyncGeneratorFunction\\",\\"AsyncGeneratorPrototype\\",\\"AsyncIteratorPrototype\\",\\"Atomics\\",\\"BigInt\\",\\"BigIntPrototype\\",\\"BigInt64Array\\",\\"BigInt64ArrayPrototype\\",\\"BigUint64Array\\",\\"BigUint64ArrayPrototype\\",\\"Boolean\\",\\"BooleanPrototype\\",\\"DataView\\",\\"DataViewPrototype\\",\\"Date\\",\\"DatePrototype\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Error\\",\\"ErrorPrototype\\",\\"eval\\",\\"EvalError\\",\\"EvalErrorPrototype\\",\\"Float32Array\\",\\"Float32ArrayPrototype\\",\\"Float64Array\\",\\"Float64ArrayPrototype\\",\\"Function\\",\\"FunctionPrototype\\",\\"Generator\\",\\"GeneratorFunction\\",\\"GeneratorPrototype\\",\\"Int8Array\\",\\"Int8ArrayPrototype\\",\\"Int16Array\\",\\"Int16ArrayPrototype\\",\\"Int32Array\\",\\"Int32ArrayPrototype\\",\\"isFinite\\",\\"isNaN\\",\\"IteratorPrototype\\",\\"JSON\\",\\"Map\\",\\"MapIteratorPrototype\\",\\"MapPrototype\\",\\"Math\\",\\"Number\\",\\"NumberPrototype\\",\\"Object\\",\\"ObjectPrototype\\",\\"parseFloat\\",\\"parseInt\\",\\"Promise\\",\\"PromisePrototype\\",\\"Proxy\\",\\"RangeError\\",\\"RangeErrorPrototype\\",\\"ReferenceError\\",\\"ReferenceErrorPrototype\\",\\"Reflect\\",\\"RegExp\\",\\"RegExpPrototype\\",\\"RegExpStringIteratorPrototype\\",\\"Set\\",\\"SetIteratorPrototype\\",\\"SetPrototype\\",\\"SharedArrayBuffer\\",\\"SharedArrayBufferPrototype\\",\\"String\\",\\"StringIteratorPrototype\\",\\"StringPrototype\\",\\"Symbol\\",\\"SymbolPrototype\\",\\"SyntaxError\\",\\"SyntaxErrorPrototype\\",\\"ThrowTypeError\\",\\"TypedArray\\",\\"TypedArrayPrototype\\",\\"TypeError\\",\\"TypeErrorPrototype\\",\\"Uint8Array\\",\\"Uint8ArrayPrototype\\",\\"Uint8ClampedArray\\",\\"Uint8ClampedArrayPrototype\\",\\"Uint16Array\\",\\"Uint16ArrayPrototype\\",\\"Uint32Array\\",\\"Uint32ArrayPrototype\\",\\"URIError\\",\\"URIErrorPrototype\\",\\"WeakMap\\",\\"WeakMapPrototype\\",\\"WeakSet\\",\\"WeakSetPrototype\\",\\"escape\\",\\"unescape\\",\\"FunctionPrototypeConstructor\\",\\"Compartment\\",\\"CompartmentPrototype\\",\\"harden\\"],{getOwnPropertyDescriptor:c}=Object;function p(t,r){const e=c(t,r);return o(!(\\"get\\"in e||\\"set\\"in e),`unexpected accessor on global property: ${r}`),e.value}const{apply:s}=Reflect,y=(t=>(o,...r)=>s(t,o,r))(Object.prototype.hasOwnProperty);function l(){const t={__proto__:null},c=function(){const t=Function.prototype.constructor,o=typeof Symbol&&Symbol.iterator||\\"@@iterator\\",r=typeof Symbol&&Symbol.matchAll||\\"@@matchAll\\",i=e(arguments,\\"callee\\").get,c=(new String)[o](),p=n(c);let s=null,y=null;r in new RegExp&&(s=(new RegExp)[r](),y=n(s));const l=(new Array)[o](),u=n(l),g=n(Float32Array),f=(new Map)[o](),P=n(f),b=(new Set)[o](),m=n(b),d=n(u);function*h(){}const A=a(h),E=A.prototype;async function*S(){}const _=a(S),w=_.prototype,I=w.prototype,F=n(I);async function T(){}const v=a(T),O={FunctionPrototypeConstructor:t,ArrayIteratorPrototype:u,AsyncFunction:v,AsyncGenerator:w,AsyncGeneratorFunction:_,AsyncGeneratorPrototype:I,AsyncIteratorPrototype:F,Generator:E,GeneratorFunction:A,IteratorPrototype:d,MapIteratorPrototype:P,RegExpStringIteratorPrototype:y,SetIteratorPrototype:m,StringIteratorPrototype:p,ThrowTypeError:i,TypedArray:g};return O}();!function(t){const{FunctionPrototypeConstructor:e,ArrayIteratorPrototype:n,AsyncFunction:a,AsyncGenerator:i,AsyncGeneratorFunction:c,AsyncGeneratorPrototype:p,AsyncIteratorPrototype:s,Generator:y,GeneratorFunction:l,IteratorPrototype:u,MapIteratorPrototype:g,RegExpStringIteratorPrototype:f,SetIteratorPrototype:P,StringIteratorPrototype:b,ThrowTypeError:m,TypedArray:d}=t;o(r(m)===Function.prototype,\\"ThrowTypeError.__proto__ should be Function.prototype\\"),o(r(b)===u,\\"StringIteratorPrototype.__proto__ should be IteratorPrototype\\"),f&&o(r(f)===u,\\"RegExpStringIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(d)===Function.prototype,\\"TypedArray.__proto__ should be Function.prototype\\"),o(r(g)===u,\\"MapIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(P)===u,\\"SetIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(u)===Object.prototype,\\"IteratorPrototype.__proto__ should be Object.prototype\\"),o(r(s)===Object.prototype,\\"AsyncIteratorPrototype.__proto__ should be Object.prototype\\"),o(r(n)===u,\\"AsyncIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(l)===e,\\"GeneratorFunction.__proto__ should be Function\\"),o(\\"GeneratorFunction\\"===l.name,\'GeneratorFunction.name should be \\"GeneratorFunction\\"\'),o(r(y)===Function.prototype,\\"Generator.__proto__ should be Function.prototype\\"),o(r(c)===e,\\"AsyncGeneratorFunction.__proto__ should be Function\\"),o(\\"AsyncGeneratorFunction\\"===c.name,\'AsyncGeneratorFunction.name should be \\"AsyncGeneratorFunction\\"\'),o(r(i)===Function.prototype,\\"AsyncGenerator.__proto__ should be Function.prototype\\"),o(r(p)===s,\\"AsyncGeneratorPrototype.__proto__ should be AsyncIteratorPrototype\\"),o(r(a)===e,\\"AsyncFunction.__proto__ should be Function\\"),o(\\"AsyncFunction\\"===a.name,\'AsyncFunction.name should be \\"AsyncFunction\\"\')}(c);for(const o of i){if(y(c,o)){t[o]=c[o];continue}if(y(globalThis,o)){t[o]=p(globalThis,o);continue}if(o.endsWith(\\"Prototype\\")){const r=o.slice(0,-\\"Prototype\\".length);if(y(c,r)){const e=c[r];t[o]=e.prototype;continue}if(y(globalThis,r)){const e=p(globalThis,r);t[o]=e.prototype;continue}}}return function(t){Object.keys(t).forEach(o=>{if(void 0===t[o])throw new TypeError(`Malformed intrinsic: ${o}`)})}(t),t}const u={\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",name:\\"string\\"},g=u,f={get:g,set:\\"undefined\\"};function P(t){return{\\"**proto**\\":\\"Error\\",prototype:t,length:\\"number\\",name:\\"string\\"}}function b(t){return{\\"**proto**\\":\\"ErrorPrototype\\",constructor:t,message:\\"string\\",name:\\"string\\",toString:g}}function m(t){return{\\"**proto**\\":\\"TypedArray\\",length:\\"number\\",name:\\"string\\",BYTES_PER_ELEMENT:\\"number\\",prototype:t}}function d(t){return{\\"**proto**\\":\\"TypedArrayPrototype\\",BYTES_PER_ELEMENT:\\"number\\",constructor:t}}var h=function(t){return(typeof Symbol&&Symbol.matchAll||\\"@@matchAll\\")in new RegExp||delete t.RegExpStringIteratorPrototype,t}({\\"**proto**\\":null,ThrowTypeError:g,Infinity:\\"number\\",NaN:\\"number\\",undefined:\\"undefined\\",eval:g,isFinite:g,isNaN:g,parseFloat:g,parseInt:g,decodeURI:g,decodeURIComponent:g,encodeURI:g,encodeURIComponent:g,Object:{\\"**proto**\\":\\"FunctionPrototype\\",assign:g,create:g,defineProperties:g,defineProperty:g,entries:g,freeze:g,fromEntries:g,getOwnPropertyDescriptor:g,getOwnPropertyDescriptors:g,getOwnPropertyNames:g,getOwnPropertySymbols:g,getPrototypeOf:g,is:g,isExtensible:g,isFrozen:g,isSealed:g,keys:g,preventExtensions:g,prototype:\\"ObjectPrototype\\",seal:g,setPrototypeOf:g,values:g},ObjectPrototype:{\\"**proto**\\":null,constructor:\\"Object\\",hasOwnProperty:g,isPrototypeOf:g,propertyIsEnumerable:g,toLocaleString:g,toString:g,valueOf:g,__defineGetter__:g,__defineSetter__:g,__lookupGetter__:g,__lookupSetter__:g},Function:{\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",prototype:\\"FunctionPrototype\\"},FunctionPrototype:{length:\\"number\\",name:\\"string\\",apply:g,bind:g,call:g,constructor:\\"FunctionPrototypeConstructor\\",toString:g,\\"@@hasInstance\\":g},Boolean:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"BooleanPrototype\\"},BooleanPrototype:{constructor:\\"Boolean\\",toString:g,valueOf:g},Symbol:{\\"**proto**\\":\\"FunctionPrototype\\",asyncIterator:\\"symbol\\",for:g,hasInstance:\\"symbol\\",isConcatSpreadable:\\"symbol\\",iterator:\\"symbol\\",keyFor:g,match:\\"symbol\\",matchAll:\\"symbol\\",prototype:\\"SymbolPrototype\\",replace:\\"symbol\\",search:\\"symbol\\",species:\\"symbol\\",split:\\"symbol\\",toPrimitive:\\"symbol\\",toStringTag:\\"symbol\\",unscopables:\\"symbol\\"},SymbolPrototype:{constructor:\\"Symbol\\",description:f,toString:g,valueOf:g,\\"@@toPrimitive\\":g,\\"@@toStringTag\\":\\"string\\"},Error:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"ErrorPrototype\\",captureStackTrace:g,stackTraceLimit:\\"number\\"},ErrorPrototype:{constructor:\\"Error\\",message:\\"string\\",name:\\"string\\",toString:g},EvalError:P(\\"EvalErrorPrototype\\"),RangeError:P(\\"RangeErrorPrototype\\"),ReferenceError:P(\\"ReferenceErrorPrototype\\"),SyntaxError:P(\\"SyntaxErrorPrototype\\"),TypeError:P(\\"TypeErrorPrototype\\"),URIError:P(\\"URIErrorPrototype\\"),EvalErrorPrototype:b(\\"EvalError\\"),RangeErrorPrototype:b(\\"RangeError\\"),ReferenceErrorPrototype:b(\\"ReferenceError\\"),SyntaxErrorPrototype:b(\\"SyntaxError\\"),TypeErrorPrototype:b(\\"TypeError\\"),URIErrorPrototype:b(\\"URIError\\"),Number:{\\"**proto**\\":\\"FunctionPrototype\\",EPSILON:\\"number\\",isFinite:g,isInteger:g,isNaN:g,isSafeInteger:g,MAX_SAFE_INTEGER:\\"number\\",MAX_VALUE:\\"number\\",MIN_SAFE_INTEGER:\\"number\\",MIN_VALUE:\\"number\\",NaN:\\"number\\",NEGATIVE_INFINITY:\\"number\\",parseFloat:g,parseInt:g,POSITIVE_INFINITY:\\"number\\",prototype:\\"NumberPrototype\\"},NumberPrototype:{constructor:\\"Number\\",toExponential:g,toFixed:g,toLocaleString:g,toPrecision:g,toString:g,valueOf:g},BigInt:{\\"**proto**\\":\\"FunctionPrototype\\",asIntN:g,asUintN:g,prototype:\\"BigIntPrototype\\"},BigIntPrototype:{constructor:\\"BigInt\\",toLocaleString:g,toString:g,valueOf:g,\\"@@toStringTag\\":\\"string\\"},Math:{E:\\"number\\",LN10:\\"number\\",LN2:\\"number\\",LOG10E:\\"number\\",LOG2E:\\"number\\",PI:\\"number\\",SQRT1_2:\\"number\\",SQRT2:\\"number\\",\\"@@toStringTag\\":\\"string\\",abs:g,acos:g,acosh:g,asin:g,asinh:g,atan:g,atanh:g,atan2:g,cbrt:g,ceil:g,clz32:g,cos:g,cosh:g,exp:g,expm1:g,floor:g,fround:g,hypot:g,imul:g,log:g,log1p:g,log10:g,log2:g,max:g,min:g,pow:g,random:g,round:g,sign:g,sin:g,sinh:g,sqrt:g,tan:g,tanh:g,trunc:g},Date:{\\"**proto**\\":\\"FunctionPrototype\\",now:g,parse:g,prototype:\\"DatePrototype\\",UTC:g},DatePrototype:{constructor:\\"Date\\",getDate:g,getDay:g,getFullYear:g,getHours:g,getMilliseconds:g,getMinutes:g,getMonth:g,getSeconds:g,getTime:g,getTimezoneOffset:g,getUTCDate:g,getUTCDay:g,getUTCFullYear:g,getUTCHours:g,getUTCMilliseconds:g,getUTCMinutes:g,getUTCMonth:g,getUTCSeconds:g,setDate:g,setFullYear:g,setHours:g,setMilliseconds:g,setMinutes:g,setMonth:g,setSeconds:g,setTime:g,setUTCDate:g,setUTCFullYear:g,setUTCHours:g,setUTCMilliseconds:g,setUTCMinutes:g,setUTCMonth:g,setUTCSeconds:g,toDateString:g,toISOString:g,toJSON:g,toLocaleDateString:g,toLocaleString:g,toLocaleTimeString:g,toString:g,toTimeString:g,toUTCString:g,valueOf:g,\\"@@toPrimitive\\":g,getYear:g,setYear:g,toGMTString:g},String:{\\"**proto**\\":\\"FunctionPrototype\\",fromCharCode:g,fromCodePoint:g,prototype:\\"StringPrototype\\",raw:g},StringPrototype:{length:\\"number\\",charAt:g,charCodeAt:g,codePointAt:g,concat:g,constructor:\\"String\\",endsWith:g,includes:g,indexOf:g,lastIndexOf:g,localeCompare:g,match:g,matchAll:g,normalize:g,padEnd:g,padStart:g,repeat:g,replace:g,search:g,slice:g,split:g,startsWith:g,substring:g,toLocaleLowerCase:g,toLocaleUpperCase:g,toLowerCase:g,toString:g,toUpperCase:g,trim:g,trimEnd:g,trimStart:g,valueOf:g,\\"@@iterator\\":g,substr:g,anchor:g,big:g,blink:g,bold:g,fixed:g,fontcolor:g,fontsize:g,italics:g,link:g,small:g,strike:g,sub:g,sup:g,trimLeft:g,trimRight:g},StringIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},RegExp:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"RegExpPrototype\\",\\"@@species\\":f},RegExpPrototype:{constructor:\\"RegExp\\",exec:g,dotAll:f,flags:f,global:f,ignoreCase:f,\\"@@match\\":g,\\"@@matchAll\\":g,multiline:f,\\"@@replace\\":g,\\"@@search\\":g,source:f,\\"@@split\\":g,sticky:f,test:g,toString:g,unicode:f,compile:!1},RegExpStringIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},Array:{\\"**proto**\\":\\"FunctionPrototype\\",from:g,isArray:g,of:g,prototype:\\"ArrayPrototype\\",\\"@@species\\":f},ArrayPrototype:{length:\\"number\\",concat:g,constructor:\\"Array\\",copyWithin:g,entries:g,every:g,fill:g,filter:g,find:g,findIndex:g,flat:g,flatMap:g,forEach:g,includes:g,indexOf:g,join:g,keys:g,lastIndexOf:g,map:g,pop:g,push:g,reduce:g,reduceRight:g,reverse:g,shift:g,slice:g,some:g,sort:g,splice:g,toLocaleString:g,toString:g,unshift:g,values:g,\\"@@iterator\\":g,\\"@@unscopables\\":{\\"**proto**\\":null,copyWithin:\\"boolean\\",entries:\\"boolean\\",fill:\\"boolean\\",find:\\"boolean\\",findIndex:\\"boolean\\",flat:\\"boolean\\",flatMap:\\"boolean\\",includes:\\"boolean\\",keys:\\"boolean\\",values:\\"boolean\\"}},ArrayIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},TypedArray:{\\"**proto**\\":\\"FunctionPrototype\\",from:g,of:g,prototype:\\"TypedArrayPrototype\\",\\"@@species\\":f},TypedArrayPrototype:{buffer:f,byteLength:f,byteOffset:f,constructor:\\"TypedArray\\",copyWithin:g,entries:g,every:g,fill:g,filter:g,find:g,findIndex:g,forEach:g,includes:g,indexOf:g,join:g,keys:g,lastIndexOf:g,length:f,map:g,reduce:g,reduceRight:g,reverse:g,set:g,slice:g,some:g,sort:g,subarray:g,toLocaleString:g,toString:g,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":f},BigInt64Array:m(\\"BigInt64ArrayPrototype\\"),BigUint64Array:m(\\"BigUint64ArrayPrototype\\"),Float32Array:m(\\"Float32ArrayPrototype\\"),Float64Array:m(\\"Float64ArrayPrototype\\"),Int16Array:m(\\"Int16ArrayPrototype\\"),Int32Array:m(\\"Int32ArrayPrototype\\"),Int8Array:m(\\"Int8ArrayPrototype\\"),Uint16Array:m(\\"Uint16ArrayPrototype\\"),Uint32Array:m(\\"Uint32ArrayPrototype\\"),Uint8Array:m(\\"Uint8ArrayPrototype\\"),Uint8ClampedArray:m(\\"Uint8ClampedArrayPrototype\\"),BigInt64ArrayPrototype:d(\\"BigInt64Array\\"),BigUint64ArrayPrototype:d(\\"BigUint64Array\\"),Float32ArrayPrototype:d(\\"Float32Array\\"),Float64ArrayPrototype:d(\\"Float64Array\\"),Int16ArrayPrototype:d(\\"Int16Array\\"),Int32ArrayPrototype:d(\\"Int32Array\\"),Int8ArrayPrototype:d(\\"Int8Array\\"),Uint16ArrayPrototype:d(\\"Uint16Array\\"),Uint32ArrayPrototype:d(\\"Uint32Array\\"),Uint8ArrayPrototype:d(\\"Uint8Array\\"),Uint8ClampedArrayPrototype:d(\\"Uint8ClampedArray\\"),Map:{\\"**proto**\\":\\"FunctionPrototype\\",\\"@@species\\":f,prototype:\\"MapPrototype\\"},MapPrototype:{clear:g,constructor:\\"Map\\",delete:g,entries:g,forEach:g,get:g,has:g,keys:g,set:g,size:f,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":\\"string\\"},MapIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},Set:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"SetPrototype\\",\\"@@species\\":f},SetPrototype:{add:g,clear:g,constructor:\\"Set\\",delete:g,entries:g,forEach:g,has:g,keys:g,size:f,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":\\"string\\"},SetIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},WeakMap:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"WeakMapPrototype\\"},WeakMapPrototype:{constructor:\\"WeakMap\\",delete:g,get:g,has:g,set:g,\\"@@toStringTag\\":\\"string\\"},WeakSet:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"WeakSetPrototype\\"},WeakSetPrototype:{add:g,constructor:\\"WeakSet\\",delete:g,has:g,\\"@@toStringTag\\":\\"string\\"},ArrayBuffer:{\\"**proto**\\":\\"FunctionPrototype\\",isView:g,prototype:\\"ArrayBufferPrototype\\",\\"@@species\\":f},ArrayBufferPrototype:{byteLength:f,constructor:\\"ArrayBuffer\\",slice:g,\\"@@toStringTag\\":\\"string\\"},SharedArrayBuffer:!1,DataView:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"DataViewPrototype\\"},DataViewPrototype:{buffer:f,byteLength:f,byteOffset:f,constructor:\\"DataView\\",getBigInt64:g,getBigUint64:g,getFloat32:g,getFloat64:g,getInt8:g,getInt16:g,getInt32:g,getUint8:g,getUint16:g,getUint32:g,setBigInt64:g,setBigUint64:g,setFloat32:g,setFloat64:g,setInt8:g,setInt16:g,setInt32:g,setUint8:g,setUint16:g,setUint32:g,\\"@@toStringTag\\":\\"string\\"},Atomics:!1,JSON:{parse:g,stringify:g,\\"@@toStringTag\\":\\"string\\"},IteratorPrototype:{\\"@@iterator\\":g},AsyncIteratorPrototype:{\\"@@asyncIterator\\":g},GeneratorFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"Generator\\"},Generator:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"GeneratorFunction\\",prototype:\\"GeneratorPrototype\\"},AsyncGeneratorFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"AsyncGenerator\\"},AsyncGenerator:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"AsyncGeneratorFunction\\",prototype:\\"AsyncGeneratorPrototype\\",\\"@@toStringTag\\":\\"string\\"},GeneratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",constructor:\\"Generator\\",next:g,return:g,throw:g,\\"@@toStringTag\\":\\"string\\"},AsyncGeneratorPrototype:{\\"**proto**\\":\\"AsyncIteratorPrototype\\",constructor:\\"AsyncGenerator\\",next:g,return:g,throw:g,\\"@@toStringTag\\":\\"string\\"},Promise:{\\"**proto**\\":\\"FunctionPrototype\\",all:g,allSettled:g,prototype:\\"PromisePrototype\\",race:g,reject:g,resolve:g,\\"@@species\\":f},PromisePrototype:{catch:g,constructor:\\"Promise\\",finally:g,then:g,\\"@@toStringTag\\":\\"string\\"},AsyncFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"AsyncFunctionPrototype\\"},AsyncFunctionPrototype:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"AsyncFunction\\",\\"@@toStringTag\\":\\"string\\"},Reflect:{apply:g,construct:g,defineProperty:g,deleteProperty:g,get:g,getOwnPropertyDescriptor:g,getPrototypeOf:g,has:g,isExtensible:g,ownKeys:g,preventExtensions:g,set:g,setPrototypeOf:g},Proxy:{\\"**proto**\\":\\"FunctionPrototype\\",revocable:g},escape:g,unescape:g,FunctionPrototypeConstructor:{\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",prototype:\\"FunctionPrototype\\"},Compartment:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"CompartmentPrototype\\"},CompartmentPrototype:{constructor:\\"Compartment\\",evaluate:g,global:f},harden:g});const{getPrototypeOf:A,getOwnPropertyDescriptor:E}=Object,{apply:S,ownKeys:_}=Reflect,w=(t=>(o,...r)=>S(t,o,r))(Object.prototype.hasOwnProperty);function I(t,o){if(\\"string\\"==typeof o)return o;if(\\"symbol\\"==typeof o)return`@@${o.toString().slice(14,-1)}`;throw new TypeError(`Unexpected property name type ${t} ${o}`)}function F(t){const o=[\\"undefined\\",\\"boolean\\",\\"number\\",\\"string\\",\\"symbol\\"];function r(r,e,n,i){if(\\"object\\"==typeof i)return a(r,e,i),!0;if(!1===i)return!1;if(\\"string\\"==typeof i)if(\\"prototype\\"===n||\\"constructor\\"===n){if(w(t,i))return e===t[i]}else if(o.includes(i))return typeof e===i;throw new TypeError(`Unexpected whitelist permit ${r}`)}function e(t,o,e,n){const a=E(o,e);return w(a,\\"value\\")?r(t,a.value,e,n):r(`${t}<get>`,a.get,e,n.get)&&r(`${t}<set>`,a.set,e,n.set)}function n(t,o){return w(t,o)?t[o]:\\"FunctionPrototype\\"===t[\\"**proto**\\"]&&w(u,o)?u[o]:void 0}function a(o,r,a){!function(o,r,e){const n=A(r);if(null!==n||null!==e){if(void 0!==e&&\\"string\\"!=typeof e)throw new TypeError(`Malformed whitelist permit ${o}.__proto__`);if(n!==t[e||\\"ObjectPrototype\\"])throw new Error(`Unexpected intrinsic ${o}.__proto__`)}}(o,r,a[\\"**proto**\\"]);for(const t of _(r)){if(\\"__proto__\\"===t)continue;const i=I(o,t),c=`${o}.${i}`,p=n(a,i);if(!p||!e(c,r,t,p))try{delete r[t]}catch(t){}}}a(\\"intrinsics\\",t,h)}const{defineProperties:T,getOwnPropertyDescriptors:v}=Object;const{getOwnPropertyDescriptor:O}=Object;const{defineProperties:U,getOwnPropertyDescriptors:x,getOwnPropertyDescriptor:R}=Object;const C=!0;var M={ObjectPrototype:\\"*\\",ArrayPrototype:\\"*\\",FunctionPrototype:{constructor:C,bind:C,name:C,toString:C},ErrorPrototype:{constructor:C,message:C,name:C},PromisePrototype:{constructor:C},TypedArrayPrototype:\\"*\\",Generator:{constructor:C,name:C,toString:C},IteratorPrototype:\\"*\\"};const{defineProperties:j,getOwnPropertyNames:G,getOwnPropertyDescriptor:k,getOwnPropertyDescriptors:N}=Object,{ownKeys:$}=Reflect;function D(t){return null!==t&&\\"object\\"==typeof t}const{assign:B,freeze:L,defineProperties:W,getOwnPropertyDescriptor:V,getOwnPropertyNames:z,getPrototypeOf:Y,setPrototypeOf:J,prototype:H}=Object,{apply:K,get:Q,set:X}=Reflect,{isArray:q,prototype:Z}=Array,{revocable:tt}=Proxy,{prototype:ot}=RegExp,{prototype:rt}=String,{prototype:et}=WeakMap,nt=t=>(o,...r)=>K(t,o,r),at=nt(H.hasOwnProperty),it=(nt(Z.filter),nt(Z.join)),ct=(nt(Z.push),nt(Z.pop)),pt=nt(Z.includes),st=nt(ot.test),yt=(nt(rt.match),nt(rt.search)),lt=nt(rt.slice),ut=nt(rt.split),gt=(nt(et.get),nt(et.set),nt(et.has),t=>Q(Y(t),\\"constructor\\")),ft=L({__proto__:null});function Pt(t,o){const r=`please report internal shim error: ${t}`;throw console.error(r),o&&(console.error(`${o}`),console.error(`${o.stack}`)),TypeError(r)}function bt(t,o){t||Pt(o)}const mt=[\\"await\\",\\"break\\",\\"case\\",\\"catch\\",\\"class\\",\\"const\\",\\"continue\\",\\"debugger\\",\\"default\\",\\"delete\\",\\"do\\",\\"else\\",\\"export\\",\\"extends\\",\\"finally\\",\\"for\\",\\"function\\",\\"if\\",\\"import\\",\\"in\\",\\"instanceof\\",\\"new\\",\\"return\\",\\"super\\",\\"switch\\",\\"this\\",\\"throw\\",\\"try\\",\\"typeof\\",\\"var\\",\\"void\\",\\"while\\",\\"with\\",\\"yield\\",\\"let\\",\\"static\\",\\"enum\\",\\"implements\\",\\"package\\",\\"protected\\",\\"interface\\",\\"private\\",\\"public\\",\\"await\\",\\"null\\",\\"true\\",\\"false\\",\\"this\\",\\"arguments\\"],dt=new RegExp(\\"^[a-zA-Z_$][\\\\\\\\w$]*$\\");function ht(t){return\\"eval\\"!==t&&!pt(mt,t)&&st(dt,t)}function At(t,o){const r=V(t,o);return(!1===r.configurable&&!1===r.writable&&at(r,\\"value\\"))}const Et=new Proxy(ft,{get(t,o){Pt(`unexpected scope handler trap called: ${String(o)}`)}});function St(t,o){const r=yt(t,o);return r<0?-1:ut(lt(t,0,r),\\"\\\\n\\").length}const _t=new RegExp(\\"(?:\\\\x3c!--|--\\\\x3e)\\");const wt=new RegExp(\\"\\\\\\\\bimport\\\\\\\\s*(?:\\\\\\\\(|/[/*])\\");const It=new RegExp(\\"\\\\\\\\beval\\\\\\\\s*(?:\\\\\\\\(|/[/*])\\");const Ft={rewrite:t=>(function(t){const o=St(t,_t);if(o<0)return t;throw new SyntaxError(`possible html comment syntax rejected around line ${o}`)}(t.src),function(t){const o=St(t,wt);if(o<0)return t;throw new SyntaxError(`possible import expression rejected around line ${o}`)}(t.src),function(t){const o=St(t,It);if(o<0)return t;throw new SyntaxError(`possible direct eval expression rejected around line ${o}`)}(t.src),t)};function Tt(t,o=[]){const r=function(t){return 0===t.length?\\"\\":`const {${it(t,\\",\\")}} = this;`}(o);return t.intrinsics.Function(`\\\\n    with (this) {\\\\n      ${r}\\\\n      return function() {\\\\n        \'use strict\';\\\\n        return eval(arguments[0]);\\\\n      };\\\\n    }\\\\n  `)}function vt(t,o,r,e={},{localTransforms:n=[],globalTransforms:a=[],sloppyGlobalsMode:i=!1}={}){let c={src:o,endowments:e};c=function(t,o){for(const r of o)\\"function\\"==typeof r.rewrite&&(t=r.rewrite(t));return t}(c,[...n,...a,Ft]);const p=function(t,o,r={},{sloppyGlobalsMode:e=!1}={}){return{__proto__:Et,useUnsafeEvaluator:!1,get(e,n){if(\\"symbol\\"!=typeof n)return\\"eval\\"===n&&!0===this.useUnsafeEvaluator?(this.useUnsafeEvaluator=!1,t.intrinsics.eval):n in r?Q(r,n,o):Q(o,n)},set(t,e,n){if(e in r){return\\"value\\"in V(r,e)?X(r,e,n):X(r,e,n,o)}return X(o,e,n)},has:(t,n)=>!!(e||\\"eval\\"===n||n in r||n in o||n in globalThis),getPrototypeOf:()=>null}}(t,r,c.endowments,{sloppyGlobalsMode:i}),s=tt(ft,p),y=Tt(t,function(t,o={}){const r=z(t),e=z(o),n=e.filter(t=>ht(t)&&At(o,t));return[...r.filter(o=>!e.includes(o)&&ht(o)&&At(t,o)),...n]}(r,c.endowments)),l=K(y,s.proxy,[]);let u;p.useUnsafeEvaluator=!0;try{return K(l,r,[c.src])}catch(t){throw u=t,t}finally{!0===p.useUnsafeEvaluator&&(Pt(\\"handler did not revoke useUnsafeEvaluator\\",u),s.revoke())}}const Ot=(t,o,r={})=>{const e=e=>\\"string\\"!=typeof e?e:vt(t,e,o,{},r);return W(e,{toString:{value:()=>\\"function eval() { [native code] }\\",writable:!1,enumerable:!1,configurable:!0}}),bt(gt(e)!==Function,\\"eval constructor is Function\\"),bt(gt(e)!==t.intrinsics.Function,\\"eval contructions is %Function%\\"),e};function Ut(t,o,r={}){const e=function(e){const n=`${ct(arguments)||\\"\\"}`,a=`${it(arguments,\\",\\")}`;new t.intrinsics.Function(a,n);const i=`(function anonymous(${a}\\\\n) {\\\\n${n}\\\\n})`;return vt(t,i,o,{},r)};return W(e,{prototype:{value:t.intrinsics.Function.prototype,writable:!1,enumerable:!1,configurable:!1},toString:{value:()=>\\"function Function() { [native code] }\\",writable:!1,enumerable:!1,configurable:!0}}),bt(Y(Function)===Function.prototype),bt(Y(e)===Function.prototype),bt(gt(e)!==Function),bt(gt(e)!==t.intrinsics.Function),e}const xt=[\\"eval\\",\\"isFinite\\",\\"isNaN\\",\\"parseFloat\\",\\"parseInt\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Array\\",\\"ArrayBuffer\\",\\"Boolean\\",\\"DataView\\",\\"Date\\",\\"Error\\",\\"EvalError\\",\\"Float32Array\\",\\"Float64Array\\",\\"Function\\",\\"Int8Array\\",\\"Int16Array\\",\\"Int32Array\\",\\"Map\\",\\"Number\\",\\"Object\\",\\"Promise\\",\\"Proxy\\",\\"RangeError\\",\\"ReferenceError\\",\\"RegExp\\",\\"Set\\",\\"String\\",\\"Symbol\\",\\"SyntaxError\\",\\"TypeError\\",\\"Uint8Array\\",\\"Uint8ClampedArray\\",\\"Uint16Array\\",\\"Uint32Array\\",\\"URIError\\",\\"WeakMap\\",\\"WeakSet\\",\\"JSON\\",\\"Math\\",\\"Reflect\\",\\"escape\\",\\"unescape\\",\\"globalThis\\",\\"Compartment\\",\\"harden\\"];const{getOwnPropertyDescriptor:Rt}=Object,Ct=[\\"eval\\",\\"isFinite\\",\\"isNaN\\",\\"parseFloat\\",\\"parseInt\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Array\\",\\"ArrayBuffer\\",\\"Boolean\\",\\"DataView\\",\\"Date\\",\\"Error\\",\\"EvalError\\",\\"Float32Array\\",\\"Float64Array\\",\\"Function\\",\\"Int8Array\\",\\"Int16Array\\",\\"Int32Array\\",\\"Map\\",\\"Number\\",\\"Object\\",\\"Promise\\",\\"Proxy\\",\\"RangeError\\",\\"ReferenceError\\",\\"RegExp\\",\\"Set\\",\\"String\\",\\"Symbol\\",\\"SyntaxError\\",\\"TypeError\\",\\"Uint8Array\\",\\"Uint8ClampedArray\\",\\"Uint16Array\\",\\"Uint32Array\\",\\"URIError\\",\\"WeakMap\\",\\"WeakSet\\",\\"JSON\\",\\"Math\\",\\"Reflect\\",\\"escape\\",\\"unescape\\",\\"globalThis\\",\\"Compartment\\",\\"harden\\"];let Mt;function jt(){if(Mt)return Mt;const t=function(){const t={__proto__:null};for(const o of Ct){const r=Rt(globalThis,o);if(r){if(\\"get\\"in r||\\"set\\"in r)throw new TypeError(`Unexpected accessor on global property: ${o}`);t[o]=r.value}}return t}();return Mt={__proto__:null,intrinsics:t},L(Mt)}const Gt=new WeakMap;class kt{constructor(t,o,r={}){const{transforms:e=[]}=r,n=[...e],a=function(t,{globalTransforms:o}){const r={},e={Infinity:{value:1/0,enumerable:!1},NaN:{value:NaN,enumerable:!1},undefined:{value:void 0,enumerable:!1}};for(const n of xt){if(!at(t.intrinsics,n))continue;let a;switch(n){case\\"eval\\":a=Ot(t,r,{globalTransforms:o});break;case\\"Function\\":a=Ut(t,r,{globalTransforms:o});break;case\\"globalThis\\":a=r;break;default:a=t.intrinsics[n]}e[n]={value:a,configurable:!0,writable:!0,enumerable:!1}}return W(r,e),bt(r.eval!==t.intrinsics.eval,\\"eval on global object\\"),bt(r.Function!==t.intrinsics.Function,\\"Function on global object\\"),r}(jt(),{globalTransforms:n});B(a,t),Gt.set(this,{globalTransforms:n,globalObject:a})}get global(){return Gt.get(this).globalObject}evaluate(t,o={}){if(\\"string\\"!=typeof t)throw new TypeError(\\"first argument of evaluate() must be a string\\");const{endowments:r={},transforms:e=[],sloppyGlobalsMode:n=!1}=o,a=[...e],{globalTransforms:i,globalObject:c}=Gt.get(this);return vt(jt(),t,c,r,{globalTransforms:i,localTransforms:a,sloppyGlobalsMode:n})}toString(){return\\"[object Compartment]\\"}static toString(){return\\"function Compartment() { [shim code] }\\"}}let Nt;function $t(t,o){if(!t)throw new TypeError(o)}\\"object\\"!=typeof globalThis&&(Object.prototype.__defineGetter__(\\"__magic__\\",(function(){return this})),__magic__.globalThis=__magic__,delete Object.prototype.__magic__),t.lockdown=function(t={}){const{noTameDate:o=!1,noTameError:r=!1,noTameMath:e=!1,noTameRegExp:n=!1,registerOnly:a=!1,...i}=t,c=Object.keys(i);$t(0===c.length,`lockdown(): non supported option ${c.join(\\", \\")}`);const p={noTameDate:o,noTameError:r,noTameMath:e,noTameRegExp:n,registerOnly:a};if(Nt)return Object.keys(p).forEach(t=>{$t(p[t]===Nt[t],`lockdown(): cannot re-invoke with different option ${t}`)}),!1;Nt=p,function(){try{(0,Function.prototype.constructor)(\\"return 1\\")}catch(t){return}const{defineProperties:t,getPrototypeOf:o,setPrototypeOf:r}=Object;function e(e,n){let a;try{a=(0,eval)(n)}catch(t){if(t instanceof SyntaxError)return;throw t}const i=o(a),c=function(){throw new TypeError(\\"Not available\\")};t(c,{name:{value:e,writable:!1,enumerable:!1,configurable:!0},toString:{value:()=>`function ${e}() { [native code] }`,writable:!1,enumerable:!1,configurable:!0}}),t(i,{constructor:{value:c}}),t(c,{prototype:{value:i}}),c!==Function.prototype.constructor&&r(c,Function.prototype.constructor)}e(\\"Function\\",\\"(function(){})\\"),e(\\"GeneratorFunction\\",\\"(function*(){})\\"),e(\\"AsyncFunction\\",\\"(async function(){})\\"),e(\\"AsyncGeneratorFunction\\",\\"(async function*(){})\\")}(),o||function(){const t={now:()=>NaN};Date.now=t.now;const o={toLocaleString:()=>NaN};Date.prototype.toLocaleString=o.toLocaleString;const r=Date,e=function(){return void 0===new.target?\\"Invalid Date\\":arguments.length>0?Reflect.construct(r,arguments,new.target):Reflect.construct(r,[NaN],new.target)},n=v(r);T(e,n);const a=v(r.prototype);a.constructor.value=e,T(e.prototype,a),globalThis.Date=e;const i={toLocaleString(){throw new TypeError(\\"Object.prototype.toLocaleString is disabled\\")}};Object.prototype.toLocaleString=i.toLocaleString}(),r||function(){if(delete Error.captureStackTrace,O(Error,\\"captureStackTrace\\"))throw Error(\\"Cannot remove Error.captureStackTrace\\");if(delete Error.stackTraceLimit,O(Error,\\"stackTraceLimit\\"))throw Error(\\"Cannot remove Error.stackTraceLimit\\")}(),e||function(){const t={random(){throw TypeError(\\"Math.random() is disabled\\")}};Math.random=t.random}(),n||function(){delete RegExp.prototype.compile;const t=RegExp,o=function(){return Reflect.construct(t,arguments,new.target)},r=R(t,Symbol.species);U(o,Symbol.species,r);const e=x(t.prototype);e.constructor.value=o,U(o.prototype,e),globalThis.RegExp=o}();const s=function(t,o={}){const{freeze:r,getOwnPropertyDescriptors:e,getPrototypeOf:n}=Object,{ownKeys:a}=Reflect;let{fringeSet:i}=o;if(i){if(\\"function\\"!=typeof i.add||\\"function\\"!=typeof i.has)throw new TypeError(\\"options.fringeSet must have add() and has() methods\\");if(t)for(const o of t)i.add(o)}else i=new WeakSet(t);const c=o&&o.naivePrepareObject,{harden:p}={harden(t){const o=new Set,p=new Map,s=new WeakMap;function y(t,r){if(Object(t)!==t)return;const e=typeof t;if(\\"object\\"!==e&&\\"function\\"!==e)throw new TypeError(`Unexpected typeof: ${e}`);i.has(t)||o.has(t)||(o.add(t),s.set(t,r))}function l(t){c&&c(t),r(t);const o=n(t),i=e(t),l=s.get(t)||\\"unknown\\";null===o||p.has(o)||(p.set(o,l),s.set(o,`${l}.__proto__`)),a(i).forEach(t=>{const o=`${l}.${String(t)}`,r=i[t];\\"value\\"in r?y(r.value,`${o}`):(y(r.get,`${o}(get)`),y(r.set,`${o}(set)`))})}return y(t),o.forEach(l),p.forEach((t,r)=>{if(!o.has(r)&&!i.has(r)){let o;try{o=`prototype ${r} of ${t} is not already in the fringeSet`}catch(e){o=\\"a prototype of something is not already in the fringeset (and .toString failed)\\";try{console.log(o),console.log(\\"the prototype:\\",r),console.log(\\"of something:\\",t)}catch(t){}}throw new TypeError(o)}}),o.forEach(i.add,i),t}};return p}();Object.defineProperties(globalThis,{harden:{value:s,configurable:!0,writable:!0,enumerable:!1},Compartment:{value:kt,configurable:!0,writable:!0,enumerable:!1}});const y=l();F(y),function(){try{(0,Object.prototype.__lookupGetter__)(\\"x\\")}catch(t){return}const{defineProperty:t,defineProperties:o,getOwnPropertyDescriptor:r,getPrototypeOf:e,prototype:n}=Object;function a(t){if(null==t)throw new TypeError(\\"can\'t convert undefined or null to object\\");return Object(t)}function i(t){return\\"symbol\\"==typeof t?t:`${t}`}function c(t,o){if(\\"function\\"!=typeof t)throw TypeError(`invalid ${o} usage`);return t}o(n,{__defineGetter__:{value:function(o,r){const e=a(this);t(e,o,{get:c(r,\\"getter\\"),enumerable:!0,configurable:!0})}},__defineSetter__:{value:function(o,r){const e=a(this);t(e,o,{set:c(r,\\"setter\\"),enumerable:!0,configurable:!0})}},__lookupGetter__:{value:function(t){let o,n=a(this);for(t=i(t);n&&!(o=r(n,t));)n=e(n);return o&&o.get}},__lookupSetter__:{value:function(t){let o,n=a(this);for(t=i(t);n&&!(o=r(n,t));)n=e(n);return o&&o.set}}})}();const u=function(t){const o={};function r(t,r,e,n){if(\\"value\\"in n&&n.configurable){const{value:a}=n;o[t]=a,j(r,{[e]:{get:function(){return a},set:function(o){if(r===this)throw new TypeError(`Cannot assign to read only property \'${e}\' of \'${t}\'`);hasOwnProperty.call(this,e)?this[e]=o:j(this,{[e]:{value:o,writable:!0,enumerable:n.enumerable,configurable:n.configurable}})},enumerable:n.enumerable,configurable:n.configurable}})}}function e(t,o,e){const n=k(o,e);n&&r(t,o,e,n)}function n(t,o){const e=N(o);e&&$(e).forEach(n=>r(t,o,n,e[n]))}return function t(o,r,a){for(const i of G(a)){const c=k(r,i);if(!c||c.get||c.set)continue;const p=`${o}.${i}`,s=a[i];if(!0===s)e(p,r,i);else if(\\"*\\"===s)n(p,c.value);else{if(!D(s))throw new TypeError(`Unexpected override enablement plan ${p}`);t(p,c.value,s)}}}(\\"root\\",t,M),o}(y);return s(y,a),s(u,a),!0},Object.defineProperty(t,\\"__esModule\\",{value:!0})}));\\n"')},function(t,e){t.exports=require("vm")},function(t,e,n){const r=n(2),o=n(26),i=n(8),{B:s,ut:c,Y:a,W:h}=n(0),u=n(20);t.exports=function(t,e,f){switch(r.Dt&&r.Ft("Execute","Executing",t,JSON.stringify(e)),t){case"DEPLOY":return function(t,e){const r=n(3),a=n(22);s(t instanceof Array,"DEPLOY data must be an array"),s(t.length%2==0,"Invalid DEPLOY data length");const h=t.length/2,f=[];for(let t=0;t<h;t++)f.push(r.zt());const l={_:i._,wc:t=>{const n=e[t]||f[t-e.length];if(!n)throw new Error(`Invalid local jig reference: ${t}`);return n}},d=o.dc(t,l);for(let t=0;t<h;t++){const e=d[2*t+0],n=d[2*t+1];s("string"==typeof e,"DEPLOY src must be a string"),s("object"==typeof n&&!Array.isArray(n)&&n,"DEPLOY props must be an object"),a.vt(e);const[o]=i.Tn(e,n.deps);s("function"==typeof o,`DEPLOY src not supported: ${e}`),Object.keys(n).forEach((t=>{c(o,t,n[t])}));const h=f[t],u=!1,[l]=r.hn(h,o,u);r.Tt(h).Ee(l,u,[],e)}u.Be(f)}(e,f);case"UPGRADE":return function(t,e){const Code=n(1),r=n(3),a=n(22),h={_:i._,wc:t=>e[t]},u=o.dc(t,h);s(Array.isArray(u),"UPGRADE data must be an array"),s(3===u.length,"Invalid UPGRADE data length"),s(u[0]instanceof Code,"Must only upgrade code"),s("string"==typeof u[1],"UPGRADE src must be a string"),s("object"==typeof u[2]&&!Array.isArray(u[2])&&u[2],"UPGRADE props must be an object");const[f,l,d]=u;a.vt(l);const[p]=i.Tn(l,d.deps);Object.keys(d).forEach((t=>{c(p,t,d[t])}));const[w]=r.hn(f,p),y=!1;r.Lt(f,w,y,l)}(e,f);case"CALL":return function(t,e){const Code=n(1),Jig=n(5),r={_:i._,wc:t=>e[t]},c=o.dc(t,r);s(3===c.length,"Invalid CALL data length"),s(c[0]instanceof Code&&(h(c[0],Jig)||"auth"===c[1]||"destroy"===c[1])||c[0]instanceof Jig,"Must only execute CALL on jigs or code"),s("string"==typeof c[1],"CALL method must be a string: "+c[1]),s(Array.isArray(c[2]),"CALL args must be an array"),s(c[0]instanceof Jig||"upgrade"!==c[1],"Cannot execute upgrade() with CALL");const[u,f,l]=c;if("function"!=typeof u[f])throw new Error(`Cannot call ${a(u)}.${f}()`);u[f](...l)}(e,f);case"NEW":return function(t,e){const Code=n(1),Jig=n(5),r={_:i._,wc:t=>e[t]},c=o.dc(t,r);s(2===c.length,"Invalid NEW data length"),s(c[0]instanceof Code,"Must only execute NEW on code"),s(h(c[0],Jig),"Must only execute NEW on a jig class"),s(Array.isArray(c[1]),"NEW args must be an array");const[a,u]=c;new a(...u)}(e,f);default:throw new Error(`Unknown op: ${t}`)}}},function(t,e){t.exports=require("http")},function(t,e){t.exports=require("https")},function(t,e){t.exports=require("zlib")},function(t,e,n){t.exports=null},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("path")},function(t,e,n){t.exports=null},function(t,e,n){const r=n(2),{he:o}=n(10),{Y:i,bt:s}=n(0),{g:c}=n(6),{TimeoutError}=n(11),{So:a}=n(18),LocalOwner=n(53),h="Inventory";t.exports=class{constructor(){this.Gc=(t,e)=>this.Wa(e),this.zs=[]}attach(t){this.detach(),r.Dt&&r.Ft(h,"Attach"),this.Ya=t,t.on("update",this.Gc),t.on("publish",this.Gc),t.on("sync",this.Gc),this.Ka=null,this.Ds=[],t.owner instanceof LocalOwner&&(this.Ka=o(t.owner.address))}detach(t){this.Ya&&(r.Dt&&r.Ft(h,"Detach"),this.Ya.off("update",this.Gc),this.Ya.off("publish",this.Gc),this.Ya.off("sync",this.Gc),this.Ya=null,this.Ka=null,this.Ds=null)}get jigs(){this.za();const Jig=n(5);return this.zs.filter((t=>t instanceof Jig))}get code(){this.za();const Code=n(1);return this.zs.filter((t=>t instanceof Code))}async sync(){if(r.te&&r.qt(h,"Sync"),!this.Ka)try{if(!this.Ya||!this.Ya.qn.he.nextOwner)throw new Error("Inventory cannot determine owner");const t=await this.Ya.qn.he.nextOwner();this.Ka=o(t),r.Dt&&r.Ft(h,"Owner",t),this.Ds&&this.Ds.forEach((t=>this.Wa(t)))}finally{this.Ds=null}if(this.Ka)return this.It||(this.It=this.Va().then((()=>{this.It=null})).catch((t=>{throw this.It=null,t}))),this.It}async Va(){let t;if("function"==typeof this.Ya.state.locations){const e=this.Ka.script();t=await this.Ya.state.locations(e)}else{const e=this.Ka.script();t=(await this.Ya.blockchain.utxos(e)).map((t=>`${t.txid}_o${t.vout}`))}const e=c((()=>this.zs.map((t=>t.location)))),o=n(15),i=new o.yo,u=new s("inventory sync",this.Ya.qn.Et);for(const n of t){if(e.includes(n))continue;let t=null;try{t=await o(n,void 0,this.Ya.qn,i,u)}catch(t){if(t instanceof TimeoutError)throw t;if(t instanceof a)throw t;r.ee&&r.Xt(h,`Failed to load ${n}\n\n${t.toString()}`);continue}this.Wa(t)}this.za()}Wa(t){!this.Ka&&this.Ds&&this.Ds.push(t);const e=this.zs.find((e=>this.Ha(e,t)));e&&c((()=>e.nonce>t.nonce))||(this.zs=this.zs.filter((t=>t!==e)),this.qa(t)?(!e&&r.te&&r.qt(h,"Add",i(t)),this.zs.push(t)):e&&r.te&&r.qt(h,"Remove",i(t)))}Ha(t,e){if(t===e)return!0;const n=c((()=>t.origin)),r=c((()=>e.origin));return!n.startsWith("error://")&&(!r.startsWith("error://")&&n===r)}qa(t){try{if(c((()=>t.location)).startsWith("error://"))return!1;const e=c((()=>t.owner));if(void 0===e)return!0;if(!this.Ka)return!1;const n=o(e).script();return n===this.Ka.script()}catch(t){return!1}}za(){this.zs=this.zs.filter((t=>!!this.qa(t)||(r.te&&r.qt(h,"Remove",i(t)),!1)))}}},function(t,e,n){const r=n(7),{PrivateKey:o,Script:i,Transaction:s}=r,{L:c,Y:a}=n(0),h=n(2),{Vr:u}=n(13),PurseWrapper=n(45),f="LocalPurse",l=34,d=149;function p(t){switch(typeof t){case"number":if(!Number.isInteger(t))throw new Error(`splits must be an integer: ${t}`);if(t<=0)throw new Error(`splits must be at least 1: ${t}`);return t;case"undefined":return 1;default:throw new Error(`Invalid splits: ${t}`)}}function w(t){switch(typeof t){case"number":if(!Number.isFinite(t))throw new Error(`feePerKb must be finite: ${t}`);if(t<0)throw new Error(`feePerKb must be non-negative: ${t}`);return t;case"undefined":return s.FEE_PER_KB;default:throw new Error(`Invalid feePerKb: ${t}`)}}function y(t,e){try{const r=n(30).util.metadata(t);return e>r.vrun&&e<r.out.length+r.vrun+1}catch(t){return!1}}t.exports=class extends PurseWrapper{constructor(t={}){if(super(void 0,function(t){switch(typeof t){case"undefined":throw new Error("blockchain is required");case"object":if(t&&t.network)return t}throw new Error(`Invalid blockchain: ${a(t)}`)}(t.blockchain)),this.Za=p(t.splits),this.Xa=w(t.feePerKb),this.bsvPrivateKey=new o(t.privkey,c(this.blockchain.network)),this.bsvAddress=this.bsvPrivateKey.toAddress(),this.bsvScript=i.fromAddress(this.bsvAddress),this.privkey=this.bsvPrivateKey.toString(),this.address=this.bsvAddress.toString(),this.script=this.bsvScript.toHex(),t.privkey&&this.bsvPrivateKey.toString()!==t.privkey.toString())throw new Error(`Invalid private key: ${a(t.privkey)}`);this.jigFilter=!0,this.cacheUtxos=!0,this.Qa=[],this.th=new Map}get splits(){return this.Za}set splits(t){this.Za=p(t)}get feePerKb(){return this.Xa}set feePerKb(t){this.Xa=w(t)}async pay(t,e){this.cacheUtxos&&this.Qa.length||(this.Qa=await this.blockchain.utxos(this.script),this.th.clear());const n=new r.Transaction(t),o=n.inputs.length,c=await async function(t,e,n,o,c,a,p,w,b){const g=s.DUST_AMOUNT;t.feePerKb(p);const _=p/1e3;e.forEach(((e,n)=>{e&&(t.inputs[n].output=new s.Output({satoshis:e.satoshis,script:new i(e.script)}))}));const m=[];t.inputs.forEach(((t,e)=>{t.script.toBuffer().length||(m.push(e),t.setScript(r.deps.Buffer.alloc(500)))}));const E=0===t.outputs.length?g:0,v=t._getInputAmount(),$=t._getOutputAmount();if(v-$-E>=t.toBuffer().length*_){h.Dt&&h.Ft(f,"Transaction already paid for. Skipping.");const e=Math.ceil((l+t.toBuffer().length)*_);return v-$>g+e&&(t._fee=e,t.change(a)),m.forEach((e=>t.inputs[e].setScript(""))),t}function P(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}if(!(n=P(n)).length){throw new Error(`Not enough funds\n\n${`Hint: Have you funded the purse address ${a}?`}`)}const O=t.inputs.length;let S=t.toBuffer().length*_,x=S+$-v,A=0,I=1;S+=l*_,x+=l*_,x+=g;for(const e of n){const r=await o.fetch(e.txid);if(b&&y(r,e.vout))continue;t.from(e),x-=e.satoshis,A++,S+=d*_,x+=d*_;const i=w-n.length+A-I;for(let t=0;t<i;t++)S+=l*_,x+=l*_,x+=g,I++;if(x<0)break}if(S=Math.ceil(S),x=Math.ceil(x),x>0){throw new Error(`Not enough funds\n\n${`Required ${x} more satoshis`}`)}const R=I*g-x,j=Math.max(g,Math.floor(R/I));for(let e=0;e<I;e++)e===I-1?(t._fee=S,t.change(a)):t.to(a,j);for(let e=O;e<t.inputs.length;e++){const n=t.inputs[e].output,r=await u(t,e,n.script,n.satoshis,c),o=c.publicKey.toString(),s=i.fromASM(`${r} ${o}`);t.inputs[e].setScript(s)}const T=t._getInputAmount()-v,C=t._getOutputAmount()-$,N=T-C;h.Dt&&h.Ft(f,"Paid about",N,"satoshis");return m.forEach((e=>t.inputs[e].setScript(""))),t}(n,e,this.Qa,this.blockchain,this.bsvPrivateKey,this.bsvAddress,this.feePerKb,this.splits,this.jigFilter),a=c.toString();if(this.cacheUtxos){const t=[];for(let e=o;e<n.inputs.length;e++){const r=n.inputs[e],o=r.prevTxId.toString("hex"),i=r.outputIndex,s=this.Qa.findIndex((t=>t.txid===o&&t.vout===i)),c=this.Qa[s];this.Qa.splice(s,1),t.push(c)}this.th.set(a,t)}return a}async broadcast(t){if(await this.blockchain.broadcast(t),!this.cacheUtxos)return;const e=new r.Transaction(t),n=e.hash;e.outputs.forEach(((t,e)=>{t.script.toHex()===this.script&&this.Qa.push({txid:n,vout:e,script:this.script,satoshis:t.satoshis})})),this.th.delete(t)}async cancel(t){if(!this.cacheUtxos)return;const e=this.th.get(t);e&&e.forEach((t=>this.Qa.push(t))),this.th.delete(t)}async balance(){return(await this.utxos()).reduce(((t,e)=>t+e.satoshis),0)}async utxos(){this.cacheUtxos&&this.Qa.length||(this.Qa=await this.blockchain.utxos(this.script),this.th.clear());const t=await Promise.all(this.Qa.map((t=>this.blockchain.fetch(t.txid))));return this.Qa.filter(((e,n)=>!this.jigFilter||!y(t[n],e.vout)))}}},function(t,e,n){const StateWrapper=n(39);t.exports=class extends StateWrapper{async pull(){}}},function(t,e,n){const r=n(7),{Address:o,Script:i,Transaction:s}=r,c=n(2),{Kr:a}=n(13),{yt:h}=n(0),{sha256}=r.crypto.Hash,BlockchainWrapper=n(40),u="Mockchain";t.exports=class extends BlockchainWrapper{constructor(){super(),this.network="mock",this.mempoolChainLimit=1e3,this.eh=new Map,this.nh=new Map,this.qo=new Map,this.Qa=new Map,this.rh=new Map,this.oh=new Map}async broadcast(t){const e=new s(t),n=e.hash;if(this.eh.has(n))return c.ee&&c.Xt(u,"Already have transaction",n),n;e.inputs.forEach(((t,e)=>{const n=`${t.prevTxId.toString("hex")}_o${t.outputIndex}`,r=this.Qa.get(n);if(!r){const t=this.qo.get(n),e=this.oh.has(t);throw new Error(e?"txn-mempool-conflict":"Missing inputs")}t.output=new s.Output(r)}));if(e.inputs.reduce(((t,e)=>t+e.output.satoshis),0)<e.outputs.reduce(((t,e)=>t+e.satoshis),0))throw new Error("bad-txns-in-belowout");if(e.getFee()<e.toBuffer().length*s.FEE_PER_KB/1e3)throw new Error("insufficient priority");if(!0!==e.isFullySigned())throw new Error("mandatory-script-verify-flag-failed");for(let t=0;t<e.inputs.length;t++)if(!e.isValidSignature({inputIndex:t}))throw new Error("mandatory-script-verify-flag-failed");const o=e.inputs.map((t=>t.prevTxId.toString("hex"))).map((t=>this.oh.get(t)+1)).reduce(((t,e)=>Math.max(t,e)),0);if(o>h(this.mempoolChainLimit,"mempoolChainLimit")){throw new Error(`too-long-mempool-chain\n\n${"Hint: Use run.blockchain.block() to produce blocks on the mockchain."}`)}return this.eh.set(n,t),this.nh.set(n,Date.now()),this.oh.set(n,o),e.inputs.forEach(((t,e)=>{const o=t.prevTxId.toString("hex"),i=`${o}_o${t.outputIndex}`,s=this.eh.get(o),c=new r.Transaction(s).outputs[t.outputIndex],a=sha256(c.script.toBuffer()).reverse().toString("hex");this.Qa.delete(i),this.rh.get(a).delete(i),this.qo.set(i,n)})),e.outputs.forEach(((t,e)=>{const r=`${n}_o${e}`;this.qo.set(r,null);const o={txid:n,vout:e,script:t.script.toHex(),satoshis:t.satoshis};this.Qa.set(r,o);const i=sha256(t.script.toBuffer()).reverse().toString("hex"),s=this.rh.get(i)||new Set;s.add(r),this.rh.set(i,s)})),n}async fetch(t){const e=this.eh.get(t);if(!e)throw new Error(`No such mempool or blockchain transaction: ${t}`);return e}async utxos(t){const e=await a(t),n=this.rh.get(e);return n?Array.from(n).map((t=>this.Qa.get(t))):[]}async spends(t,e){const n=`${t}_o${e}`;return this.qo.get(n)||null}async time(t){const e=this.nh.get(t);if(!e)throw new Error(`No such mempool or blockchain transaction: ${t}`);return e}fund(t,e){c.te&&c.qt(u,"Fund",t.toString(),"with",e);const n=Math.random().toString(),r=(new s).addData(n).to(new o(t,"testnet"),e),a=r.hash,h=r.toString("hex");this.eh.set(a,h),this.nh.set(a,Date.now()),this.oh.set(a,0);const f={txid:a,vout:1,script:r.outputs[1].script.toHex(),satoshis:r.outputs[1].satoshis},l=`${a}_o1`;this.Qa.set(l,f);const d=i.fromAddress(t),p=sha256(d.toBuffer()).reverse().toString("hex"),w=this.rh.get(p)||new Set;return w.add(l),this.rh.set(p,w),a}block(){c.Dt&&c.Ft(u,"Block"),this.oh.clear()}}},function(t,e,n){{const CacheWrapper=n(37),LocalCache=n(38),DiskCache=n(52);class NodeCache extends CacheWrapper{constructor(t={}){super(),this.localCache=new LocalCache({maxSizeMB:t.maxMemorySizeMB}),this.diskCache=new DiskCache({dir:t.dir}),this.localCache.setWrappingEnabled(!1),this.diskCache.setWrappingEnabled(!1)}get maxMemorySizeMB(){return this.localCache.maxSizeMB}set maxMemorySizeMB(t){this.localCache.maxSizeMB=t}async get(t){const e=await this.localCache.get(t);if(void 0!==e)return e;const n=await this.diskCache.get(t);return void 0!==n?(await this.localCache.set(t,n),n):void 0}async set(t,e){return Promise.all([this.localCache.set(t,e),this.diskCache.set(t,e)])}}t.exports=NodeCache}},function(t,e,n){const r=n(7),o=n(18),{Y:i}=n(0),PurseWrapper=n(45),RunConnect=n(57);t.exports=class extends PurseWrapper{constructor(t){super();let e=null;try{e=new r.HDPublicKey(t)}catch(e){throw new Error(`Invalid API key: ${i(t)}`)}this.network="mainnet"===e.network.name||"livenet"===e.network.name?"main":"test",this.apiKey=t,this.timeout=5e3,this.request=o,this.host="https://api.run.network"}async pay(t,e){const n=`${this.host}/v1/${this.network}/pay`,r={method:"POST",body:{rawtx:t,parents:e,key:this.apiKey},timeout:this.timeout};return(await this.request(n,r)).rawtx}async broadcast(t){if(this.blockchain instanceof RunConnect&&this.network===this.blockchain.network)return void await this.blockchain.broadcast(t);const e=`${this.host}/v1/${this.network}/tx`,n={method:"POST",body:{rawtx:t},timeout:this.timeout};await this.request(e,n)}async cancel(t){}}},function(t,e,n){const{Kr:r}=n(13),o=n(18),StateWrapper=n(39);t.exports=class extends StateWrapper{constructor(t){super(),this.host=t,this.request=o}async pull(t,e){const[n,r]=t.split("://");let o,i=null;switch(n){case"jig":i=`${this.host}/jig/${r}`;break;case"berry":i=`${this.host}/berry/${encodeURIComponent(r)}`;break;case"trust":i=`${this.host}/trust/${r}`;break;case"ban":return;case"tx":i=`${this.host}/tx/${r}`;break;case"spend":i=`${this.host}/spends/${r}`;break;case"time":i=`${this.host}/time/${r}`;break;default:return}try{o=await this.request(i)}catch(t){if(404===t.status)return;throw t}if(e&&e.tx&&"jig"===n&&this.cache)try{const t=r.slice(0,64),e=`${this.host}/tx/${t}`,n=await this.request(e);await this.cache.set(`tx://${t}`,n)}catch(t){if(404!==t.status)throw t}return o}async locations(t){const e=await r(t),n=`${this.host}/unspent?scripthash=${e}`;return await this.request(n)}async broadcast(t){await this.request(`${this.host}/tx`,{method:"POST",body:t,headers:{"content-type":"text/plain"}})}}},function(t,e,n){const r=n(18),o=n(28),StateWrapper=n(39);t.exports=class extends StateWrapper{constructor(t={}){super(),this.network=function(t){if(void 0===t)return"main";if("string"!=typeof t)throw new Error(`Invalid network: ${t}`);if("main"!==t&&"test"!==t)throw new Error(`RunConnect API does not support the "${t}" network`);return t}(t.network),this.request=r,this.host="https://api.run.network"}async pull(t,e){let n={},r=null;const[i,s]=t.split("://");if("jig"===i||"berry"===i){try{const t=(e=e||{}).all?1:0,r=e.tx?1:0,i=e.filter||o.toBase64(o.create()),c=`${this.host}/v1/${this.network}/state/${encodeURIComponent(s)}?all=${t}&tx=${r}&filter=${i}`,a={cache:1e3};n=await this.request(c,a)}catch(t){n="object"==typeof t.reason?t.reason:{},404!==t.status&&(r=t)}if(this.cache&&await Promise.all(Object.entries(n).filter((([e,n])=>e!==t)).map((([t,e])=>this.cache.set(t,e)))),r)throw r;return n[t]}}}},function(t,e,n){const{Y:r,L:o}=n(0),{he:i}=n(10),s=n(7),{Script:c}=s,a=n(2),OwnerWrapper=n(44);t.exports=class extends OwnerWrapper{constructor(t,e){super(),this.owner=t,this.script=c.fromHex(i(this.owner,!1,e&&o(e)).script())}async sign(t,e,n){return a.ee&&a.Xt("Viewer","Viewer cannot sign ",r(this.owner)),t}nextOwner(){return this.owner}}},function(t,e,n){const{Kr:r}=n(13),o=n(2),{NotImplementedError}=n(11),i=n(18),BlockchainWrapper=n(40),{So:s}=i;t.exports=class extends BlockchainWrapper{constructor(t={}){super(),this.api="whatsonchain",this.apiKey=function(t){if(void 0===t||"string"==typeof t)return t;throw new Error(`Invalid API key: ${t}`)}(t.apiKey),this.network=function(t){if(void 0===t)return"main";if("string"!=typeof t)throw new Error(`Invalid network: ${t}`);if("main"!==t&&"test"!==t&&"stn"!==t)throw new Error(`WhatsOnChain API does not support the "${t}" network`);return t}(t.network),this.request=i}async broadcast(t){const e=`https://api.whatsonchain.com/v1/bsv/${this.network}/tx/raw`,n={method:"POST",body:{txhex:t},headers:this.apiKey?{"woc-api-key":this.apiKey}:{}};return await this.request(e,n)}async fetch(t){try{const e=`https://api.whatsonchain.com/v1/bsv/${this.network}/tx/${t}/hex`,n={headers:this.apiKey?{"woc-api-key":this.apiKey}:{},cache:1e3};return await this.request(e,n)}catch(t){throw t instanceof s&&(404===t.status||500===t.status)?new Error("No such mempool or blockchain transaction"):t}}async utxos(t){if("stn"===this.network)return o.ee&&o.Xt("WhatsOnChain","Utxos are not available on STN"),[];const e=await r(t),n=`https://api.whatsonchain.com/v1/bsv/${this.network}/script/${e}/unspent`,i=this.apiKey?{"woc-api-key":this.apiKey}:{};return(await this.request(n,{headers:i,cache:1e3})).map((e=>({txid:e.tx_hash,vout:e.tx_pos,satoshis:e.value,script:t})))}async time(t){try{const e=`https://api.whatsonchain.com/v1/bsv/${this.network}/tx/hash/${t}`,n={headers:this.apiKey?{"woc-api-key":this.apiKey}:{},cache:1e3};return 1e3*(await this.request(e,n)).time||Date.now()}catch(t){throw t instanceof s&&(404===t.status||500===t.status)?new Error("No such mempool or blockchain transaction"):t}}async spends(t,e){throw new NotImplementedError("WhatsOnChain API does not support spends")}}},function(t,e,n){const Berry=n(12),r=n(3),txo=n(58);class B extends Berry{init(t,e,n,r,o={}){this.base64Data=t,this.mediaType=e,this.encoding=n,this.filename=r,this.metadata=o,"image/svg+xml"!==e&&"image/png"!==e||(this.metadata.image=this)}static async pluck(t,e){const n=64===t.length?t:JSON.parse(t).txid,r=64===t.length?{}:JSON.parse(t).metadata,o=txo(await e(n)).out.find((t=>"19HxigV4QyBv3tHpQVcUEQyq1pzZVdoAut"===t.s2));if(!o)throw new Error(`Cannot find B:// data in ${n}`);return new B(o.b3,o.s4,o.s5,o.s6,r)}static async loadWithMetadata(t,e){return this.load(JSON.stringify({txid:t,metadata:e}))}}B.metadata={author:"Run â–¸ Extra",website:"https://www.run.network",license:"MIT"},B.deps={txo},B.toString(),B.presets={},B.presets.main={},B.presets.test={},B.presets.main.location="05f67252e696160a7c0099ae8d1ec23c39592378773b3a5a55f16bd1286e7dcb_o3",B.presets.main.origin="5332c013476cd2a2c18710a01188695bc27a5ef1748a51d4a5910feb1111dab4_o1",B.presets.main.nonce=2,B.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",B.presets.main.satoshis=0,B.presets.test.location="d476fd7309a0eeb8b92d715e35c6e273ad63c0025ff6cca927bd0f0b64ed88ff_o3",B.presets.test.origin="b44a203acd6215d2d24b33a41f730e9acf2591c4ae27ecafc8d88ef83da9ddea_o1",B.presets.test.nonce=2,B.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",B.presets.test.satoshis=0,t.exports=r.Te(B)},function(t,e,n){const r=n(3);class Base58{static decode(t){if("string"!=typeof t)throw new Error(`Cannot decode: ${t}`);const e=[],n=[];let r,o,i;for(let s=0;s<t.length;s++){if(r=0,o="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz".indexOf(t[s]),o<0)throw new Error(`Invalid base58 character: ${t}\n\nDetails: i=${s}, c=${t[s]}`);for(o||n.length^s||n.push(0);r in e||o;)i=e[r],i=i?58*i+o:o,o=i>>8,e[r]=i%256,r++}for(;r--;)n.push(e[r]);if(n.length<5)throw new Error(`Base58 string too short: ${t}`);return n.slice(1,n.length-4)}}Base58.toString(),Base58.presets={},Base58.presets.main={},Base58.presets.test={},Base58.presets.main.location="81bcef29b0e4ed745f3422c0b764a33c76d0368af2d2e7dd139db8e00ee3d8a6_o1",Base58.presets.main.origin="81bcef29b0e4ed745f3422c0b764a33c76d0368af2d2e7dd139db8e00ee3d8a6_o1",Base58.presets.main.nonce=1,Base58.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",Base58.presets.main.satoshis=0,Base58.presets.test.location="424abf066be56b9dd5203ed81cf1f536375351d29726d664507fdc30eb589988_o1",Base58.presets.test.origin="424abf066be56b9dd5203ed81cf1f536375351d29726d664507fdc30eb589988_o1",Base58.presets.test.nonce=1,Base58.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",Base58.presets.test.satoshis=0,t.exports=r.Te(Base58)},function(t,e,n){const Jig=n(5),r=n(3);function expect(t){let e=!1;const n=t=>{if("object"!=typeof t||!t)return t;try{return JSON.stringify(t)}catch(e){return t.toString()}};function r(r,o,i){if(e?r:!r)throw new Error(i||`expected value${e?" not":""} to be ${o} but was ${n(t)}`)}function o(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if("object"!=typeof t)return!1;if(null===t||null===e)return!1;if(Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;if(!Object.keys(t).every((n=>o(t[n],e[n]))))return!1;if(t instanceof Set){if(t.size!==e.size)return!1;if(!o(Array.from(t.entries()),Array.from(e.entries())))return!1}if(t instanceof Map){if(t.size!==e.size)return!1;if(!o(Array.from(t.entries()),Array.from(e.entries())))return!1}return!0}function i(t,e){if("function"!=typeof t)return!1;if("function"!=typeof e)return!1;for(;t;)if((t=Object.getPrototypeOf(t))===e)return!0;return!1}return{get not(){return e=!e,this},toBe:(e,o)=>r(t===e,`${n(e)}`,o),toEqual:(e,i)=>r(o(t,e),`equal to ${n(e)}`,i),toBeInstanceOf:(e,n)=>r(t&&t instanceof e,`an instance of ${e&&e.name}`,n),toBeDefined:e=>r(void 0!==t,"defined",e),toBeNull:e=>r(null===t,"null",e),toBeNumber:e=>r("number"==typeof t,"a number",e),toBeInteger:e=>r(Number.isInteger(t),"an integer",e),toBeLessThan:(e,n)=>r(t<e&&"number"==typeof t&&"number"==typeof e,`less than ${e}`,n),toBeLessThanOrEqualTo:(e,n)=>r(t<=e&&"number"==typeof t&&"number"==typeof e,`less than or equal to ${e}`,n),toBeGreaterThan:(e,n)=>r(t>e&&"number"==typeof t&&"number"==typeof e,`greater than ${e}`,n),toBeGreaterThanOrEqualTo:(e,n)=>r(t>=e&&"number"==typeof t&&"number"==typeof e,`greater than or equal to ${e}`,n),toBeBoolean:e=>r("boolean"==typeof t,"a boolean",e),toBeString:e=>r("string"==typeof t,"a string",e),toBeObject:e=>r(t&&"object"==typeof t,"an object",e),toBeArray:e=>r(Array.isArray(t),"an array",e),toBeSet:e=>r(t instanceof Set,"a set",e),toBeMap:e=>r(t instanceof Map,"a map",e),toBeUint8Array:e=>r(t instanceof Uint8Array,"a uint8array",e),toBeClass:e=>r("function"==typeof t&&t.toString().startsWith("class"),"a class",e),toBeFunction:e=>r("function"==typeof t&&!t.toString().startsWith("class"),"a function",e),toBeJigClass:e=>r("function"==typeof t&&t.toString().startsWith("class")&&i(t,Jig),"a jig class",e),toExtendFrom:(e,n)=>r(i(t,e),`an extension of ${e&&e.name}`,n)}}expect.deps={Jig},expect.toString(),expect.presets={},expect.presets.main={},expect.presets.test={},expect.presets.main.location="71fba386341b932380ec5bfedc3a40bce43d4974decdc94c419a94a8ce5dfc23_o1",expect.presets.main.origin="71fba386341b932380ec5bfedc3a40bce43d4974decdc94c419a94a8ce5dfc23_o1",expect.presets.main.nonce=1,expect.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",expect.presets.main.satoshis=0,expect.presets.test.location="f97d4ac2a3d6f5ed09fad4a4f341619dc5a3773d9844ff95c99c5d4f8388de2f_o1",expect.presets.test.origin="f97d4ac2a3d6f5ed09fad4a4f341619dc5a3773d9844ff95c99c5d4f8388de2f_o1",expect.presets.test.nonce=1,expect.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",expect.presets.test.satoshis=0,t.exports=r.Te(expect)},function(t,e,n){const Jig=n(5),r=n(3);class NFT extends Jig{init(t,e,n){if(!(this.constructor!==NFT))throw new Error("NFT must be extended");if(!(caller===this.constructor))throw new Error("Must create token using mint()");t&&(this.owner=t),n&&(this.metadata=n),e&&(this.number=e,this.no=e)}static mint(t,e){const n=this.maxSupply||this.max;if(n&&this.supply>=n)throw new Error("Maximum supply exceeded");return this.supply++,this.total++,new this(t,this.supply,e)}send(t){this.sender=this.owner,this.owner=t}}NFT.sealed=!1,NFT.supply=0,NFT.total=0,NFT.version="1.0",NFT.toString(),NFT.presets={},NFT.presets.main={},NFT.presets.test={},NFT.presets.main.location="b2f52f369d6ac4210585e0d173020106bd338197f136e02bc4d1fb2af3ef789f_o1",NFT.presets.main.origin="b2f52f369d6ac4210585e0d173020106bd338197f136e02bc4d1fb2af3ef789f_o1",NFT.presets.main.nonce=1,NFT.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",NFT.presets.main.satoshis=0,NFT.presets.test.location="8554b58e95bbd7a1899b54ca1318cc3ce140c6cd7ed64789dcaf5ea5dcfdb1f1_o1",NFT.presets.test.origin="8554b58e95bbd7a1899b54ca1318cc3ce140c6cd7ed64789dcaf5ea5dcfdb1f1_o1",NFT.presets.test.nonce=1,NFT.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",NFT.presets.test.satoshis=0,t.exports=r.Te(NFT)},function(t,e,n){const r=n(3);function sha256(t){if(!Array.isArray(t))throw new Error(`Invalid bytes: ${t}`);const e=[-2147483648,8388608,32768,128],n=[24,16,8,0],r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let i=1779033703,s=3144134277,c=1013904242,a=2773480762,h=1359893119,u=2600822924,f=528734635,l=1541459225,d=0,p=0,w=0,y=0,b=!0,g=!1,_=0;return function(){let e,r=0;const i=t.length;for(;r<i;){for(g&&(g=!1,o[0]=d,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),e=p;r<i&&e<64;++r)o[e>>2]|=t[r]<<n[3&e++];_=e,w+=e-p,e>=64?(d=o[16],p=e-64,m(),g=!0):p=e}w>4294967295&&(y+=w/4294967296<<0,w%=4294967296)}(),function(){o[16]=d,o[_>>2]|=e[3&_],d=o[16],_>=56&&(g||m(),o[0]=d,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0);o[14]=y<<3|w>>>29,o[15]=w<<3,m()}(),[i>>24&255,i>>16&255,i>>8&255,255&i,s>>24&255,s>>16&255,s>>8&255,255&s,c>>24&255,c>>16&255,c>>8&255,255&c,a>>24&255,a>>16&255,a>>8&255,255&a,h>>24&255,h>>16&255,h>>8&255,255&h,u>>24&255,u>>16&255,u>>8&255,255&u,f>>24&255,f>>16&255,f>>8&255,255&f,l>>24&255,l>>16&255,l>>8&255,255&l];function m(){let t,e,n,d,p,w,y,g,_,m,E,v=i,$=s,P=c,O=a,S=h,x=u,A=f,I=l;for(t=16;t<64;++t)p=o[t-15],e=(p>>>7|p<<25)^(p>>>18|p<<14)^p>>>3,p=o[t-2],n=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,o[t]=o[t-16]+e+o[t-7]+n<<0;for(E=$&P,t=0;t<64;t+=4)b?(g=704751109,p=o[0]-210244248,I=p-1521486534<<0,O=p+143694565<<0,b=!1):(e=(v>>>2|v<<30)^(v>>>13|v<<19)^(v>>>22|v<<10),n=(S>>>6|S<<26)^(S>>>11|S<<21)^(S>>>25|S<<7),g=v&$,d=g^v&P^E,y=S&x^~S&A,p=I+n+y+r[t]+o[t],w=e+d,I=O+p<<0,O=p+w<<0),e=(O>>>2|O<<30)^(O>>>13|O<<19)^(O>>>22|O<<10),n=(I>>>6|I<<26)^(I>>>11|I<<21)^(I>>>25|I<<7),_=O&v,d=_^O&$^g,y=I&S^~I&x,p=A+n+y+r[t+1]+o[t+1],w=e+d,A=P+p<<0,P=p+w<<0,e=(P>>>2|P<<30)^(P>>>13|P<<19)^(P>>>22|P<<10),n=(A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7),m=P&O,d=m^P&v^_,y=A&I^~A&S,p=x+n+y+r[t+2]+o[t+2],w=e+d,x=$+p<<0,$=p+w<<0,e=($>>>2|$<<30)^($>>>13|$<<19)^($>>>22|$<<10),n=(x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7),E=$&P,d=E^$&O^m,y=x&A^~x&I,p=S+n+y+r[t+3]+o[t+3],w=e+d,S=v+p<<0,v=p+w<<0;i=i+v<<0,s=s+$<<0,c=c+P<<0,a=a+O<<0,h=h+S<<0,u=u+x<<0,f=f+A<<0,l=l+I<<0}}sha256.toString(),sha256.presets={},sha256.presets.main={},sha256.presets.test={},sha256.presets.main.location="3b7ef411185bbe3d01caeadbe6f115b0103a546c4ef0ac7474aa6fbb71aff208_o1",sha256.presets.main.origin="3b7ef411185bbe3d01caeadbe6f115b0103a546c4ef0ac7474aa6fbb71aff208_o1",sha256.presets.main.nonce=1,sha256.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",sha256.presets.main.satoshis=0,sha256.presets.test.location="4a1929527605577a6b30710e6001b9379400421d8089d34bb0404dd558529417_o1",sha256.presets.test.origin="4a1929527605577a6b30710e6001b9379400421d8089d34bb0404dd558529417_o1",sha256.presets.test.nonce=1,sha256.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",sha256.presets.test.satoshis=0,t.exports=r.Te(sha256)},function(t,e,n){const Jig=n(5),r=n(3);class Token extends Jig{init(...t){if(Object.getPrototypeOf(this.constructor)===Jig)throw new Error("Token must be extended");if(caller===this.constructor)return this.Ja(caller.mintAmount),this.amount=caller.mintAmount,void(this.sender=null);if(caller&&caller.constructor===this.constructor)return this.Ja(caller.sendAmount),this.amount=caller.sendAmount,this.owner=caller.sendOwner,void(this.sender=caller.owner);if(!Array.isArray(t)||t.length<2)throw new Error("Invalid tokens to combine");if(t.some((t=>t.constructor!==this.constructor)))throw new Error("Cannot combine different token classes");if(t.some((e=>(e=>t.reduce(((t,n)=>n===e?t+1:t),0))(e)>1)))throw new Error("Cannot combine duplicate tokens");this.amount=0,t.forEach((t=>{this.amount+=t.amount,t.destroy()})),this.sender=null,this.Ja(this.amount)}static mint(t){this.mintAmount=t;const e=new this;return delete this.mintAmount,this.supply+=t,e}destroy(){super.destroy(),this.amount=0,this.sender=null}send(t,e=this.amount){if(this.Ja(e),e>this.amount)throw new Error("Not enough funds");this.sendAmount=e,this.sendOwner=t;const n=new this.constructor;return delete this.sendAmount,delete this.sendOwner,this.amount===e?this.destroy():(this.amount-=e,this.sender=null),n}Ja(t){if("number"!=typeof t)throw new Error("amount is not a number");if(!Number.isInteger(t))throw new Error("amount must be an integer");if(t<=0)throw new Error("amount must be positive");if(t>Number.MAX_SAFE_INTEGER)throw new Error("amount too large")}}Token.sealed=!1,Token.decimals=0,Token.icon={emoji:null},Token.symbol=null,Token.supply=0,Token.toString(),Token.presets={},Token.presets.main={},Token.presets.test={},Token.presets.main.location="b17a9af70ab0f46809f908b2e900e395ba40996000bf4f00e3b27a1e93280cf1_o1",Token.presets.main.origin="b17a9af70ab0f46809f908b2e900e395ba40996000bf4f00e3b27a1e93280cf1_o1",Token.presets.main.nonce=1,Token.presets.main.owner="1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",Token.presets.main.satoshis=0,Token.presets.test.location="0bdf33a334a60909f4c8dab345500cbb313fbfd50b1d98120227eae092b81c39_o1",Token.presets.test.origin="0bdf33a334a60909f4c8dab345500cbb313fbfd50b1d98120227eae092b81c39_o1",Token.presets.test.nonce=1,Token.presets.test.owner="n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",Token.presets.test.satoshis=0,t.exports=r.Te(Token)}]);